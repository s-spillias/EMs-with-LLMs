Assessment and rationale

Fit and residuals:
- A residuals file was referenced but not provided here; please share it for a quantitative assessment. Structurally, the current model can generate boom-bust dynamics via (i) coral-dependent carrying capacity (K_A), (ii) Allee effect, (iii) SST modulation, and (iv) prey depletion of corals. However, the adult “feed_gain” term (adding adults from feeding in the same step) likely smooths and advances outbreak peaks, potentially misaligning timing and magnitude relative to observations.

Project context alignment:
- Strengths: Includes selective predation on fast/slow coral guilds, SST effects, Allee effect, and exogenous immigration pulses (cotsimm_dat) — all relevant to episodic outbreaks.
- Gaps: (a) Nutrition improves reproduction rather than instant adult numbers; (b) K_A linear in coral cover (could be refined later); (c) no explicit predator/disease feedback; (d) no explicit runoff/nutrient driver beyond exogenous immigration; (e) no stage structure or maturation delay beyond the 1-step recruitment.

Potentially missing/oversimplified processes:
- Feeding-to-reproduction linkage (currently modeled as adult gain from feeding).
- Nonlinear K_A vs coral cover and/or guild-specific differential carrying capacity contributions.
- Top-down control (predators, disease) and density-dependent mortality at high A.
- Explicit runoff/nutrient-driven larval survival, if data are available (beyond cotsimm_dat).
- Stage structure (larvae/juveniles) with maturation delay.

Chosen improvement (implemented):
- Replace direct adult addition from feeding with a saturating fecundity boost driven by per-capita feeding rate.
  Ecological reasoning: Adult COTS nutrition primarily enhances fecundity and larval production, not instantaneous increases in adult abundance within the same year. This change preserves sharp upswing potential (when coral is abundant, per-capita feeding increases fecundity) and supports a collapse when coral is depleted (per-capita feeding falls, recruitment collapses). It also improves outbreak timing by keeping the increase in adults routed through recruitment (with existing density dependence and Allee effect), rather than an immediate adult addition.
  Mathematical change:
    per_cap_feed = (aF*pref_F*RF^q + aS*pref_S*RS^q) / (1 + hF*aF*pref_F*RF^q + hS*aS*pref_S*RS^q)
    FEC_FEED = 1 + beta_feed_A * per_cap_feed / (per_cap_feed + feed_half_A)
    recruit = rA * sst_mod_A * allee_mult * FEC_FEED * A_prev / (1 + A_prev / K_A)
    A_t = A_{t-1} + recruit + gamma_I * cotsimm_{t-1} - mA * A_{t-1}
  Notes: All terms use previous-step state to avoid leakage.

Parameter updates:
- New parameters added:
  - beta_feed_A (dimensionless): max fractional fecundity boost from feeding. Bounds: [0, 2].
  - feed_half_A (yr^-1): half-saturation of per-capita feeding rate. Bounds: [0.01, 5].
- eta_A retained for backward compatibility but deprecated (no longer used in adult update).
- Existing literature-updated parameters (e.g., mA, rF, sst_bleach) remain valid under the revised recruitment structure.

Next steps (if residuals indicate issues):
- If peaks are still too smooth or mis-timed, consider adding a short maturation delay or a runoff proxy for larval survival.
- If crashes are too weak, add weak density-dependent mortality or nonlinear K_A vs coral cover.

Please provide the residuals file to validate improvements and guide any further refinements.
