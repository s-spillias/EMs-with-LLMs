Assessment of current model and rationale for changes

1) Fit to data
- A residuals file was referenced but not provided in this context, so a quantitative goodness-of-fit assessment cannot be performed here.
- Structurally, the observation models (log-normal for COTS and logit-normal for coral cover) are appropriate and should yield interpretable residuals. Examine whether COTS residuals show phase shifts (predicted peaks too early/late) and whether coral residuals show systematic bias during outbreak peaks.

2) Alignment with PROJECT CONTEXT
- The model encodes several mechanisms needed for boom–bust dynamics:
  - Positive feedbacks via feeding gains (eta_A) and coral-dependent carrying capacity (K_A).
  - An Allee effect (A_crit, k_allee) that creates a threshold for outbreak initiation.
  - Exogenous larval immigration (cotsimm_dat) to seed pulses.
  - Environmental modulation via SST: Gaussian modifier on COTS growth and bleaching effects on coral growth/mortality.
  - Selective predation on coral guilds through a multi-prey functional response with preferences.
- These capture key ingredients for outbreak dynamics, but timing of peaks is likely sensitive to the assumed immediacy of immigration-to-adult conversion.

3) Potentially missing or oversimplified processes
- Recruitment timing: Adult abundance responds immediately to a single-year immigration proxy. In reality, larval survival, settlement, and a cryptic juvenile phase introduce 1–2 year delays before adults are detected—critical for matching outbreak onset timing.
- Functional response shape: Literature updates constrain q_fr to Type II (q ≈ 1). The current code allows broader q, which is inconsistent with the updated bounds and could overfit if not constrained.
- Thermal parameters: sst_ref and sst_bleach have narrower, literature-supported bounds; internal penalties should reflect that to prevent unrealistic fits.

Chosen ecological improvement: introduce a 1-year lag component in larval immigration to adult recruitment
- Ecological reasoning: COTS exhibit a cryptic juvenile phase, and maturation to detectable adults spans ~1 year or more. Representing a delayed pathway improves the model’s ability to align the timing of outbreaks with observed peaks following larval/immigration pulses, without adding a full stage-structured state.
- Mathematical implementation: Replace the purely contemporaneous immigration term with a convex combination of last year’s and two-years-ago immigration:
    immig_eff = gamma_I * [ (1 - rho_lag_I) * I_{t-1} + rho_lag_I * I_{t-2} ]
  with rho_lag_I ∈ [0,1]. For t=1, I_{t-2} is set equal to I_{t-1} (no leakage).
- Expected effect on dynamics: This adds memory to recruitment, enabling outbreak peaks to occur with empirically observed delays while preserving the existing boom–bust mechanisms. It can also broaden/shorten outbreaks appropriately depending on rho_lag_I.

Additional structural alignment with updated literature
- Constrain q_fr to effectively Type II by tightening its penalty to [1.0, 1.000000001].
- Narrow penalty bounds for sst_ref to [28.0, 29.0] and for sst_bleach to [29.0, 34.5], consistent with provided parameter metadata.

Notes on data usage
- The implementation uses only lagged forcing (t-1 and t-2) and previous-state predictions, avoiding any use of current-step observed responses in process equations, as required.

Summary of changes
- Added new parameter rho_lag_I (dimensionless, [0,1]) with ecological justification.
- Updated process equation for immigration to a lagged mixture term.
- Tightened internal penalties for q_fr, sst_ref, and sst_bleach to reflect literature updates.
