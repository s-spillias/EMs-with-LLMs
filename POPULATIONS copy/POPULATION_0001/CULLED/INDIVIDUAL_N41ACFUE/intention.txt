Purpose: Predict episodic Crown-of-thorns starfish (COTS; Acanthaster spp.) outbreaks (boomâ€“bust cycles) on the Great Barrier Reef, and their feedbacks on coral communities (fast-growing Acropora vs. slow-growing Faviidae/Porites), given time series of sea-surface temperature (SST) and larval immigration.

Core ecological mechanisms:
1) Prey dynamics with space competition
   - Fast (Acropora) and slow (Faviidae/Porites) corals compete for benthic space; free space limits growth.
   - Coral growth saturates with free space and allocates smoothly between groups.
   - Elevated SST imposes bleaching-related mortality via a smooth logistic function.
2) Trophic interaction (COTS predation)
   - COTS preferentially consume fast corals via a multi-prey Holling Type II functional response with handling times; slow corals are less preferred.
   - Consumption is capped by available coral, preventing negative coral cover.
3) COTS population dynamics with outbreak triggers
   - Adult survival increases with coral availability (food-dependent logistic function), generating feedback: high prey -> high survival; prey depletion -> bust.
   - Recruitment integrates endogenous production and exogenous larval immigration using saturating functions with an Allee effect on fertilization.
   - SST modulates recruitment via a Gaussian temperature-performance curve with an optimum and breadth.
4) Indirect effects and feedbacks
   - Outbreaks reduce Acropora cover, decreasing future COTS survival/recruitment (food feedback), enabling slow-coral persistence and system recovery.
   - Space freed by predation and bleaching increases potential coral regrowth but is partitioned smoothly between fast and slow groups.

Numerical and statistical design:
- Discrete annual updates use only previous-year states to avoid data leakage.
- Smooth saturating/allocating functions ensure stability and avoid hard cutoffs.
- Observations enter the likelihood for all measured variables (COTS, corals, SST, immigration) with appropriate distributions and minimum error floors.
- Parameters are softly bounded using quadratic penalties to maintain biological realism.

Outputs:
- Annual predictions for adult COTS density (cots_pred), fast and slow coral cover (fast_pred, slow_pred), and passthrough of exogenous SST and immigration (sst_pred, cotsimm_pred).
- Likelihood supports fitting to provided timeseries and forecasting under new forcings.
