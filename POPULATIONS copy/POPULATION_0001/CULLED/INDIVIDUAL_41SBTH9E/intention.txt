Assessment and rationale for model update (PROJECT CONTEXT: episodic COTS outbreaks)

1) How well does the model fit the data?
- I do not have access to the residuals file in this chat, so I cannot quantify fit quality. Structurally, the model is capable of reproducing boom-bust dynamics via: (i) an immigration trigger, (ii) resource-modified carrying capacity, (iii) temperature-dependent performance, and (iv) strong predation on coral. However, without residuals, my assessment focuses on ecological plausibility and common misfit patterns seen in COTS systems.

Typical misfits to watch for in residuals:
- Early outbreak onset: models often overpredict growth at low densities (positive residuals before outbreaks), because they lack mate-limitation (Allee effects).
- Peak magnitude and width: without additional low-density constraints, outbreaks can start too easily and persist longer than observed.
- Coral loss pacing: if consumption is not bounded by availability, models can remove coral too fast at low cover; here, a smooth non-negativity constraint avoids negatives but may still allow unrealistically fast removal in scarce prey conditions.

2) Does the model address the project context?
- Strengths: The model includes pulsed larval immigration (trigger), food limitation via edible coral index, temperature modifiers, and Holling type III predation on corals with preference for fast coral. These are key ingredients for COTS boom-bust dynamics.
- Gaps: A critical mechanism for COTS—mate limitation at low adult densities (Allee effect on effective reproduction/survival)—is missing. This mechanism raises the threshold needed for outbreaks to initiate and helps shape the characteristic timing and duration. Given the project’s emphasis on accurate timing and magnitude of outbreaks, incorporating an Allee effect is warranted.

3) Missing or oversimplified processes
- Missing: Allee effect (mate limitation) on adult demographic performance. Empirical studies show COTS fertilization success increases nonlinearly with adult density; below a threshold, population growth is strongly suppressed.
- Potential oversimplification (not changed in this update to keep focus on one improvement):
  - Predation removal from coral is applied as an absolute area rate and can exceed available group biomass if cover is very low; while the model uses smooth positivity to prevent negatives, a biomass-limited kill term would be more realistic.
  - Immigration is fully exogenous; in reality, nutrient pulses affect larval survival off-reef. This could be modeled via an environmental modifier on immigration when such data are available.

Parameter review and structural implications
- Several temperature-related parameters (sst_opt_*, log_sst_sd_*) are updated from literature, which the current Gaussian thermal modifiers already accommodate appropriately.
- The immigration trigger (imm_thr, imm_k) and conversion efficiency (log_alpha_imm) are compatible with strong episodic forcing.
- Given typical outbreak thresholds (~0.15–0.3 ind m⁻²), the absence of a low-density constraint likely makes the model too “eager” to grow from small seeds. This suggests the equation structure for adult COTS growth should include a low-density modifier.

Chosen improvement: Add an Allee effect on adult COTS per-capita growth
- Approach: Environmental modifier of processes / variable efficiency term.
- Mathematical form: f_allee(N) = N / (N + A_cots), where A_cots > 0 is the Allee scale (the density at which the modifier is 0.5). This smoothly suppresses adult per-capita growth at low densities and approaches 1 at high densities.
- Implementation: Multiply the existing adult per-capita growth term by f_allee(N_prev), using only previous state values to avoid leakage:
  percap_growth = r_cots_max * f_food * fT_cots * f_allee
  where f_allee = N_prev / (N_prev + A_cots)
- Parameterization: Introduce log_A_cots (log scale for positivity), with a prior centered near A_cots ≈ 0.2 ind m⁻² (log ≈ -1.609) and broad bounds (0.01–1 ind m⁻²). This reflects typical fertilization thresholds and allows site-specific estimation.

Why this helps the PROJECT CONTEXT
- Outbreak initiation: Immigration pulses alone do not always trigger outbreaks. The Allee effect enforces a density threshold, improving timing of outbreak onset and preventing “false starts”.
- Outbreak duration and magnitude: Once above threshold, growth accelerates (consistent with observed rapid increases), while low post-bust densities remain suppressed until a new strong pulse arrives, better matching boom-bust cycles.
- Parsimony: Adds one parameter and a simple, biologically interpretable nonlinearity with high leverage on outbreak dynamics.

Notes for future refinements (not implemented here to keep one focused change)
- Bound predation by prey availability using a biomass-limited kill term, e.g., L_fast_realized = min(F_prev, C_all * share_fast) with a smooth cap, to reduce unrealistic removal when coral cover is scarce.
- Consider adding an environmental modifier on immigration (e.g., nutrient/runoff proxy) when data are available to better link episodic larval success to environmental drivers.

Data-leakage check
- The change only uses N_prev (state at t-1) and existing forcings at t-1. No current time-step observations are used in dynamics.

What to look for after this change
- Residuals before outbreak onset should improve (reduced positive bias).
- Outbreak peaks may shift later and narrow slightly, better matching observed rapid rises after crossing the threshold.
- Sensitivity: Posterior of A_cots should settle near densities where observed accelerations occur; if it runs to bounds, consider revising bounds or functional form (e.g., squared term for sharper thresholds).
