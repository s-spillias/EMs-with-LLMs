Assessment of current model and rationale for improvement

Fit to data
- I do not see a residuals file in the provided files, so I cannot directly quantify goodness-of-fit or diagnose residual structure. Please share the residuals to refine diagnostics. Based on typical behavior in COTS outbreak models, linear immigration-to-adult conversion often leads to:
  - Underestimation of sharp outbreak peaks (predicted peaks are too muted/broad).
  - Overestimation of troughs (baseline densities remain too elevated due to constant low-level immigration being linearly converted).
These patterns suggest the need for a more threshold-like immigration efficacy.

Project context alignment
- Strengths:
  - Boom-bust mechanics are partially captured via: (i) coral-dependent carrying capacity (K_A), (ii) Allee effects on reproduction, (iii) SST modifiers, and (iv) explicit consumption impacts on coral, feeding back onto K_A.
  - A one-year delayed immigration component (rho_lag_I) approximates a juvenile/cryptic lag.
- Gaps relevant to episodic outbreaks:
  - The current linear conversion from cotsimm_dat to adult additions smooths larval pulses and can sustain higher-than-observed baselines, weakening the sharp onset and decay characteristic of outbreaks.
  - The model lacks an explicit larval survival threshold and does not represent strong nonlinearity in the progression from larval supply pulses to recruit cohorts.

Potentially missing/oversimplified ecological processes
- Stage structure (juveniles/cryptic phase) and maturation delay beyond a simple 1-year lag.
- Density-dependent adult mortality at very high COTS densities (disease, intraspecific interactions).
- Environmental modulation of larval survival beyond temperature (e.g., nutrient pulses from flood plumes).
- Nonlinear conversion from larval supply to effective recruitment (thresholds/saturation).

Chosen improvement (one meaningful change)
- Implement a saturating, non-linear (Hill) function that maps larval immigration to effective adult additions:
  H(x) = x^ν / (x^ν + I_half^ν)
  imm_eff = gamma_I * [(1 - rho_lag_I) * H(cotsimm_{t-1}) + rho_lag_I * H(cotsimm_{t-2})]
- Ecological justification:
  - COTS outbreaks are linked to episodic environmental conditions that cause large pulses of larval survival/settlement. Below a certain larval influx, adult recruitment remains low; above it, recruitment increases disproportionately. A Hill function provides this threshold-like response while saturating at high pulses, preventing unrealistically large additions.
  - This change preserves the existing delayed pathway (rho_lag_I) and avoids using any current-timestep data, maintaining proper causality.
- Expected effects on dynamics:
  - Sharper outbreak initiation when larval pulses cross I_half.
  - Reduced baseline adult densities during low-immigration periods.
  - Potentially improved timing and magnitude of peaks without overcomplicating model structure.

Parameterization and bounds
- New parameters:
  - I_half (units: ind m^-2 yr^-1 proxy): larval immigration level at which efficacy is 50%.
    Suggested bounds: [0, 1000] to remain permissive given unknown scale of cotsimm_dat; can be refined once data range is known.
  - nu_I (dimensionless): Hill coefficient controlling steepness (threshold sharpness).
    Suggested bounds: [1, 8]; values near 1 are close to saturating Type II, larger values produce more threshold-like behavior.
- Initialization suggestion (not enforced in code): initialize I_half near the median of cotsimm_dat and nu_I around 2–3; refine after inspecting residuals.

Notes and next steps
- Once residuals are available, assess whether high-density crashes are still too slow; if so, consider adding explicit density-dependent adult mortality or disease at extreme densities as a future, separate enhancement.
- If stage structure appears necessary, a juvenile state could be added in a future iteration, but the Hill transform is a lighter-weight change aimed at improving outbreak timing first.

Data leakage compliance
- The implementation uses only lagged immigration (t-1 and t-2) to compute imm_eff. Current timestep observations are not used in state updates.
