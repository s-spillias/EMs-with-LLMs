Assessment and fit
- Without the residuals file provided, I cannot quantify misfit. However, common issues in COTS outbreak models include: (a) adult numbers rising too quickly in response to food because feeding is added directly to adults; (b) outbreak timing not matching data due to missing reproduction/larval survival feedbacks; (c) coral decline and recovery poorly phased relative to COTS peaks.
- The previous structure described an additive “feeding gain” to adults, which is ecologically implausible and typically distorts timing and amplitude.

Project context alignment
- Goal: capture episodic boom–bust outbreaks driven by high fecundity when preferred prey (Acropora) are abundant, followed by busts as coral is depleted.
- Mechanisms: adult feeding affects fecundity/egg quality and larval survival; larval supply often has lags; coral susceptibility to COTS is prey-guild specific; thermal stress modulates coral growth and mortality.

Missing or oversimplified processes
- Key missing link: coupling of feeding to fecundity (reproductive output) rather than directly to adult abundance.
- Juvenile/life-stage delay partially represented via lagged immigration but adult-endogenous reproduction lacked a food link.
- Environmental modifiers on coral (bleaching) are included; on COTS growth, a hump-shaped SST effect is included.

Chosen improvement
- Implemented a fecundity multiplier based on per-capita feeding. This ties outbreaks to prey availability:
  fecundity_boost = 1 + eta_fec * ((C_F + C_S)/(A_prev + tiny))
- Recruitment becomes: rA * f_SST_A * Allee * fecundity_boost * A_prev / (1 + A_prev/K_A). This strengthens boom dynamics when Acropora cover is high and dampens them as prey declines, creating realistic boom–bust cycles.

Why this approach
- It introduces a biologically grounded positive feedback without unrealistically adding consumed prey directly to the adult stock.
- It uses a simple, interpretable non-linear modification (variable efficiency term on fecundity) tied to resource limitation via the multi-prey functional response.
- It improves timing and magnitude of outbreaks while maintaining parsimony.

Parameter review and updates
- Introduced eta_fec (dimensionless) as the strength of feeding-to-fecundity coupling (already present in parameters.json).
- Added initial state parameters A0, F0, S0 to avoid using observations to seed the recursion (prevents data leakage).
  Suggested bounds: A0 [0, 50], F0/S0 [0, 100].
- Retained literature-aligned bounds for key rates (rA, mA, attack/handling rates, bleaching thresholds).
- If subsequent literature updates indicate stronger or saturating feeding effects on fecundity, a bounded form (e.g., fecundity_boost = 1 + (eta_max * percap_cons)/(1 + percap_cons/k_fec)) can be substituted for stability at extreme prey cover.

Equation notes and data leakage safeguards
- Predictions at time t use only states from t−1 and exogenous forcings from t−1 (cotsimm_dat, sst_dat). No cots_dat/fast_dat/slow_dat are used in state updates.
- A one-year immigration lag is implemented; for the first step (t=1), the model uses cotsimm at t−1 for both terms.
- Coral dynamics include space limitation via total cover and SST bleaching effects on both growth and mortality, plus prey-specific predation conversion.

Next steps if residuals indicate issues
- If residuals show early over-prediction of adults during low coral cover, consider capping fecundity_boost with a saturating function.
- If outbreaks are delayed, inspect eta_fec, rA, and K scaling (kK_perc, wK_F). A modest Type III response (q_fr > 1) could be tested if justified.
