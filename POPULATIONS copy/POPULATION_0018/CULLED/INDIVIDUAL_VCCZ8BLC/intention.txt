MODEL ASSESSMENT AND IMPROVEMENT PLAN

CURRENT MODEL EVALUATION:
The existing NPZ model captures basic trophic interactions with nutrient limitation (Michaelis-Menten), 
grazing (Holling Type II), and nutrient recycling. However, it lacks a critical process for oceanic 
mixed layer dynamics: light limitation of phytoplankton growth.

KEY MISSING PROCESS:
In the oceanic mixed layer, phytoplankton growth is co-limited by both nutrients AND light. The current 
model only considers nutrient limitation, which is incomplete for representing realistic plankton dynamics.

ECOLOGICAL IMPROVEMENT IMPLEMENTED:
Added light limitation with self-shading effects to phytoplankton growth dynamics.

MATHEMATICAL FORMULATION:
1. Light availability follows Beer-Lambert law with self-shading:
   I(z) = I_0 * exp(-k_w * z - k_c * P * z)
   where:
   - I_0 = surface light intensity
   - k_w = background light attenuation (water + dissolved matter)
   - k_c = specific attenuation coefficient for phytoplankton self-shading
   - z = depth (integrated over mixed layer)

2. Average light in mixed layer (depth H):
   I_avg = I_0 * (1 - exp(-k_w * H - k_c * P * H)) / (k_w * H + k_c * P * H)

3. Light limitation factor (Steele formulation for photoinhibition):
   L = (I_avg / I_opt) * exp(1 - I_avg / I_opt)
   where I_opt is optimal light intensity

4. Combined limitation (multiplicative):
   Growth = r_max * min(N/(K_N + N), L) * P
   
   Simplified to: Growth = r_max * (N/(K_N + N)) * L * P
   (using multiplicative co-limitation which is more commonly observed)

ECOLOGICAL JUSTIFICATION:
- Light is essential for photosynthesis and varies with depth and turbidity
- Self-shading creates negative feedback: high phytoplankton biomass reduces light availability
- This density-dependent effect can stabilize population oscillations
- Represents realistic mixed layer physics where phytoplankton blooms self-limit through shading
- Captures seasonal and spatial variation in light availability
- Well-documented in oceanographic literature (e.g., Fasham et al. 1990, Evans & Parslow 1985)

NEW PARAMETERS ADDED:
1. I_0: Surface light intensity (W m^-2 or Î¼mol photons m^-2 s^-1)
   - Represents incoming solar radiation at sea surface
   - Varies seasonally and with latitude
   - Initial value: 100 W m^-2 (moderate light conditions)

2. k_w: Background light attenuation coefficient (m^-1)
   - Accounts for absorption by water and dissolved organic matter
   - Typical oceanic values: 0.04-0.2 m^-1
   - Initial value: 0.1 m^-1

3. k_c: Phytoplankton-specific attenuation coefficient (m^2 (g C)^-1)
   - Self-shading effect per unit phytoplankton biomass
   - Typical values: 0.01-0.1 m^2 (g C)^-1
   - Initial value: 0.03 m^2 (g C)^-1

4. H: Mixed layer depth (m)
   - Depth over which phytoplankton are mixed
   - Typical oceanic values: 10-100 m
   - Initial value: 30 m (representative mixed layer)

5. I_opt: Optimal light intensity for photosynthesis (W m^-2)
   - Light level at which photosynthesis is maximal
   - Accounts for photoinhibition at high light
   - Initial value: 50 W m^-2

EXPECTED IMPROVEMENTS:
- More realistic representation of phytoplankton bloom dynamics
- Better capture of seasonal patterns in productivity
- Improved stability through self-shading feedback
- Enhanced ability to represent different oceanic regions (varying light/mixing conditions)
- More accurate prediction of phytoplankton biomass peaks

IMPLEMENTATION NOTES:
- Light limitation factor (L) is calculated at each time step
- Multiplied with nutrient limitation to give co-limitation
- All new parameters have ecologically reasonable bounds
- Formulation is computationally stable (no division by zero issues with eps terms)
