# Model Improvement: Flexible Nutrient-Light Co-limitation Framework

## Assessment of Current Model

The current NPZ model includes comprehensive ecological processes:
- Temperature dependencies (Q10 formulation)
- Light limitation with phytoplankton self-shading
- Food-dependent zooplankton assimilation efficiency
- Multiple nutrient recycling pathways
- Density-dependent processes

However, the phytoplankton growth formulation uses strict multiplicative co-limitation:
uptake = r * (N/(K_N + N)) * (I/(K_I + I)) * P

This assumes that nutrient and light limitations always interact multiplicatively, which may not capture the full range of ecological dynamics.

## Ecological Justification for Improvement

In natural systems, phytoplankton respond to multiple limiting resources in complex ways:

1. **Liebig's Law of the Minimum**: Growth is limited by the scarcest resource (minimum limitation)
2. **Multiplicative Co-limitation**: Both resources simultaneously constrain growth (current model)
3. **Interactive Co-limitation**: Resources can partially substitute for each other

The literature (Saito et al. 2008, Ecological Monographs; Arrigo 2005, Journal of Phycology) suggests that different phytoplankton communities and environmental conditions exhibit different co-limitation behaviors. A flexible framework allows the model to adapt to different systems.

## Mathematical Implementation

Implemented a co-limitation exponent parameter (theta) that controls the interaction between nutrient and light limitation:

combined_limitation = (nutrient_limitation^theta + light_limitation^theta)^(1/theta)

Where:
- theta < 0 (e.g., -10): Approximates Liebig's Law (minimum of the two limitations)
- theta = 1: Multiplicative co-limitation (original model behavior)
- theta > 1: Allows partial resource substitution

This formulation:
- Reduces to multiplicative when theta = 1 (maintains backward compatibility)
- Provides ecological flexibility through a single parameter
- Is mathematically smooth and differentiable (important for TMB optimization)
- Has clear ecological interpretation

## Expected Improvements

1. **Better fit to data**: The model can now capture systems where one resource is clearly limiting
2. **Ecological realism**: Represents the diversity of phytoplankton limitation regimes
3. **Diagnostic capability**: The fitted theta value indicates the dominant limitation regime
4. **Maintains complexity**: No increase in state variables, minimal parameter addition

## Parameter Addition

theta: Co-limitation exponent
- Value: 1.0 (maintains current multiplicative behavior as default)
- Range: [-10, 3] (from strong minimum to moderate substitution)
- Units: dimensionless
- Priority: 2 (affects primary production, a core process)

This improvement addresses a fundamental ecological process while maintaining model parsimony.
