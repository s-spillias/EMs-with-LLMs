MODEL ASSESSMENT AND IMPROVEMENT PLAN

=== CURRENT MODEL EVALUATION ===

Strengths:
- Sophisticated age-structured population dynamics with juvenile/adult mortality differentiation
- Prey-switching behavior between coral types based on availability
- Accumulated recruitment potential mechanism for multi-year integration
- Temperature-dependent larval survival

Weaknesses Identified:
1. MECHANISTIC REALISM: The model uses SST deviations as a proxy for phytoplankton blooms, but this is indirect and potentially misleading. COTS outbreaks are driven by terrestrial runoff → nutrient pulses → phytoplankton blooms → larval food availability. Temperature affects this but is not the primary driver.

2. REDUNDANT COMPLEXITY: The model has TWO non-linear recruitment mechanisms:
   - Accumulated recruitment potential with threshold
   - Nutrient-mediated larval survival with sigmoidal threshold
   These may compete or create parameter identifiability issues.

3. PARAMETER VALUES SUGGEST STRUCTURAL ISSUES:
   - log_larval_survival_base = 0.0 (i.e., base = 1.0) seems high for a multiplier
   - The sigmoidal nutrient response can amplify this to unrealistic levels
   - sst_bloom_optimal (26.5°C) vs temp_optimal (28.5°C) attempts to separate wet/dry season effects but lacks mechanistic clarity

4. FOOD LIMITATION MECHANISM: Currently adds to mortality, but COTS can survive extended starvation. Food limitation should primarily affect growth and fecundity, not immediate survival.

=== PROPOSED IMPROVEMENT ===

ECOLOGICAL RATIONALE:
Crown-of-thorns outbreaks on the GBR are strongly linked to:
- Wet season flood events delivering terrestrial nutrients
- Phytoplankton blooms in coastal waters
- Enhanced survival of planktonic larvae (2-4 week critical period)
- Successful settlement and recruitment

The current model conflates temperature and food effects. A more mechanistically realistic approach is to explicitly model larval food availability as a dynamic state variable.

IMPLEMENTATION:
Add a "larval_food_pool" state variable that:
1. Increases with environmental conditions favorable for phytoplankton blooms (cooler SST during wet season, representing runoff events)
2. Decays over time (bloom consumption/dissipation)
3. Directly affects larval survival probability through a saturating functional response
4. Separates temperature effects (metabolic, development rate) from nutritional effects

This replaces the indirect "nutrient proxy" calculation with an explicit food pool, improving:
- Mechanistic realism (explicit representation of the phytoplankton → larvae pathway)
- Parameter interpretability (food pool dynamics vs. abstract nutrient sensitivity)
- Model parsimony (removes redundant sigmoidal threshold on nutrient proxy)

MATHEMATICAL FORM:
- Food pool dynamics: dF/dt = bloom_production * bloom_trigger - food_decay * F
- Bloom trigger: Based on SST being in favorable range for wet season blooms (cooler than dry season)
- Larval survival: Saturating response to food availability (Michaelis-Menten or Holling Type II)
- Temperature still affects larval survival but through metabolic/development pathways

PARAMETERS MODIFIED/ADDED:
- Remove: log_nutrient_sensitivity, log_nutrient_steepness, nutrient_threshold (replaced by food pool)
- Add: log_bloom_production (rate of food pool increase during favorable conditions)
- Add: log_food_decay (rate of food pool turnover)
- Add: log_food_half_sat (half-saturation constant for larval survival response to food)
- Modify: log_larval_survival_base becomes maximum larval survival when food is abundant
- Keep: sst_bloom_optimal (temperature triggering bloom production)
- Keep: temp_optimal (temperature for larval metabolic performance)

This change maintains similar model complexity but improves ecological realism by explicitly representing the key mechanistic pathway driving COTS outbreaks: environmental conditions → phytoplankton blooms → larval food → recruitment success.
