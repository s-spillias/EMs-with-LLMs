Purpose
This model captures episodic Crown-of-thorns starfish (COTS) outbreaks on the Great Barrier Reef by explicitly representing (1) adult COTS dynamics with immigration- and environment-modified recruitment, (2) selective predation on two coral guilds (fast-growing Acropora and slow-growing Faviidae/Porites), and (3) coral recovery limited by free space and thermal stress. It is designed for prediction given initial conditions and environmental forcing.

Ecological functioning
- Boomâ€“bust dynamics: Adult COTS abundance follows resource- and temperature-modified, Allee-affected growth with density dependence, producing rapid increases (booms) when larval supply and prey availability align, followed by declines (busts) as prey are depleted and density dependence intensifies.
- Triggers and sustainment: Outbreaks are triggered and sustained by (a) immigration pulses of larvae (cotsimm_dat), (b) warm sea-surface temperature anomalies (sst_dat) that elevate early survival (scaled smoothly), and (c) sufficient prey (coral cover), especially Acropora. An Allee effect suppresses recruitment at low adult densities.
- Predation and feedbacks: COTS feed selectively using a saturating multi-prey functional response (Holling II/III hybrid), removing coral cover from both guilds with preference toward fast coral. Depleted prey reduces COTS recruitment (feedback), and high COTS density further limits their growth (density dependence).
- Coral dynamics: Each coral guild grows logistically with free-space limitation and background mortality. Thermal stress reduces effective growth smoothly above a bleaching threshold. Predation losses depend on COTS abundance and prey availability. Total coral cover is bounded smoothly within [0, K_tot].
- Environmental modification: SST anomalies modify COTS recruitment (scaled logistic in [f_sst_lo, f_sst_hi]) and coral growth penalties (smooth ramp above a thermal threshold). All transitions are smooth to aid numerical stability.

Numerical safeguards
- Initial conditions: Predictions at t=0 are set to observed values (no optimized initial states).
- No leakage: Predictions at time t use only states and forcings from t-1.
- Stable functions: Softplus and logistic functions avoid hard cutoffs and enforce non-negativity and upper bounds.
- Likelihoods: Lognormal for strictly positive COTS abundance and logit-normal for coral proportions with minimum standard deviations.
- Parameter bounds: Implemented as smooth penalties, not hard constraints, within biologically reasonable ranges.
