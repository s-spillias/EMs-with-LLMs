Assessment and rationale

1) Fit to data
- Residuals file not provided in this context; cannot quantitatively assess fit. Conceptually, the model is well-posed and includes a rich observation model (lognormal for COTS and logit-normal for coral). The structure should capture broad trends, but outbreak timing and peak magnitudes may be smeared without explicit recruitment delays.
- Typical symptoms (to verify in residuals): (a) adult peaks predicted too early relative to observed outbreaks, (b) underestimation of rapid take-offs (heavy positive residuals at onset), and (c) lingering overestimation during busts if recruitment is not synchronized.

2) Alignment with project context
- The project emphasizes episodic, boom-bust COTS outbreaks with sharp increases then collapses and selective predation on coral guilds. The current model already includes:
  - Multi-prey Type II/III functional response (with preference via aF/aS, handling hF/hS, exponent q).
  - Coral thermal stress via bleaching and growth suppression.
  - COTS reproduction modulated by food intake, lagged temperature, Allee effect, and coral-linked carrying capacity.
- Missing piece: an explicit life-stage delay from larval production/settlement to visible adult predators. Empirically, COTS have a juvenile phase (cryptic, not counted in standard surveys) lasting ~1 year or more, which can decouple larval production from immediate adult abundance. Without this, models often under-represent outbreak pulse sharpness and timing.

3) Potentially missing or oversimplified processes
- Stage structure and maturation delay: Previously absent; critical for outbreak timing.
- Immigration pathway: Immigration was added directly to adults; ecologically it should augment the recruiting cohort and only later appear as adults.
- Other possible (not implemented here to keep parsimony): predator interference, refuge effects from habitat complexity, nutrient/runoff drivers for larval food, and extended juvenile duration.

Chosen improvement: One-year juvenile recruitment stage with survival-to-maturity (sJ)
- Approach type: Environmental modifiers and indirect pathway/feedback (stage-structured demography).
- What changed:
  - Added a juvenile state J_state representing recruits that settle this year and mature next year.
  - Reproduction now populates J_state through a density-regulated recruitment term R_settle = rC * C_prev * (1 - C_prev / Kc) with environmental (food, temperature lag, Allee) modifiers as before.
  - Immigration is routed to juveniles: R_settle += gamma_imm * immigration_{t-1}.
  - Adults at time t are updated by baseline mortality and the maturation of last year’s juveniles: C_t = C_{t-1} - mC_base*C_{t-1} + sJ * J_{t-1}.
- Why this helps:
  - Introduces a biologically grounded lag, allowing sharp and episodic cohort pulses in adult abundance that better match observed outbreak dynamics.
  - Prevents artificial “instant” conversion of favorable environmental conditions into adult abundance.
  - Keeps the rest of the trophic/thermal feedbacks intact; only the demographic pathway is refined.
- Expected residual improvements:
  - Reduced positive residuals at outbreak onsets (predicted adults peak closer to observed timing).
  - Better capture of peak magnitudes (sharper adult surges).
  - Faster collapse of adults post-peak if juvenile supply wanes (depending on sJ and rC_max), improving bust dynamics.

Parameter updates
- Added sJ: survival-to-maturity fraction for juveniles (0-1). Bounds: [0.05, 1.0]. Initial guess 0.5.
- gamma_imm now scales immigration into the juvenile pool (not directly to adults). Description updated accordingly.

Notes on identifiability and guidance
- sJ will interact with rC_max and gamma_imm. If non-identifiability arises, consider fixing sJ from literature (e.g., 0.3–0.7), or adding weak priors via the bound penalty weight w_pen.
- If residuals still show early adult peaks, consider:
  - Extending juvenile duration beyond one year (multi-cohort juvenile queue) or adding partial maturation probability (<1-year fraction).
  - Switching adult mortality to multiplicative exp(-mC_base) to avoid negative pre-positivity values (kept linear here for continuity).
- No current-time observations of response variables are used in predictions; only previous states and exogenous drivers are used.

Implementation summary
- model.cpp: Added J_state dynamics and sJ parameter; redirected immigration; preserved all observation models and coral dynamics.
- parameters.json: Added metadata for sJ and clarified gamma_imm semantics.
