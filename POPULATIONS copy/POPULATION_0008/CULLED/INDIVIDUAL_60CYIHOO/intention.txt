Assessment and rationale

1) Fit to data (residuals)
- A residuals file was not provided here. Please share it so we can quantify misfit patterns (timing of outbreak onset/peak/decline; magnitude biases; autocorrelation).
- Based on typical COTS dynamics, models without explicit positive density dependence in reproduction tend to (a) initiate outbreaks too easily at low densities or (b) mis-time peaks. The current structure uses an outbreak trigger based on prey + immigration and temperature, but lacks local fertilization limitation.

2) Alignment with PROJECT CONTEXT
- The model includes: temperature-modulated larval survival, multi-prey Holling Type II feeding, shared coral space limitation, immigration saturation, and an outbreak “trigger” that amplifies growth.
- For episodic boom-bust cycles, a key mechanism is fertilization success increasing with adult density (Allee effect). This creates thresholds for rapid population takeoff and helps maintain realistic low-density phases between outbreaks. This mechanism is currently missing.

3) Missing or oversimplified processes
- Positive density dependence (Allee effect) in reproduction: absent.
- Stage structure (juveniles vs adults): collapsed; acceptable for now if recruitment terms approximate maturation lag, but it can blur outbreak timing.
- External drivers (nutrients/runoff) beyond temperature: not explicitly included; immigration partially proxies it.
- Predator control and removal: not modeled.
- Coral refugia/heterogeneity: feeding uses uniform preferences; acceptable simplification given current goals.

Chosen single improvement

Introduce an Allee effect on local recruitment (fertilization success) using a quadratic Hill function:
- f_allee = N_prev^2 / (N_prev^2 + N_allee50^2), where N_prev is previous-year adult density and N_allee50 is the density at which fertilization success is 50%.
- Apply f_allee only to local (food-driven) recruitment rec_food; do NOT apply to immigration-driven recruitment rec_imm, as external larvae are not limited by local adult density.
- Ecological justification: COTS are broadcast spawners; fertilization success increases steeply with local adult density (pairwise encounters imply ~quadratic scaling). This mechanism establishes a threshold for outbreak onset and helps reproduce rapid boom and subsequent bust as prey is depleted.

Mathematical changes (implemented in model.cpp)

- New parameter: N_allee50 (ind/m2). Soft-bounded [0.01, 10].
- New term:
  f_allee = N_prev^2 / (N_prev^2 + N_allee50^2 + eps)
- Modified local recruitment:
  rec_food = e_cons_to_rec * (cons_fast + cons_slow) * f_T_cots * f_allee
- Immigration recruitment unchanged:
  rec_imm = beta_imm * f_T_cots * imm_scaled
- All updates use only previous states and current-year forcings; no use of current observations in transitions.

Expected effects

- At low N_prev, recruitment is strongly suppressed, stabilizing low-density periods and reducing false outbreaks.
- Once N_prev crosses ~N_allee50 (with sufficient prey and temperature), recruitment rapidly increases, enabling realistic boom dynamics.
- Peak magnitude and duration should be better governed by interaction of prey depletion (via consumption), negative density dependence (gamma_cots), and the new positive feedback.
- Residuals should show improved timing and amplitude; please provide the residuals to verify and, if needed, tune N_allee50.

Parameter review notes

- r_cots (0.8 y^-1) and m_cots (0.6 y^-1) allow modest net growth before density dependence and triggers. gamma_cots (0.8) provides strong self-limitation at high densities.
- Feeding parameters (a_fast=2.0, a_slow=0.6; h_fast=0.5, h_slow=0.8) encode higher preference/efficiency on fast corals; consistent with empirical patterns.
- K_total=0.8 caps total coral; logistic growth terms are temperature-modulated and likely adequate for this scope.
- e_cons_to_rec, beta_imm, and K_imm remain initial estimates; with Allee in place, re-estimation may shift them downward because local recruitment is now throttled at low densities.

Suggested bounds for new parameter

- N_allee50: lower_bound=0.01, upper_bound=10.0 ind/m2. This spans sparse to moderately high adult densities typical in reef surveys; estimation will identify site-specific thresholds.

Next steps

- Refit and examine residuals for: (a) outbreak onset timing, (b) peak overshoot/undershoot, (c) bust duration, (d) coral cover biases during/after outbreaks.
- If residuals indicate delayed busts, consider adding temperature- or prey-dependent adult mortality or a simple maturation lag; otherwise keep the model minimal.
