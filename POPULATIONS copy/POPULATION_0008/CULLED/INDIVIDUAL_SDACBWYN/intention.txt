Assessment of current model and rationale for improvement

1) Fit to data
- Requested residuals file was not provided in this context, so quantitative residual analysis was not possible here. Conceptually, the model uses lognormal likelihoods for all three series (COTS, fast coral, slow coral) with SD parameters, which is a reasonable choice for strictly-positive states.
- Structural coupling of prey limitation across COTS processes and coral grazing through a single K_prey may impede fitting distinct timescales: it can force the same prey scale to control both (a) demographic processes of COTS (survival/recruitment) and (b) per-capita grazing intensity, potentially biasing fits and masking outbreak triggers/crashes.

2) Alignment with PROJECT CONTEXT
- The model includes key ingredients for boom-bust cycles: Allee effects, prey-limited survival/recruitment with Type-III nonlinearity (theta_recruit), temperature effects on COTS reproduction and coral growth, bleaching impacts on corals, and immigration forcing.
- However, the Type-II grazing response at low coral cover can over-predict continued coral losses even when prey is scarce, reducing the strength and duration of the bust phase. This can impair the model’s ability to reproduce episodic outbreaks (rapid rise followed by strong crash and recovery), which require low grazing pressure once prey is depleted so corals can recover, setting the stage for the next boom.

3) Missing or oversimplified processes
- Stage structure (cryptic juveniles) and nutrient-driven larval survival pulses are not represented; both can be important for outbreak initiation/synchronization.
- A single prey half-saturation (K_prey) is used for multiple processes; this is an oversimplification that reduces identifiability and ecological realism.
- Grazing functional response is Type-II; lacking prey refuge at low coral cover.

Parameter review and implications
- Topt_coral has been updated from literature; the Gaussian growth-temperature form remains appropriate given modest updates.
- K_prey is currently used for both COTS processes and grazing; literature suggests prey thresholds for feeding and for reproduction/settlement need not coincide. This motivates decoupling the grazing half-saturation from demographic prey limitation.
- No conflicting literature updates were found here that require changing other functional forms at this stage.

Chosen improvement (one meaningful ecological change)
- Implement a flexible Type-III grazing functional response with a separate half-saturation (K_graze) and an exponent (theta_graze ≥ 1). This introduces a low-prey refuge (per-capita grazing falls sharply when prey is scarce), strengthens the crash, and allows coral recovery after outbreaks, thereby better reproducing episodic boom-bust dynamics.
- Mathematical form:
    percap_graz = g_max * (avail^theta_graze) / (K_graze^theta_graze + avail^theta_graze)
  where avail = pref_fast * fast + pref_slow * slow (previous time step).
- K_graze is decoupled from K_prey (which continues to control COTS demographic prey limitation). This avoids over-constraining the system and improves identifiability.

Implementation notes
- Added parameters: K_graze (% cover), theta_graze (dimensionless). Suggested bounds reflect ecological plausibility and maintain numerical stability.
- No current time-step observations are used in process equations; only lagged states and forcings are used, preserving strict out-of-sample prediction integrity.
- All other processes unchanged to isolate the effect of this single, interpretable improvement.

Future extensions (not implemented here)
- Add nutrient/runoff pulses affecting larval survival/immigration.
- Include juvenile/cryptic stage dynamics with delayed maturation.
- Disturbance modules (cyclones, disease) impacting coral availability.
