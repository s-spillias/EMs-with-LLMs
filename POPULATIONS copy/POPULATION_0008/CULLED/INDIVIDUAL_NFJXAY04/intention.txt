Assessment and rationale for improvement

1) Fit to data
- The residuals file was not provided in this context, so a quantitative assessment (bias, autocorrelation, timing errors) cannot be performed here.
- Qualitatively, the current structure can generate boom-bust cycles via: (i) prey-modulated survival and recruitment, (ii) an Allee effect on recruitment, (iii) immigration forcing, and (iv) strong grazing feedbacks that reduce coral (and thus future prey), causing subsequent busts.
- Typical misfit patterns in outbreak models (from experience) include: (a) incorrect threshold behavior for outbreak onset, (b) overly diffuse peaks (peaks too broad), and (c) timing lag between observed and predicted peaks. These are most often tied to how nonlinearly recruitment responds to prey availability.

2) Alignment with the PROJECT CONTEXT
- Strengths:
  - The model includes selective feeding (pref_fast, pref_slow) and multi-prey functional response.
  - Outbreak dynamics are supported by an Allee effect and prey-limited survival/recruitment components.
  - Environmental modifiers (temperature for coral growth and COTS reproduction; bleaching for corals and COTS survival) are included.
  - Immigration forcing allows episodic larval supply pulses.
- Gaps relative to outbreak triggering and sustenance:
  - Local recruitment currently scales with a saturating yet near-linear prey term: P/(K_prey + P). This may be too gradual to reproduce the sharp “switch-like” onset of outbreaks seen when preferred prey (e.g., Acropora) is sufficiently abundant.
  - Without a stronger nonlinearity in recruitment vs prey, peaks can be too easily sustained at low prey, softening busts.

3) Processes likely missing or oversimplified
- Nonlinear prey effect on recruitment: Recruitment often responds superlinearly to prey availability/quality, creating thresholds for outbreak initiation. The model has an exponent on survival (theta_surv) but not on recruitment.
- Numerical stability: Coral predictions can become negative if losses exceed cover within a time step, which would make the lognormal likelihood undefined. A non-negativity guard is needed.
- Other candidates (not implemented here to keep one focused change):
  - Density-dependent adult mortality at high COTS density (disease/starvation).
  - Stage structure and multi-year larval delay.
  - Nutrient/runoff effects on larval survival (no such covariate is available in current data).

Chosen ecological improvement

Add a Hill-type nonlinearity on prey availability in local recruitment via a new exponent parameter theta_repr:
- Current: local_recr = r0_recruit * COTS_{t-1} * temp_repro * [P/(K_prey + P)]
- Proposed: local_recr = r0_recruit * COTS_{t-1} * temp_repro * [P/(K_prey + P)]^{theta_repr}
- Ecological justification:
  - A superlinear (theta_repr > 1) prey effect on local recruitment captures threshold behavior where recruitment remains low until prey (especially preferred fast-growing coral) is abundant, after which reproduction/survival to adulthood sharply increases. This promotes realistic, abrupt outbreak onset.
  - When prey is depleted, recruitment collapses faster, tightening the bust phase and improving the boom-bust asymmetry.
- Parsimony:
  - This introduces one parameter with clear ecological meaning and bounded range, minimizing complexity compared to alternatives (e.g., additional stages or environmental covariates).

Additional numerical stability fix (non-ecological but necessary):
- Floor coral predictions at zero each time step to prevent negative cover and ensure the lognormal likelihood is well-defined.

Parameter review and updates
- New parameter: theta_repr (dimensionless, suggested bounds 0–4), initial value 1.5. This range mirrors theta_surv and allows both sub- and superlinear responses.
- No other parameter ranges are altered; existing bounds are ecologically plausible and align with the provided parameters.json.

Expected effects on dynamics and residuals
- Improved timing and magnitude of outbreaks due to sharper recruitment response to prey availability.
- Reduced sustained low-level outbreaks when prey is scarce, improving post-peak decline.
- If residuals previously showed underprediction of peak magnitudes or lingering positive residuals after peaks, this change should reduce those patterns.

Notes on data usage and leakage
- All computations continue to use lagged predictions and lagged environmental/forcing variables (no use of current time step observations in process equations).

Next steps (if residuals become available)
- Check whether theta_repr > 1 is supported by data; if not, the model can easily revert to near-linear behavior (theta_repr ≈ 1).
- Examine autocorrelation in residuals for remaining timing lags; consider time delays or additional environmental drivers only if justified.
