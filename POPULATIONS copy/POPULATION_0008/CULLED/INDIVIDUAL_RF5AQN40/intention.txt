Assessment and rationale for model update

Summary
The current TMB model includes selective predation on fast and slow corals (Holling II with preference), environmental controls on recruitment (Gaussian thermal performance, logistic outbreak threshold on larval supply), food-limited fecundity, and a one-year maturation delay. These components support boom-bust behavior, but the consumption function can overstate per-capita feeding at high COTS density, potentially distorting peak magnitude and duration of outbreaks.

1) Fit to data
The residuals file was not available in the provided files. Typical mismatches for Holling II-only models include:
- Overestimation of coral loss during outbreak peaks (too-deep troughs in coral cover).
- Over-persistence or mis-timing of peak COTS density because per-capita feeding does not drop at high predator density.
- Underestimation of recovery rates post-peak if corals remain overly suppressed.

Please provide the residuals file or summaries (e.g., peak timing bias, peak magnitude bias, duration) to further validate and fine-tune the changes below.

2) Alignment with PROJECT CONTEXT
The project requires accurate timing, magnitude, and duration of episodic COTS outbreaks. Key strengths of the model:
- Outbreak triggers through larval supply (immigration + local production) modulated by SST and food.
- Selective feeding on coral functional groups.
- Smooth recruitment threshold for outbreaks.

Potential gap:
- Lack of predator interference in feeding can inflate coral loss during outbreaks, which feeds back into fecundity and can distort boom-bust dynamics. Including interference is a lightweight yet powerful improvement consistent with outbreak ecology.

3) Missing or oversimplified processes
- Predator mutual interference in consumption is missing (Holling II denominator lacks a COTS density term).
- Bleaching is modeled only as reduced coral growth, not direct mortality; this can be considered later if residuals show underestimation of coral losses during heatwaves.
- Juvenile refuge or age-structure not modeled; the current 1-year delay is a parsimonious alternative.

Chosen improvement: Beddington–DeAngelis interference in the consumption function
Ecological justification
At high COTS densities, individuals interfere with each other via aggregation, obstruction, and competition for prey access, reducing per-capita feeding rates. The Beddington–DeAngelis (BD) response captures this by adding a predator-density term to the denominator. This tends to:
- Reduce unrealistically rapid coral depletion during outbreak peaks.
- Shape peak amplitude and duration (key for boom-bust realism).
- Improve post-peak dynamics by preventing excessive prey suppression.

Mathematical formulation
Original consumption denominator (Holling II):
  denom = 1 + h * (a_f * F + a_s * S)

Updated denominator (Beddington–DeAngelis):
  denom = 1 + h * (a_f * F + a_s * S) + i_interf * C

Where:
- F and S are fast and slow coral cover at t-1,
- C is adult COTS density at t-1,
- i_interf ≥ 0 is an interference strength parameter to be estimated.

Implementation details
- Added a new parameter i_interf with soft bounds [0.0, 5.0].
- Updated consumption of fast and slow corals to use the BD denominator.
- Left all other processes unchanged to isolate the effect of interference on boom-bust dynamics.

Expected effects
- Peak coral loss moderated at very high COTS density.
- Potentially improved timing and duration of peaks if previous model over-persisted or mis-timed peaks.
- No data leakage introduced; only t-1 states are used.

Next steps after residuals review
- If residuals indicate underestimation of coral losses during thermal extremes, add a bleaching-induced direct coral mortality term.
- If peak timing is still off, consider a mild Allee effect in mating success at low adult density (separate from the larval-supply threshold), but only if justified by residuals.
