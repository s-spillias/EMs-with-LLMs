ASSESSMENT

1) Fit to data
- I do not have the residuals file in this chat context, so I cannot quantify the current fit. Please share the residuals file to allow diagnostics (bias, autocorrelation, heteroskedasticity, outliers).
- Based on structure alone, expected residual patterns if issues exist:
  - Timing errors (phase shift) if outbreaks are predicted too early/late due to the absence of a reproduction/maturation lag.
  - Overly smooth dynamics (underestimation of peaks, too-gradual onset) if the larval survival filter is not sufficiently pulse-like.
  - Possible bias during bust periods if mortality and density regulation alone cannot drive declines quickly once coral collapses.

2) Alignment with PROJECT CONTEXT
- Strengths:
  - Includes explicit selective predation on fast (Acropora) vs slow (Faviidae/Porites) coral via a multi-prey functional response with Type II–III flexibility (q_func).
  - Links COTS carrying capacity (Kc) to coral availability, enabling busts as coral declines.
  - Incorporates bleaching impacts on coral growth and mortality.
  - Includes an Allee effect and a temperature performance curve for COTS reproduction, both important for boom-bust ecology.
- Likely gaps relative to “episodic outbreaks” and their timing:
  - Reproduction/larval survival is driven by the current year’s temperature signal. In reality, larval survival depends on environmental conditions during spawning and early planktonic stages in the previous year; adults from that cohort contribute to the following year’s abundance (lag).
  - The temperature performance curve for larval survival is smooth (Gaussian), which may be too permissive; empirical evidence suggests survival can be pulse-like (thresholded) under favorable environmental windows (e.g., temperature and nutrient pulses).
  - External larval supply (immigration) should also reflect processes in the previous year.

3) Potentially missing or oversimplified processes
- Larval-stage processes: episodic survival windows influenced by environmental forcing (classically nutrients/runoff/chl-a and suitable temperatures) and a maturation delay before this signal appears in the adult survey index.
- Predator/competitor responses to COTS density (density-dependent mortality) may modulate the bust, but the current linkage of Kc to coral decline already helps drive collapses; this is secondary to addressing outbreak timing.
- Juvenile refuges and post-settlement survival heterogeneity are not explicitly modeled; those can be deferred until timing dynamics are improved.

PARAMETER REVIEW
- T_bleach has an updated literature value (31.75 °C). The current bleaching formulation (logistic with slope and center) remains appropriate; no structural change needed for this update.
- Other parameters are internally consistent with their current functional roles.
- Key area for refinement is the larval survival filter: adding shape flexibility and a biologically realistic lag.

CHOSEN ECOLOGICAL IMPROVEMENT

Approach: Environmental modifier with temporal lag and higher-order shape control for larval survival.

Justification:
- Outbreaks are episodic because larval survival spikes under favorable (often brief) conditions. This is better represented by (a) using the previous year’s environment for reproduction/larval survival (lag) and (b) allowing the environmental filter to be more pulse-like than a simple Gaussian.
- Implementing a 1-year lag aligns reproduction with the prior spawning season and avoids using contemporaneous data on the response variable (no leakage).
- Adding a shape parameter (alpha_larv) raises the Gaussian thermal performance to a power, making the survival filter sharper (for alpha_larv > 1) to capture outbreak pulses without specifying a new environmental covariate.
- External larval immigration should also be lagged by one year to reflect propagation waves.

Specific changes:
- Replace the temperature performance used in COTS per-capita growth with a lagged version based on SST at t-1 and introduce a pulse-sharpening exponent alpha_larv:
    T_perf_lag = exp(-0.5 * ((SST_{t-1} - Topt)/sigma_T)^2)
    T_pulse    = T_perf_lag^alpha_larv
- Use T_pulse (instead of the contemporaneous Gaussian) in the reproduction term:
    rC = rC_max * epsilon_food * I_sat * T_pulse * Allee_m
- Lag external larval immigration by one year:
    + gamma_imm * cotsimm_dat(t-1)
- Keep bleaching impacts on coral tied to the current year’s SST to represent same-year stress on coral.
- Add a new parameter alpha_larv (dimensionless) with bounds to control pulse sharpness; initial value 2.0 is a reasonable starting point, with bounds [0.5, 10.0].

Expected impact:
- Sharper, lagged larval survival pulses will improve timing and magnitude of booms.
- Coupled with existing feedbacks (coral depletion reducing Kc), busts should occur more abruptly once outbreaks depress coral.
- This change increases ecological fidelity with minimal added complexity and no additional data requirements.

DATA LEAKAGE CHECK
- Dynamics remain driven by previous states (t-1) and exogenous drivers. No use of contemporaneous observed response variables (…_dat) within the state evolution.
- Initial conditions are still taken from t=0 observations as before.

NEXT STEPS ONCE RESIDUALS ARE AVAILABLE
- Recheck phase alignment; if peaks remain phase-shifted, consider additional maturation delay or stage partitioning.
- Inspect peak magnitude bias; if peaks are still muted, tune alpha_larv and/or consider a nutrient proxy when available.
- Assess bust length residuals; if declines are too slow, consider modest density-dependent mortality or predator response in a later iteration.
