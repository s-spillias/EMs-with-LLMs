Assessment and rationale

1) Fit to data
- The residuals file was not provided in this chat, so I cannot directly quantify fit quality. Based on typical behavior of this class of models and the current structure, likely misfits commonly include:
  - Timing mismatch: peaks in predicted COTS abundance occur earlier or later than observed outbreaks.
  - Over-persistence post-peak: predictions may keep COTS elevated longer than observed, due to recruitment not collapsing quickly enough after prey depletion.
  - Amplitude mismatch: predicted peak levels can be too high or too low if recruitment scales too weakly/strongly with resource availability.
  - Residual autocorrelation: outbreaks are episodic and clustered, often leaving positively autocorrelated residuals if the trigger/feedback mechanisms are incomplete.

2) Alignment with the project context
- The model already captures many mechanisms important for COTS boom-bust dynamics:
  - Temperature effects on COTS reproduction and coral growth.
  - Bleaching impacts on corals and a heat-stress penalty on adult COTS survival.
  - A prey-dependent survival for COTS, local and immigration-driven recruitment, and an Allee effect.
  - Preference-weighted, multi-prey grazing that depletes corals selectively.
- However, the key ecological feature for sustaining and then terminating outbreaks is a strong, fast-coral (Acropora) dependent fecundity. Empirical work indicates gonad condition and fecundity scale steeply with access to preferred prey (Acropora). In the current model, local recruitment uses a prey index P/(K_prey+P) that mixes fast and slow corals. This can be too diffuse, underplaying the specific role of fast coral in driving fecundity during booms and in collapsing recruitment once fast coral is depleted. This weakens the feedback necessary to produce the sharp “bust” phase.

3) Missing or oversimplified processes
- Fast-coral-specific fecundity control: Recruitment depends on a combined prey index rather than the availability of preferred fast coral, likely diluting the feedback that ends outbreaks.
- Potential additional processes (not implemented here to keep the change focused and interpretable): predator control on COTS, flood/nutrient pulses, storm damage to coral, or explicit stage structure (cryptic juveniles). These may improve realism, but they add significant complexity and require additional data.

Chosen improvement

Ecological improvement: Make local COTS fecundity (recruitment from local adults) depend specifically and nonlinearly on fast coral (Acropora) cover via a saturating function with optional steepness (shape). This captures:
- Trigger: When fast coral is abundant, fecundity rises quickly (outbreak initiation and growth).
- Bust: As fast coral is depleted by grazing and bleaching, fecundity collapses, sharply reducing recruitment and hastening the decline.

Mathematical change
- Replace the generic prey-limited term P/(K_prey + P) in local recruitment with a fast-coral-specific saturating function with shape:
  fec_food = (f_prev / (K_fec_fast + f_prev))^gamma_fec
  local_recr = r0_recruit * c_prev * temp_repro * fec_food
  where:
  - f_prev is fast coral cover at t-1
  - K_fec_fast sets the half-saturation (percent cover) for fecundity vs. fast coral
  - gamma_fec allows supra-linear responses (gamma_fec > 1) that better capture rapid outbreak onset

Why this is appropriate
- It retains model parsimony (two parameters), directly targets the boom-bust mechanism highlighted in the project context, and uses only lagged state variables (no data leakage).
- It strengthens the negative feedback after fast coral depletion, addressing likely over-persistence and residual autocorrelation around outbreak peaks without requiring additional forcing data.

Parameter updates
- Added K_fec_fast (units: % cover) with suggested bounds [1, 40].
- Added gamma_fec (dimensionless) with suggested bounds [0.5, 4].
- These are initialized as reasonable priors and can be learned from the data. Literature on Acropora-driven fecundity suggests fecundity responds steeply to preferred prey availability, supporting gamma_fec > 1 and half-saturation in the 5–20% range for many reefs; bounds are set wider to allow site-specific calibration.

Implementation notes
- Only local recruitment is modified; adult survival remains prey-index dependent to represent general energetic support from all coral.
- No current time step observations are used; only lagged predictions inform transitions.
- The rest of the model (temperature effects, bleaching, grazing) remains unchanged to isolate the effect of the improved fecundity feedback.
