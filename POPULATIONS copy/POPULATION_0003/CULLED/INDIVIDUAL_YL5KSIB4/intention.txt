Assessment and rationale for model update

1) Fit to data (noting missing residuals file)
- I could not locate a residuals file in the provided project snapshot. Without it, a quantitative assessment is not possible here. Qualitatively, the current structure tends to smooth and advance recruitment signals because larval production (recruits) is added directly to the adult pool in the same year. This can lead to outbreaks that occur too early relative to known life-history lags (2–3 years to reach detectable/adult sizes), potentially misaligning the timing of predicted peaks versus observations.
- The observation models (lognormal for COTS; logit-normal for coral cover) are appropriate and numerically stabilized. SD floors guard against singularities.

2) Alignment with PROJECT CONTEXT (episodic boom–bust outbreaks)
- Strengths:
  - Recruitment depends on adult density via a fertilization success function with a tunable Hill exponent (nu_spawn), capturing Allee dynamics and threshold behavior.
  - SST modifies both larval success and coral performance, allowing for environmentally-triggered recruitment pulses and coral recovery constraints.
  - Selective predation on fast vs. slow coral is represented with a flexible Type II/III functional response and preference parameter, which enables community composition shifts that feed back on COTS food availability.
  - Adult survival depends on food (total coral cover), creating a post-outbreak crash mechanism when coral is depleted.

- Key gap:
  - No maturation delay from larval output to adults. Immediate addition of recruits to the adult pool compresses dynamics, damping realistic boom–bust timing and duration. Empirically, cohorts require roughly 2–3 years to contribute to adult outbreaks. Missing this lag can cause incorrect phasing and possibly underestimate outbreak amplitude persistence.

3) Potentially missing or oversimplified processes
- Juvenile stage dynamics absent (major). Juvenile survival bottlenecks and time-to-maturity are central to outbreak timing.
- Immigration currently treated as a direct adult contribution. The input is described as “external larval immigration,” so ecologically it should enter the juvenile pipeline rather than the adult pool.
- Additional processes that could be considered later (not implemented now to keep changes minimal):
  - Storm/bleaching pulses causing acute coral losses.
  - Nutrient/flow modifiers of larval survival beyond SST.
  - Refuge-mediated juvenile survival linked to algal cover (not available here).

Chosen improvement: Add a two-year juvenile maturation pipeline with survival

Justification:
- A simple two-stage juvenile pipeline introduces an explicit maturation delay while keeping the model parsimonious. It captures the observed lag between spawning and adult outbreak peaks and allows outbreak pulses to persist and phase correctly.
- We route both locally-produced recruits and external larval immigration into the first juvenile stage. Adults are augmented by juveniles maturing two years later. Adult density dependence (Beverton–Holt) continues to act on the adult pool.
- This change is minimal in parameter burden (one new parameter for juvenile annual survival, sJ) and aligns with life-history evidence for COTS growth to adult size.

Mathematical changes (annual time step):
- New parameter: sJ = inv_logit(logit_sJ) in (0,1).
- New state vectors: J1_t (yearling juveniles) and J2_t (subadult juveniles).
- Replace adult update:
   Prev: C_{t+1} = BH( C_t * survival + recruits_t + I_t )
   New:
     matured_t   = sJ * J2_t
     C_raw_{t+1} = C_t * survival + matured_t
     C_{t+1}     = C_raw_{t+1} / (1 + beta_dd * C_raw_{t+1})

   Juvenile pipeline:
     J1_{t+1} = recruits_t + I_t
     J2_{t+1} = sJ * J1_t

- Where recruits_t = fec * C_t * phi_spawn_t * phi_T_COTS_t, and I_t = alpha_imm * cotsimm_dat_t / (k_imm + cotsimm_dat_t).

Penalties:
- Add a smooth penalty on sJ to keep it in a biologically plausible range [0.2, 0.9], while still allowing learning from data.

Notes:
- This update preserves existing environmental modifiers and predation structure; it only changes the timing pathway into adults, which most directly addresses the outbreak timing/magnitude/duration goals.
- If residuals become available, we can revisit whether juvenile survival should be temperature- or food-modified, or whether a 3-year pipeline is warranted.
