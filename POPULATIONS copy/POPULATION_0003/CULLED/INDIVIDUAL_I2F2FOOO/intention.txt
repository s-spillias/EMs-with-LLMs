Assessment of current model and rationale for improvement

1) Model fit to data (residuals)
- The residuals file was not provided in this chat, so I cannot quantify lack-of-fit patterns directly. Structurally, the model recruits adults one year after reproduction and adds immigration directly into the adult pool. This tends to produce responses that are too immediate and smoothed compared to observed episodic outbreaks that show a lag between favorable larval conditions and adult population explosions. Typical symptoms in residuals for such structures are:
  - Timing mismatch: predicted increases occur too soon relative to observed peaks.
  - Peak magnitude biases: underestimation of outbreak peaks and overestimation during non-outbreak years.
  - Autocorrelated residuals in COTS adults suggesting missing internal memory/delay.

2) Alignment with the PROJECT CONTEXT
- The project emphasizes timing, magnitude, and duration of episodic outbreaks (boom–bust cycles). The current model includes important mechanisms—fertilization Allee effect, temperature-modified larval survival, food limitation, immigration, and adult density dependence—but lacks a maturation delay from juvenile to adult. This delay is central to reproducing realistic outbreak timing because COTS typically need multiple years to reach adulthood. Direct immigration to adults also bypasses critical pre-adult bottlenecks.

3) Missing or oversimplified processes
- Stage structure: No explicit juvenile stage; recruitment flows to adults immediately.
- Immigration pathway: Larval immigration adds directly to adults rather than to pre-adult stages.
- Pre-adult bottleneck: Juvenile survival and maturation processes are absent; these strongly shape cohort strength and timing.
- Other processes (kept for future work): storm/flood-driven nutrient pulses, predator dynamics, habitat complexity dependence of predation and recruitment, and temperature–nutrient interactions.

Chosen improvement: Add a juvenile stage with mortality and maturation; redirect immigration to juveniles

Ecological justification
- Life history: COTS typically take ~2–3 years to become reproductive adults. A juvenile stage introduces lag and cohort structure that are well-known to generate episodic dynamics consistent with observed boom–bust outbreaks.
- Trigger and sustain: Favorable SST and immigration increase juvenile production but adults respond after survival and maturation, better matching observed timing of peaks and duration of outbreaks.

Mathematical representation (annual time step)
- Let J_t be juvenile density at time t (ind m^-2).
- Recruitment to juveniles:
  R_t = fec * C_t * phi_spawn(t) * phi_T_COTS(t) * [phi_food(t)]^gamma_rec_food
- Juvenile survival and maturation:
  sJ = exp(-mJ)
  J_surv = J_t * sJ
  p_mat = inv_logit(logit_p_mat)
  M_t = p_mat * J_surv
  I_juv(t) = alpha_imm * cotsimm_dat(t) / (k_imm + cotsimm_dat(t))
  J_{t+1} = (1 - p_mat) * J_surv + R_t + I_juv(t)
- Adults:
  sA = exp( -[ mC + mC_food * (1 - phi_food) ] )
  C_{t+1,raw} = C_t * sA + M_t
  C_{t+1} = C_{t+1,raw} / (1 + beta_dd * C_{t+1,raw})

Implementation notes
- fec now represents juveniles per adult per year; immigration contributes to juveniles (not adults).
- New parameters: mJ (juvenile mortality rate), logit_p_mat (logit of annual maturation probability), J0 (initial juvenile density).
- All prediction steps use previous time-step predicted states; initial adult and coral states remain set from observed t=0, while J0 is estimated.
- The coral submodel and predation remain unchanged; this isolates the improvement to the COTS life-history structure while preserving existing fits to coral data.

Parameter updates summary
- Updated parameter semantics: fec, alpha_imm, k_imm.
- Added parameters: mJ, logit_p_mat, J0, with biologically plausible bounds (see parameters.json).
- If residuals later show overly high frequency oscillations, consider adding density dependence in the juvenile stage or making maturation food-dependent, but those are deferred to keep complexity minimal for this single improvement.

Expected benefits
- Improved timing of outbreaks due to maturation lag.
- Sharper peaks and realistic durations as cohorts mature.
- Reduced spurious immediate response to immigration forcing.
