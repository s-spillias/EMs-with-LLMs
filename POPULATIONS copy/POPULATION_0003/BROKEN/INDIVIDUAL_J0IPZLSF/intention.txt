Assessment of current model and rationale for improvement

1) Fit to data
- The residuals file was not provided in the current file set, so a quantitative residual-based assessment could not be performed here. Based on the process structure, the current model likely exhibits:
  - Over-smoothed recruitment dynamics: recruits are added directly to the adult population within the same year (no maturation delay). This tends to smear recruitment pulses over time, reducing peak amplitude and shifting timing relative to observations.
  - Stabilizing adult dynamics from Beverton–Holt crowding further damp variability, making it harder to produce sharp outbreak peaks seen empirically.

Typical residual patterns we would expect if this is occurring:
- Positive residuals (underprediction) during outbreak peaks if timing is lagged in observations but advanced in predictions.
- Negative residuals (overprediction) during the declining phase if predicted adults decay too slowly.
- Autocorrelation in residuals consistent with missing lagged processes.

2) Alignment with the PROJECT CONTEXT
- Strengths:
  - Incorporates selective predation on corals with flexible functional response (q ≥ 1, preference for Acropora).
  - Includes temperature modifiers for larvae and coral performance.
  - Food-limited adult survival links top-down (COTS) and bottom-up (coral) processes.
  - Immigration modeled with saturation captures external larval inputs.

- Gaps relative to episodic outbreak dynamics:
  - No explicit juvenile stage or maturation delay from larvae to adults. COTS typically require ~2–3 years to reach adulthood. Adult outbreaks are often the visible consequence of earlier larval survival pulses, thus a lag is crucial.
  - The existing Beverton–Holt crowding is stabilizing and appropriate to cap extremes, but without a time lag it can suppress the emergence of boom–bust cycles.

3) Missing or oversimplified ecological processes
- Missing: Stage structure with delayed maturity (juveniles). This is a primary mechanism for episodic adult recruitment.
- Oversimplified: Immediate translation of fecundity into adult numbers the same year; fec currently represents recruits to adulthood, which is unrealistic.
- Reasonable as-is (for now): Immigration saturation, temperature responses, and food-limited adult survival.

Chosen improvement: Add a juvenile stage with one-year maturation delay
- Objective: Better capture the timing, magnitude, and duration of adult outbreaks (boom–bust).
- Implementation:
  - New state: juveniles J(t).
  - Production of juveniles (settlement/early recruits): J_new(t) = fec * C_t * phi_spawn(t) * phi_T_COTS(t).
    - Note: fec now represents juveniles per adult per year (pre-adult stage).
  - Environmental modifiers:
    - Juvenile survival: sJ_env(t) = sJ0 * phi_T_COTS(t) * phi_food(t).
    - Maturation fraction: mature_frac(t) = gamma0 * phi_food(t).
  - Juvenile update:
    - matured(t) = mature_frac(t) * J_t
    - J_surv_remain(t) = max(J_t - matured(t), 0)  // remaining juveniles this year
    - J_next = J_surv_remain(t) * sJ_env(t) + J_new(t)
  - Adult update:
    - C_surv = C_t * exp( -[ mC + mC_food * (1 - phi_food(t)) ] )
    - C_raw_{t+1} = C_surv + matured(t) + I(t)
    - C_{t+1} = C_raw_{t+1} / (1 + beta_dd * C_raw_{t+1})  // retain Beverton–Holt cap
  - Initialization: J_0 = 0 (conservative, avoids data leakage).

Ecological justification
- Delayed density dependence is well supported for COTS: larval survival pulses (affected by environmental conditions) manifest as adult spikes after a lag due to maturation time. Incorporating a juvenile pool with environmentally modulated survival and maturation allows for:
  - Sharper, more episodic adult outbreaks under favorable conditions.
  - Natural boom–bust cycles as cohorts age out and food limitation increases adult mortality.
  - Improved timing alignment between predicted and observed adults.
- Complexity trade-off: This adds one state variable and two parameters (sJ0, gamma0). The added complexity is justified by the key role of maturation delays in outbreak dynamics.

Parameter changes
- fec: now defined as juveniles entering the juvenile pool per adult per year (not immediate adults).
- New parameters:
  - sJ0 (baseline juvenile annual survival probability). Bounds: [0, 1].
  - gamma0 (baseline annual maturation fraction to adults). Bounds: [0, 1].
- Both are biologically interpretable, identifiable in principle with time series that include outbreak timing, and constrained within plausible ranges.

Notes
- The model continues to avoid data leakage by only using previous time step states in process equations.
- If residuals indicate persistent timing mismatches or insufficient peak magnitude after this change, consider a two-year juvenile chain (adding J1, J2) or a Ricker-type overcompensation for adults. For now, a single-year delay is the minimal, interpretable improvement.
