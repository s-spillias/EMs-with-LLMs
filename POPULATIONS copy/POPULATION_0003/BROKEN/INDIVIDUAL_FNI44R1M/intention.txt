Assessment and motivation for changes

1) Model fit to data
- A residuals file was referenced but not provided in this chat. Please share it so I can quantify fit and identify systematic residual patterns (e.g., lagged peaks, amplitude mismatches, autocorrelation).
- Typical misfit without maturation delay: adult trajectories respond too quickly to recruitment pulses, producing smoother, lower-amplitude peaks and mistimed outbreaks relative to observations. This is consistent with the current structure, where recruits immediately enter the adult class in the next step via sJ.

2) Alignment with PROJECT CONTEXT
- Goal: episodic boom-bust outbreaks with sharp increases to outbreak levels, then declines; timing driven by environmental triggers and resource feedbacks; selective coral predation.
- Current model already includes: saturating coral consumption (Holling-like), coral logistic regrowth with total-cover crowding, temperature-modified recruitment, bleaching-induced coral mortality, Allee effects on reproduction, immigration forcing, and Beverton–Holt crowding for adults.
- Missing or oversimplified: cryptic juvenile stage with multi-year maturation delay—a key ecological mechanism for COTS that allows larvae to settle and remain hidden until favorable conditions trigger synchronized maturation and adult booms.

3) Key ecological processes possibly missing/oversimplified
- Stage structure: lack of explicit juvenile pool delays and buffers recruitment to adults; this delay is important for outbreak timing/magnitude.
- Environmental nutrient/runoff pulses could further modulate early survival (not available in current forcings).
- Predator/disease feedbacks on adults not included (potential future extension if residuals suggest overdose of adults).
- Composition-dependent fecundity already partially represented via resource-fueled recruitment (predF + predS).

Chosen improvement: Add an explicit juvenile stage (delay mechanism)
- Rationale: COTS juveniles are cryptic for ~2–3 years; outbreaks are often linked to cohorts maturing en masse after high-larval-survival years. A juvenile pool with survival and maturation (mJ, gJ) introduces realistic time lags and delayed density dependence, improving the model’s ability to generate sharp, timed booms while respecting data-leakage constraints.
- Mathematical form:
  - Recruitment: R_t = thermal_t * epsilon_repro * (predF_t + predS_t) * A_t + alpha_imm * IMM_t
  - Juveniles: J_{t+1} = softplus((1 - gJ) * (1 - mJ) * J_t + sJ * R_t)
  - Adults pre-crowding: Num_t = (1 - mC0) * C_t + gJ * (1 - mJ) * J_t
  - Adults post-crowding: C_{t+1} = Num_t_pos / (1 + bC * Num_t_pos), with Num_t_pos = softplus(Num_t)
  - Coral equations unchanged.
- Data-leakage: Only lagged state variables (t-1) are used; no use of current observations in prediction transitions.

Parameter implications
- sJ is reinterpreted as settlement/early survival into the juvenile pool (not directly to adults).
- New parameters added:
  - mJ (juvenile mortality, [0,1]): captures losses during the cryptic phase.
  - gJ (juvenile maturation, [0,1]): sets mean residence time; e.g., gJ ≈ 0.4 implies ~2.5-year average juvenile duration.
- Suggested initial values: mJ = 0.4, gJ = 0.4 based on literature and expert judgement; bounds [0,1].
- All other parameters retained; no change to observation models.

Next steps (pending residuals)
- With residuals, evaluate timing and amplitude improvements, check for residual autocorrelation reduction, and inspect whether additional environmental modifiers (e.g., nutrient/runoff proxies) on sJ or gJ are warranted.
