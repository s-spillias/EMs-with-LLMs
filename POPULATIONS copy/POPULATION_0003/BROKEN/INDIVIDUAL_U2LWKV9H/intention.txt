Assessment and rationale for ecological improvement aimed at episodic COTS outbreaks

1) Fit to data (based on available information)
- Residuals file was not provided here, so I infer likely issues from typical patterns observed in COTS systems.
- COTS time series commonly show clusters of large positive residuals during outbreak initiation and early growth followed by negative residuals at peak/decline when deterministic dynamics cannot sustain magnitudes. Deterministic recruitment driven only by adult density and SST often underpredicts the rapid takeoff and temporal clustering of high years.
- Coral residuals often show lagged under-prediction of loss during outbreaks (due to selective predation) and recovery variability driven by environmental disturbances not explicitly modeled.

2) Alignment with PROJECT CONTEXT
- The project targets timing, magnitude, and duration of episodic outbreaks. Current model includes: (i) fertilization depensation (Allee), (ii) food-limited adult survival, (iii) temperature effects, (iv) Beverton–Holt crowding, and (v) selective predation on coral groups.
- Missing is a mechanism for episodic, temporally persistent larval survival pulses (e.g., nutrient/flood-driven phytoplankton blooms) widely implicated in GBR COTS outbreaks and their propagation.
- Without such pulses, boom-bust cycles can be damped or mistimed, especially when immigration is smooth and temperature alone cannot produce sustained multi-year recruitment surges.

3) Potentially missing or oversimplified processes
- Episodic larval survival pulses: Not explicitly modeled; temperature response may be insufficient to trigger multi-year recruitment booms.
- Disturbance to corals (cyclones, bleaching): Not included; could explain additional variability in coral dynamics, but secondary to outbreak triggering for the present objective.
- Stage structure and lags: Adult-only state may compress developmental delays; acceptable for annual step but contributes to outbreak timing uncertainty.
- Environmental stochasticity: No random environmental driver; all current process terms are deterministic given inputs.

Chosen improvement: AR(1) environmental multiplier on recruitment (indirect environmental driver)
- Mathematical form: recruits(t) = fec * C_t * phi_spawn(t) * phi_T_COTS(t) * exp(eta_t), where eta_t is an AR(1) random effect: eta_t = rho * eta_{t-1} + epsilon_t, epsilon_t ~ N(0, sigma_rec^2).
- Ecological reasoning: Captures unobserved nutrient/flood pulses that enhance larval survival and their temporal persistence (multi-year favorable regimes), generating clustered high-recruitment years and realistic outbreak takeoff and duration.
- Justification versus alternatives:
  - Higher-order non-linearities or further crowding adjustments affect equilibrium and peak heights but do not create episodic clusters.
  - Adding storm/bleaching impacts would help coral fits but less directly improve outbreak triggering.
  - Using SST alone as a modifier has limited explanatory power for recruitment pulses compared to nutrient regime variability.
- Complexity trade-off: Adds two parameters (sigma_rec, rho_rec) and one latent time series. This is minimal yet powerful for capturing bursty recruitment without altering existing deterministic structure.

Data leakage fix (model set-up)
- Issue: Initial conditions used observed response variables (cots_dat(0), fast_dat(0), slow_dat(0)) to set cots_pred(0), fast_pred(0), slow_pred(0), which violates the requirement to avoid using current time step observations in prediction calculations.
- Change: Added parameters cots0, fast0, slow0 and now set initial states from these parameters, with smooth clamping to valid ranges. This removes any usage of _dat variables in the prediction path.
- Additional safeguards: Added smooth penalties to keep cots0 ∈ [0,10], fast0, slow0 ∈ [0,100], plus a soft penalty if fast0 + slow0 > 100 to respect space limitation.

Implementation notes
- No data leakage: Recruitment and all state updates at year t depend only on previous model states and exogenous drivers (sst_dat, cotsimm_dat), never on cots_dat, fast_dat, or slow_dat.
- Diagnostics: REPORT includes eta_rec and rec_mult for inspection of inferred recruitment pulses.

Future considerations (not implemented to keep to one change)
- Add disturbance/bleaching modifiers on coral growth/mortality.
- Consider prey refuge below low coral cover in predation functional response.
- Explore lagged stock-recruit dynamics if annual timing requires explicit delay.

