Purpose
Predict episodic boom–bust dynamics of Crown-of-Thorns starfish (COTS; Acanthaster sp.) on the Great Barrier Reef while accounting for selective predation on coral functional groups (fast-growing Acropora vs. slow-growing Faviidae/Porites) and environmental forcing (sea-surface temperature, SST) and larval immigration pulses.

Ecological functioning (concise)
1) COTS population dynamics (adults, individuals m^-2) follow an outbreak-capable Ricker process with:
   - Food-dependent carrying capacity and growth (more coral → higher per-capita growth and carrying capacity).
   - A smooth Allee-type trigger that yields rapid population takeoff when adult density exceeds a threshold.
   - Temperature performance curve that boosts or suppresses net growth according to SST (hump-shaped response).
   - Additive larval immigration that can initiate/sustain outbreaks during favorable conditions.

2) Coral dynamics (cover, %) are logistic with shared space limitation (total cover ≤ K_space), modified by SST, and reduced by COTS consumption via preference-weighted Holling type-III functional responses (Acropora preferred over slow-growing corals).

3) Feedbacks:
   - Top-down: COTS reduce coral cover via selective predation.
   - Bottom-up: Coral availability feeds back to increase COTS growth and carrying capacity.
   - Environment: SST modifies both COTS growth and coral growth with smooth performance curves.
   - Immigration pulses interact with favorable SST and high coral cover to trigger/sustain outbreaks.

4) Numerical robustness:
   - Smooth functions (logistic, softplus) prevent discontinuities.
   - Small epsilons guard against division-by-zero.
   - Parameters are softly bounded with penalties (no hard constraints).
   - Initial conditions are set from the first observations to avoid data leakage or over-parameterization.

5) Likelihood:
   - COTS abundance: lognormal errors (strictly positive).
   - Coral cover: normal errors with minimum standard deviations.
   - All observations contribute to the likelihood at every time step.

Outputs
Annual predictions for: cots_pred (adult COTS), fast_pred (Acropora cover), slow_pred (slow coral cover). Forcing series are passed through as sst_pred and cotsimm_pred to mirror inputs. All predictions are reported for downstream diagnostics and forecasting.
