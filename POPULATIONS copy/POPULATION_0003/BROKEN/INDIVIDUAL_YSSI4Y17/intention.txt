Assessment (provisional; residuals file not provided in this chat)
- Fit to data: Without residuals, direct goodness-of-fit cannot be quantified here. Please share the residuals file to refine this assessment. Based on similar models, typical misfits include under-predicted outbreak peaks, poor timing of takeoff, and overly smooth adult trajectories due to recruitment being too regular.
- Alignment with project context: The current structure includes temperature effects on larvae/corals, selective predation on fast vs slow corals, food-limited survival for adults, and Beverton–Holt crowding. This captures bust dynamics via food scarcity and density dependence, but it lacks a strong mechanism to trigger episodic booms. Outbreaks on the GBR are widely linked to occasional pulses of high larval survival/settlement associated with environmental conditions (e.g., flood plumes/nutrients) rather than continuous adult immigration.
- Potentially missing or oversimplified processes:
  1) Episodic, environment-driven pulses in larval survival and settlement (key for outbreak timing and magnitude).
  2) Explicit maturation delay/juvenile stage (delayed density dependence).
  3) Additional environmental drivers of coral recovery/mortality (e.g., cyclones, bleaching, disease).
  4) Spatial import/export of larvae (currently proxied by cotsimm_dat only as additive adult immigration).

Review of parameters and structure
- Topt_cots (28.5 °C) now has tight bounds; the Gaussian larval temperature modifier is appropriate and does not warrant a different functional form.
- Predation functional response allows Type II/III via q; this is flexible enough to represent prey switching.
- The additive adult immigration term (alpha_imm, k_imm) treats cotsimm_dat as immediate adult input, which can smear pulses and does not align with the hypothesized larval-stage origin of outbreaks.

Chosen single improvement: Environmental pulse on recruitment (environmental modifier of process)
- Rationale: To generate realistic boom years, recruitment should be strongly and occasionally amplified by environmental conditions. Using cotsimm_dat as a proxy for regional larval availability/nutrient-driven larval survival, we apply a saturating, thresholded multiplier to local recruitment at the larval stage. This focuses outbreak triggers where they occur ecologically and avoids double-counting via adult immigration.
- Mathematical change:
  - Define imm_excess_t = max(0, cotsimm_dat_t - imm_thr) with a smooth max.
  - Pulse multiplier: phi_pulse_t = 1 + gamma_pulse * imm_excess_t / (k_pulse + imm_excess_t).
  - Recruitment becomes: recruits_t = fec * C_t * phi_spawn_t * phi_T_COTS_t * phi_pulse_t.
  - Remove the additive adult immigration term I(t) and its parameters (alpha_imm, k_imm).
  - Adult update remains Beverton–Holt: C_{t+1} = (C_surv_t + recruits_t) / [1 + beta_dd * (C_surv_t + recruits_t)].
- Expected impact:
  - Timing: Outbreak takeoff aligns with high cotsimm_dat years (after threshold), improving peak timing.
  - Magnitude: Saturating amplification allows large but bounded peaks.
  - Duration: Subsequent busts are still governed by food limitation (phi_food), predation pressure on corals, and adult crowding, yielding realistic boom–bust cycles.

Parameter updates (added/removed)
- Added:
  - gamma_pulse (dimensionless, >=0): strength of pulse amplification on recruitment. Suggested bounds [0, 10].
  - k_pulse (ind m^-2 yr^-1): half-saturation for pulse driver. Suggested bounds [0.01, 5.0], initial 0.5.
  - imm_thr (ind m^-2 yr^-1): smooth threshold for onset of pulse effect. Suggested bounds [0.0, 2.0], initial 0.2.
- Removed:
  - alpha_imm, k_imm (adult immigration parameters), to avoid double-counting and reflect larval-stage origin of pulses.

Notes and next steps
- Please provide the residuals file to quantitatively assess improvements in timing, peak magnitude, and serial correlation of residuals. If residuals still show lagged structure after this change, the next candidate improvement is introducing a 1-year juvenile stage (delayed density dependence) so that recruits at t+1 depend on conditions at t via a state variable, which can further sharpen outbreak pulses without using current observations.
- The implementation avoids data leakage: only state predictions at t and exogenous drivers at t (sst_dat, cotsimm_dat) influence predictions at t+1.
