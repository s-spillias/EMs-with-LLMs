Assessment and rationale for model update:

1) Fit to data
- Residuals file was not provided in the current context. In similar COTS models, a single-step recruit-to-adult transition (one-year delay) tends to smooth cohort dynamics and can mis-time outbreak peaks. Observation models (lognormal for COTS; logit-normal for coral) are appropriate; floors on SDs avoid degeneracy.
- Expected residual issues without multi-year delay: (i) temporal autocorrelation in COTS residuals (under/over-shooting during outbreak onset/decay), (ii) lag mismatch between peaks in recruits/drivers and peaks in adults, (iii) overly diffuse peaks.

2) Alignment with project context
- The current structure captures important drivers (thermal performance, Allee effect, food-fueled recruitment, immigration, Beverton–Holt density dependence, selective coral predation).
- However, it lacks an explicit juvenile delay mechanism known to produce episodic, boom-bust outbreaks on the GBR via cohort resonance and multi-year accumulation before adult pulses.

3) Missing or oversimplified processes
- Absent multi-year juvenile pipeline (2–3 years) between larval production/survival and adult outbreaks.
- Potential environmental modifiers (e.g., nutrient/runoff pulses) that raise early survival; these could be layered in later once suitable forcings are available.
- Stage-specific survival variability; previously collapsed into a single efficiency (sJ).

Chosen improvement: two-stage juvenile delay (J1, J2)
- Ecological justification: COTS typically require >1 year to reach outbreaking adult size; survival bottlenecks across juvenile years create time lags. A two-stage pipeline introduces a ~2-year delay, enabling sharper adult pulses and more realistic boom-bust cycles without adding new data.
- Mathematical form:
   R_t = thermal_t * epsilon_repro * (predF_t + predS_t) * A_t + alpha_imm * IMM_t
   J1_{t+1} = softplus(R_t)
   J2_{t+1} = softplus(sJ1 * J1_t)
   C_{t+1}  = BH((1 - mC0) * C_t + sJ2 * J2_t)
  where BH(x) = softplus(x) / (1 + bC * softplus(x))
- Stability retained via Beverton–Holt on adults; positivity enforced via softplus; no data leakage (only previous states used).

Parameter updates
- Replace single-step juvenile-to-adult efficiency sJ with two survival parameters:
   sJ1: survival from settlers to 1-year-old (J1 -> J2); bounds [0,1].
   sJ2: survival from 1-year-old to 2-year-old contributing to adults (J2 -> adults); bounds [0,1].
- Initial values: sJ1 = 0.6, sJ2 = 0.3 (product ~0.18 similar in magnitude to prior sJ=0.2), to preserve initial scaling while allowing data-driven adjustment.

Expected effects on residuals and dynamics
- Improved timing of adult peaks relative to recruitment drivers; reduced lag-mismatch in COTS residuals.
- Sharper boom-bust cycles due to juvenile accumulation and delayed release into adults.
- Coral fits remain governed by predation and bleaching; coral residuals should not degrade, and may improve via better outbreak timing.

Implementation notes
- Added state vectors juv1_pred and juv2_pred (initialized to zero; reported for diagnostics).
- Replaced PARAMETER(sJ) with PARAMETER(sJ1) and PARAMETER(sJ2) and added penalties within [0,1].
- No changes to observation models; no additional data inputs required.

Next steps (post-fit diagnostics once residuals are available)
- Check ACF of COTS residuals for reduced autocorrelation and lag structure.
- Compare outbreak peak timing and magnitude before/after the change.
- If systematic biases persist, consider adding an environmental modifier for early survival (e.g., runoff/chl-a pulses) as a multiplier on R_t, with appropriate priors and no leakage.
