Purpose
This model simulates the daily dynamics of a classic three-compartment NPZ (Nutrient–Phytoplankton–Zooplankton) system in the oceanic mixed layer. It predicts concentrations of nutrient (N), phytoplankton biomass (P), and zooplankton biomass (Z) over time, given initial observed conditions and mechanistic process rates.

Ecological functioning (concise)
- Resource uptake and co-limitation: Phytoplankton growth is limited by both nutrient availability and light, represented using smooth, saturating functions and a smooth approximation to Liebig’s minimum rule. Maximum growth is additionally modified by temperature via a Q10 relationship.
- Trophic transfer: Zooplankton graze phytoplankton following a Holling-type functional response with a Hill exponent (Holling II or III as a special case), converting a fraction of ingested biomass into zooplankton growth (assimilation efficiency). The remainder is returned to dissolved nutrients via sloppy feeding and egestion.
- Loss processes and recycling: Phytoplankton and zooplankton suffer linear and density-dependent mortalities. A tunable fraction of these losses is remineralized back to nutrients, closing the recycling loop and providing feedback between compartments.
- Environmental modification of rates: A constant light-availability parameter and a temperature-modifier (Q10) allow environmental conditions to modulate physiological rates.
- Numerical robustness: All flows use smooth, bounded functions that avoid hard cutoffs. Small constants are added where necessary to ensure numerical stability and strictly positive arguments for logarithms.

Outputs and inference
- The model is fit to strictly positive observations of N, P, and Z using a lognormal observation model with a fixed minimum standard deviation to prevent numerical issues.
- Initial conditions for N, P, and Z predictions are set to their first observed values to avoid data leakage and unnecessary optimization over initial states.
