Goal: Predict the time-evolution of nutrient (N), phytoplankton (P), and zooplankton (Z) concentrations in the oceanic mixed layer.

Ecological functioning:
- Nutrient supply and recycling: The dissolved nutrient pool (N) is replenished by vertical mixing from deeper water and by remineralization of unassimilated grazing and mortality products. Mixing strength is modeled as a first-order relaxation toward a deep concentration.
- Phytoplankton growth: Phytoplankton (P) grows by assimilating dissolved nutrients following a saturating Monod limitation. Growth is further modified by a smooth seasonal environmental factor (proxy for light/temperature) constructed from a sinusoidal driver mapped through a logistic function to remain in [0, 1].
- Zooplankton grazing: Zooplankton (Z) grazes on P using a Holling type III functional response that captures a smooth predation refuge at low P and saturation at high P. A fixed assimilation efficiency converts a portion of ingestion to Z biomass; the remainder is routed to the dissolved nutrient pool via remineralization.
- Mortality and feedbacks: P experiences linear mortality; Z experiences quadratic mortality (representing higher-trophic predation/aggregation losses). A fraction of all losses is remineralized back to N, closing a rapid-recycling loop.
- Mass balance and positivity: Flows among N, P, and Z are constructed to maintain realistic feedbacks and non-negativity, with smooth penalties discouraging negative states and biologically implausible parameter values.

Numerical details:
- The state equations are integrated forward in time using explicit Euler with variable time step from the provided time vector. All process rates for time step i are computed from the previous step iâˆ’1 to avoid data leakage.
- Small constants are used to prevent division by zero and to stabilize logarithms in the observation model.
- Lognormal observation errors with minimum standard deviations are used for strictly positive concentrations.

Outputs:
- Predicted time series N_pred, P_pred, Z_pred that align one-to-one with the observed data vectors N_dat, P_dat, Z_dat and the time vector.
