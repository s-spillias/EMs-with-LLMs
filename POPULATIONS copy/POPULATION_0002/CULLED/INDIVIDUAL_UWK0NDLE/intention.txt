Assessment, gaps, and proposed improvement

Fit assessment (using structure + expected residual patterns)
- Residuals file was not provided here, so the following is based on structural expectations and common misfits in COTS outbreak models.
- The process model contains strong positive feedbacks for growth (Hill-type food availability, thermal performance, Allee effect) and a linear starvation penalty on mortality. This combination often produces:
  - Good outbreak initiation timing when food_hill_nu is moderately high.
  - Slower-than-observed collapses post-peak because mortality increases only linearly with scarcity, leading to positive residuals after outbreak peaks (observed > predicted crash rate).
  - Potential over-removal of coral in a single step when predator densities are high because consumption scales linearly with available coral in the current formulation; however, the current soft penalties may partially mask this.

Project-context alignment
- The model already targets boom-bust cycles with:
  - Resource limitation via food availability and carrying capacity K_eff.
  - A threshold-like recruitment efficiency through a Hill function (food_hill_nu).
  - A temperature modifier on reproduction (Gaussian TPC).
  - An Allee effect.
- These are appropriate for capturing outbreak triggers. Where it can fall short is the abrupt nature of the bust, which in reality can be rapid once coral prey are depleted.

Key processes potentially missing or oversimplified
- Starvation/disease-driven collapses: Currently scaled linearly with (1 - food_avail). Empirically, once preferred coral depletes, mortality escalates sharply; a super-linear response is ecologically justified.
- Handling-time-limited consumption on corals (Holling II/III at the prey level): Current predation on coral is linear in A_prop and S_prop and could exceed biologically plausible annual removal without saturation. This can produce unrealistically fast coral loss in some fits.
- Stage structure and time lags: Not represented; recruitment from consumption is effectively a one-year lag via t-1 states, which is reasonable but simplified relative to multi-year maturation.
- External nutrient pulses: Not represented due to lack of an input driver.

Parameter review and inconsistencies
- m_C (COTS baseline adult mortality) is 2.56 year^-1 in parameters.json, but model.cpp penalizes m_C > 2.0, creating a structural conflict. This likely biases the fit and should be reconciled. I broaden m_C bounds in both places to [0,5], centering inference around the literature value rather than penalizing it.
- Several parameters marked as “initial estimate” (e.g., k_bleach, H_half, K_food) appear plausible; without new evidence here, I leave them unchanged.

Chosen ecological improvement: nonlinear starvation mortality (environmental modifier of processes)
- Rationale: To reproduce sharp outbreak collapses once prey becomes scarce, starvation/disease/malnutrition mortality should escalate nonlinearly with scarcity. This is parsimonious (one new parameter), ecologically motivated, and directly targets the most common boom-bust misfit.
- Mathematical change:
  - Old: percap_mort = m_C * (1 + starvation_scale * (1 - food_avail))
  - New: percap_mort = m_C * (1 + starvation_scale * (max(0, 1 - food_avail))^{starvation_nu})
  - We implement this in a numerically stable, AD-safe way using exp(starvation_nu * log(scarcity + eps)).
- Expected effect on residuals:
  - Reduces post-peak positive residuals for COTS by producing faster, stronger crashes as coral depletes.
  - Has minimal effect during outbreak buildup (food_avail near 1) and at low densities (due to Allee limitation), preserving outbreak onset dynamics.

Other structural notes (left unchanged for now)
- Coral predation remains linear in A_prop/S_prop; if residuals show over-removal of coral or poor coral recovery dynamics, consider a Holling-II saturation at the prey level in a subsequent iteration.
- No data leakage is introduced; all t predictions use only t-1 states/drivers.

Parameter changes
- Added starvation_nu (dimensionless, lower bound 1, upper bound 5). This governs the curvature of starvation mortality with scarcity and should be identifiable from post-peak dynamics.
- Broadened bounds for m_C to [0,5] to align with literature value 2.56 and remove conflicting penalties.
