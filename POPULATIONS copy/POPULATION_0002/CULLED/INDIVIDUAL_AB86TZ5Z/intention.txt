Assessment summary

Note on residuals:
- A residuals file was referenced but not available in the provided files. The evaluation below is based on the current model structure, parameters, and typical COTS dynamics. Please share the residuals to refine diagnostics (e.g., timing and magnitude biases, autocorrelation).

1) Fit to data (structural assessment):
- The model uses all observations through well-posed likelihoods: lognormal for COTS abundance and logit-normal for coral cover. It avoids data leakage by using only previous-step predictions to advance states.
- Observation SD floors are handled consistently (min_sd), with sensible transformations.
- Without residuals, we infer a likely pattern: the single-year larval-to-adult transition can cause recruitment to respond too quickly to environmental or food cues. This often manifests as predicted outbreaks peaking 1 year too early and decaying too fast, a common bias in systems with real multi-year maturation.

2) Alignment with PROJECT CONTEXT (episodic outbreaks, boom–bust cycles, selective predation):
- The model has several realistic mechanisms: 
  - Food-dependent adult survival and fecundity via saturating food (preference-weighted coral cover).
  - Temperature effects on larval survival (Gaussian around Topt_larv).
  - Allee-like reproduction gate at low adult densities.
  - Flexible predation functional response (Type II–III via q_pred).
  - Coral thermal responses and bleaching mortality.
- Key gap relative to episodic outbreak dynamics: maturation delay. COTS typically require ~2–3 years to reach reproductive adulthood. A 1-year larva→adult transition compresses the life-history pipeline and can dampen or mis-time boom–bust cycles. In pulsed environments, the delay is essential to convert short-lived environmental opportunities into delayed population booms.

3) Missing or oversimplified ecological processes:
- Maturation delay/stage structure: Not represented. This is critical for outbreak timing and duration.
- Nutrient/runoff-driven larval survival pulses: Currently proxied only by SST (EnvLarv) and an exogenous immigration series (cotsimm_dat). Where nutrient indices are unavailable, a maturation pipeline provides an endogenous delay that better captures episodic booms without overfitting.
- Settlement/early juvenile survival: Implicitly embedded in the single mu_adult parameter; separating early (larva→juvenile) and late (juvenile→adult) transitions improves realism and identifiability.

Chosen improvement: Add a two-year maturation pipeline

Ecological reasoning:
- COTS reach sexual maturity after ~2–3 years; a two-year pipeline is a pragmatic, low-parameter way to introduce delayed density dependence that produces more realistic outbreak timing and persistence.
- Delays in recruitment to the adult stage tend to amplify boom–bust dynamics and reduce sensitivity to single-year noise, matching observed episodic outbreaks.

Mathematical implementation:
- Replace the “instant” adult recruitment term with a two-stage pipeline (two annual juvenile stages).
- Let L_t be larval output (already computed). Introduce two juvenile buffers J1 and J2:
  - J1_{t+1} = mu_juv * L_t
  - J2_{t+1} = mu_juv * J1_t
  - Adults: C_{t+1} = sA_t * C_t + mu_adult * J2_t
- mu_juv in (0,1) is a new logit-parameterized annual progression/survival fraction through juvenile stages. mu_adult is repurposed to be the annual fraction of late juveniles/subadults maturing to adults.

Why one added parameter is sufficient:
- Using a single mu_juv for both juvenile transitions adds delay and cumulative subadult mortality without proliferating parameters.
- This maintains parsimony, helps identifiability, and directly targets a key outbreak mechanism (delayed recruitment).

Parameter review and updates:
- Topt_larv bounds were recently curated from literature, consistent with the current Gaussian thermal response; structure remains appropriate.
- logit_mu_adult description updated to reflect maturation from late juveniles to adults.
- New parameter logit_mu_juv introduced with broad logit bounds and soft penalties to keep values in a biologically plausible range (roughly 0.05–0.8 on the probability scale).

Expected effects on dynamics:
- Outbreak peaks are delayed relative to larval production spikes, improving timing.
- Longer outbreak tails due to stored subadult cohorts, enhancing bust-to-boom transitions and persistence.
- Reduced tendency for unrealistically rapid boom and immediate bust following single-year environmental pulses.

Next steps:
- Once residuals are available, assess timing offsets, magnitude biases, and residual autocorrelation. If significant year-to-year structure remains, consider adding a nutrient/runoff index to EnvLarv or allowing temperature-dependent adult survival. For now, the added maturation pipeline should materially improve outbreak realism with minimal complexity.

