Assessment of current model (before change)
1) Fit to data
- The prompt references a residuals file, but it is not included in this chat. Without residuals I cannot quantify fit (bias, autocorrelation, peak timing errors). In similar COTS applications, common issues are:
  - Under-prediction of outbreak peaks (magnitude bias) and/or delayed peaks (timing bias).
  - Overly smooth adult trajectories that fail to capture sharp boom-bust transitions.
  - Coral cover declines that are either too gradual or exceed 100% during strong outbreaks.
- The current model already constrains cover via soft penalties and produces boom-bust adult dynamics through: (i) a resource-dependent carrying capacity, (ii) temperature-modulated growth (TPC), (iii) a Type-III predation response on corals, and (iv) one-year delayed juvenile maturation tied to food and adult density. These elements typically help but may still produce outbreaks that are either too frequent or insufficiently sharp.

2) Alignment with PROJECT CONTEXT
- Strengths:
  - Outbreak mechanism: Positive feedback between coral availability (food) and COTS growth via K_eff and food_avail.
  - Bust mechanism: Depletion of coral lowers food_avail and K_eff, increasing starvation mortality and reducing growth.
  - Temperature modifies growth (TPC) and coral bleaching affects coral mortality, introducing environmental forcing.
  - One-year juvenile lag allows some cohort structure and delayed feedback, which is important for outbreaks.
- Limitations for context:
  - COTS typically take 2–3 years to reach reproductive adult sizes; a single-year maturation lag can be too short to reproduce realistic cohort resonance and multi-annual oscillations that set the timing and magnitude of outbreaks.
  - Juvenile-to-adult maturation is likely temperature-sensitive (e.g., growth and development rates), but temperature currently affects only adult growth via TPC, not maturation.
  - As a consequence, peak timing and duration may be mismatched, with adults responding too quickly to favorable conditions.

3) Missing or oversimplified processes
- Juvenile stage structure: Only one lagged juvenile cohort is modeled. Empirical evidence suggests multi-year juvenile/subadult stages with variable maturation timing (fast vs slow), driven by both food and temperature.
- Environmental modifier on maturation: Food modifies maturation, and adult crowding suppresses it, but temperature effects on juvenile development are absent.
- The remaining processes (resource limitation, Type-III predation, bleaching effects, Allee at low C) are reasonable for the scope.

Review of parameters and structure
- m_C is effectively fixed at 2.56, concentrating dynamic flexibility in r_C, K_C, and recruitment pathways. This increases the importance of realistic cohort delays for outbreak timing.
- Topt_C is tightly bounded (28–29 °C), sigma_T_C moderately broad (1.5 °C). Adult growth responds to SST, but juvenile maturation does not.
- Placeholders that suggest structural refinement: the existing juv_surv and juv_food_alpha sensibly modulate first-year maturation, but the lack of a pathway for slower maturation likely forces juv_surv to absorb two processes (fast maturation vs delayed maturation carrying over to a later year).

Chosen improvement: two-cohort juvenile pipeline with temperature-modulated maturation
Rationale:
- Ecological realism: COTS often require 2–3 years to reach outbreaking adult densities. Introducing a second juvenile/subadult pool captures delayed maturation and produces cohort resonance, a known driver of boom-bust dynamics and sharp adult peaks.
- Environmental modifier: Extend the influence of temperature (TPC) to maturation, not just adult per-capita growth. This allows warm favorable conditions to speed maturation and synchronize cohorts, accentuating outbreak peaks; unfavorable conditions slow maturation, lengthening inter-peak intervals.
- Parsimony vs complexity: Adds one additional state (second juvenile cohort) and three parameters, but meaningfully improves timing and magnitude of outbreaks without introducing new data requirements.

Mathematical changes
- Keep current first-year juvenile cohort J1 (juv_prev).
- Add a second cohort J2 (subadults): survivors from J1 that did not mature in the first year.
- Maturation efficiency multiplier now includes temperature:
  f_food = Food^juv_food_alpha
  f_den  = juv_density_half / (juv_density_half + C_prev)
  f_temp = TPC^juv_temp_alpha
- First-year maturation to adults:
  juv1_mature = juv_surv * f_food * f_den * f_temp * J1_prev
- Carry-over to second cohort:
  J2_next = juv_carry * (J1_prev - juv1_mature)
- Second-year maturation to adults:
  juv2_mature = juv2_surv * f_food * f_den * f_temp * J2_prev
- Adult recruits added each step:
  R_juv->adult = juv1_mature + juv2_mature
- Update cohorts:
  J1_new = rec_from_food + imm_surv * IMM_prev
  Next-year states: J1_prev = J1_new; J2_prev = J2_next

New parameters (with suggested bounds):
- juv_carry (0–1): survival fraction for first-year juveniles that do not mature and carry to a second subadult year.
- juv2_surv (0–1): baseline survival-to-adult fraction for the second-year subadults.
- juv_temp_alpha (≥0): elasticity of temperature performance (TPC) on maturation efficiency.

Expected effects on fit and dynamics
- Sharper, more episodic outbreak peaks: cohort synchronization under favorable temperature and high food conditions increases peak magnitude and shortens rise time.
- More realistic inter-peak intervals and bust duration: delayed maturation supplies adults one year later, sustaining or delaying peaks and better matching observed multi-annual cycles.
- Residuals (anticipated): reduced peak underprediction, reduced lag in peak timing, and less autocorrelation in residuals around outbreaks.

Notes
- No data leakage is introduced: all drivers (C_prev, A_prev, S_prev, T_prev, IMM_prev, J1_prev, J2_prev) are from t-1.
- The adult growth term is unchanged; only the recruitment pipeline to adults is refined.

If residuals become available, I can validate these expectations (peak bias, timing, residual ACF) and iterate on juv_temp_alpha and the balance between juv_surv and juv2_surv to match observed outbreak durations.
