Assessment and rationale for update

Data fit (provisional):
- A formal assessment needs the residuals file (not included here). Structurally, the current model risks:
  - Under-predicting outbreak peaks because recruitment from predation and immigration enters the adult class within the same year, dampening pulses.
  - Mistiming boom onset due to lack of a maturation delay that translates environmental anomalies into next-year adult recruitment.
  - Over-smoothing declines, since the same-year recruitment term counteracts post-peak crashes.

Project-context alignment:
- Strengths: Type-III predation on corals, Allee effect in COTS, resource/food limitation, temperature-modulated performance for adult demography, and immigration are included.
- Missing/oversimplified: No explicit larval stage and no maturation delay; recruitment is not temperature-pulsed; immigration goes straight to adults. Empirically, episodic larval survival (often temperature- and nutrient-associated) and a lag to adulthood are central to boom-bust dynamics.

Chosen ecological improvement:
- Introduce a 1-year maturation delay with temperature-modulated survival of the larval pool:
  - Build a larval pool L_t from (a) predation-driven fecundity and (b) larval immigration at year t.
  - Adults at year t+1 receive recruits = p_mat * (TPC_t)^(theta_rec_T) * L_t.
  - Here TPC_t = exp(-0.5 * ((SST_t - Topt_C)/sigma_T_C)^2). This reuses the existing thermal performance formulation but applies it to larval maturation, creating episodic pulses tied to environmental conditions.
  - This modification preserves the rule against data leakage by using only t-1 values to compute year t predictions.

Why this helps:
- Timing: Anomalously favorable SST in year t produces high recruitment at t+1, aligning peak onset with environmental drivers.
- Magnitude: Nonlinear temperature shaping via (TPC^theta_rec_T) allows sharp recruitment pulses, consistent with observed outbreak spikes.
- Duration: Once corals are consumed and food availability falls, starvation mortality and lower K_eff rapidly reduce COTS, preserving the bust phase.

Parameter updates:
- imm_surv now represents the fraction of larval immigration entering the larval pool (pre-maturation), not direct adult survival; description updated.
- New parameters:
  - p_mat (dimensionless, 0..1): baseline maturation probability from larval pool to adult class after one year.
  - theta_rec_T (dimensionless, 0.5..4): exponent controlling how sharply SST modulates maturation success via TPC^theta_rec_T.

Implementation notes:
- No current-step observation values are used in predictions; only t-1 states and drivers are referenced.
- Added a reported diagnostic vector L_pool (larval pool generated at t-1 that will mature the following year).
- After refitting, inspect residuals for: (i) reduced positive residuals at outbreak peaks, (ii) improved timing of upswings, and (iii) post-peak declines not being muted by same-year recruitment.

Next steps pending residuals:
- Validate whether residuals pre-change showed peak underestimation and phase lag; if nutrient/runoff drivers are available later, consider adding a covariate to L_t.
