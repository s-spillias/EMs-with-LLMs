Assessment (data fit, context, and gaps):
- Residuals: The residuals file was referenced but not available here, so a quantitative fit check could not be completed. To evaluate fit we would inspect: (i) COTS log-residual autocorrelation (outbreak timing), (ii) amplitude bias (under/over-shoot of peaks), (iii) duration bias (how long outbreaks persist), and (iv) coral cover residual structure around bleaching periods.
- Project context: The model already includes key components for boom-bust cycles: a Type-III predation response, food-limited growth, an Allee effect, thermal performance (TPC) for COTS reproduction, and a one-year juvenile lag with immigration. These create delayed density dependence and can trigger outbreaks when coral is abundant and temperatures are favorable, then crash due to resource depletion and mortality.
- Gaps identified:
  1) Missing coral-refuge effect on juvenile survival to adulthood. Juvenile COTS benefit from coral structure; following outbreaks, reduced coral cover should depress juvenile-to-adult maturation, reinforcing the bust and spacing subsequent booms.
  2) Parameter bound inconsistency: m_C is fixed at 2.56 in parameters.json but model.cpp penalized values >2.0, creating systematic pressure on estimates and potential bias.

Chosen improvement: Add a coral-refuge modifier to juvenile maturation
- Ecological rationale: Juvenile survival to adulthood depends on habitat complexity and shelter provided by coral. After heavy predation reduces coral, juvenile survival should decline, suppressing recruitment to adults and hastening crash recovery dynamics. This indirect feedback is well-matched to the observed episodic nature of COTS outbreaks.
- Mathematical form (proportions):
  Refuge(A,S) = (A_{t-1} + S_{t-1}) / (K_refuge + A_{t-1} + S_{t-1}), 0..1.
  Juv maturation: R_juv->adult,t = juv_surv * Refuge(A_{t-1}, S_{t-1}) * J_{t-1}.
  This uses only t-1 state variables, avoiding data leakage.
- Complexity trade-off: Adds a single parameter (K_refuge) and one multiplicative term. This is a parsimonious mechanism with strong ecological basis and is less invasive than adding additional lags or unobserved stages.

Parameter updates:
- New parameter K_refuge (proportion): Half-saturation constant for coral-refuge effect on juvenile maturation.
  Suggested bounds: [0.01, 0.6]; Default: 0.15. Smaller values imply strong refuge at low coral cover; larger values require more coral to achieve high survival.
- Consistency fix: Expand the soft upper bound for m_C in model.cpp to 3.0 to include the literature value 2.56 year^-1, preventing persistent penalties.

Model implementation details:
- model.cpp: Introduced PARAMETER(K_refuge), added soft penalties for K_refuge, computed juv_refuge = saturating01(A_prop + S_prop, K_refuge), and updated juv_mature = juv_surv * juv_refuge * juv_prev. Increased the m_C penalty upper bound from 2.0 to 3.0.
- No current time step observations (â€¦_dat) are used in prediction updates; all process updates rely on t-1 predicted states or exogenous drivers, preserving causal structure.
- parameters.json: Added K_refuge with description and bounds.

Next steps (once residuals are available):
- Check whether outbreak peak timing improves (phase errors should reduce if post-outbreak suppression is stronger).
- Evaluate if outbreak amplitudes become less biased (refuge constraint can temper multi-year, overly persistent peaks).
- Inspect coral cover residuals for over-correction; if needed, consider a second juvenile year (additional lag) or temperature-modulated settlement efficiency as future extensions.
