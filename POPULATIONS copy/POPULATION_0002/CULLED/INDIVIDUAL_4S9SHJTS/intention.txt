Assessment and rationale for improvement

Model fit
- Residuals: A residuals file was referenced but not found among the provided files. Please supply it for quantitative assessment. The comments below are based on structural considerations typical of COTS outbreak dynamics.
- Structural expectations: The current model includes key mechanisms (predation on fast/slow coral, environmental thermal modifiers for larvae and coral, bleaching mortality, and an SST anomaly pulse affecting larval survival). These can reproduce general boom-bust features but may compress the outbreak timing because maturation is assumed to occur directly from larvae to adults within one year.

Alignment with project context
- The project emphasizes accurate timing, magnitude, and duration of COTS outbreaks. Literature indicates COTS typically require ~2–3 years to mature. The model currently channels a fraction of “larvae” directly into adults after one year, which can produce outbreaks that rise too quickly, peak too early, and decay unnaturally.
- The model already accounts for selective predation on coral functional groups and includes an environmental pulse (SST anomaly) on larval survival. This is reasonable, though in many GBR systems nutrient-driven river flood events are also implicated; SST is a proxy but not a perfect driver.

Potentially missing or oversimplified processes
- Maturation delay: No explicit juvenile stage is represented; maturation occurs from larvae to adults in one year via mu_adult. This likely underestimates the lag from reproduction to outbreaks and can distort outbreak duration.
- Settlement/juvenile habitat limitation: Not explicitly modeled; fast coral often provides better habitat for early stages. This may be a future enhancement if residuals indicate.
- Predator removal and control: Not represented; may be less relevant for timeseries without control actions.
- Movement/connectivity: Immigration is an exogenous forcing already included; a full spatial structure is beyond scope here.
- Predation nonlinearity: Already included via Hill-type function with shape exponent (q_pred).

Parameter review highlights
- log_r_fast is fixed to a very narrow band at ~0.05 y^-1 in parameters.json (updated_from_literature true). While the code uses soft penalties, such a narrow prior may limit fit if data suggest faster recovery of Acropora. Consider loosening in future if residuals show bias.
- logit_mu_adult is described as fraction of larvae maturing to adults in one year. Literature suggests ~2–3-year maturation. This implies the current equation structure is misaligned with the updated understanding.
- Immigration scaling log_k_imm currently converts larval immigration to adult-equivalent recruits. With the addition of a juvenile stage, immigration should contribute to the juvenile pool instead.

Chosen improvement: Add an explicit juvenile stage with multi-year maturation
Justification
- Ecological realism: Introduces a realistic maturation delay. Juvenile survival losses and staggered maturation distribute recruitment to adults over multiple years, improving timing and duration of outbreaks.
- Dynamical benefit: Time delay enhances oscillatory boom-bust dynamics, reduces unrealistically abrupt adult spikes, and can sustain outbreaks when juvenile cohorts are large.
- Parsimony: Adds one new state variable and two parameters (juvenile mortality rate, initial juvenile density). It reuses existing mu_adult as annual maturation fraction, now applied to juveniles.

Mathematical changes
- Juvenile dynamics:
  J_{t+1} = sJ * J_t + L_t
  sJ = exp(-mJ), with mJ = exp(log_mJ) > 0
- Adult update becomes:
  C_{t+1} = sA_t * C_t + mu_adult * J_t
- Larval production L_t is unchanged, still including the SST-modulated pulse and immigration:
  L_t = phi * C_t * Food_t * EnvLarv_t * exp(-beta * C_t) * A_gate_t * Pulse_t + k_imm * cotsimm_dat(t)
- Observation models unchanged; juveniles are latent.

Parameter updates
- Add log_mJ (log juvenile mortality rate) with plausible range (e.g., 0.1–5 y^-1 on natural scale).
- Add log_j_init (log initial juvenile density).
- Update semantic descriptions for:
  - logit_mu_adult: now “fraction of juveniles maturing to adults in one year.”
  - log_k_imm: now “converts larval immigration to juvenile-equivalent recruits.”

Data usage safeguard
- No current-timestep observations are used in state updates; transitions use only previous predictions and exogenous forcings.

Next steps
- Please provide the residuals file for quantitative diagnostics. If residuals show persistent lag or duration mismatches after this change, we can consider adding juvenile environment modifiers or settlement dependence on coral cover as a follow-up.
