Assessment and rationale

Summary of current structure:
- Coral (fast/slow) logistic growth with thermal performance and bleaching-induced mortality; COTS predation with saturating functional response and smooth capping.
- COTS adults: survival depends on baseline, food scarcity, and high-SST mortality.
- Reproduction: adults produce larvae modulated by prey (adult condition), larval thermal performance, Allee effect, and positive SST anomaly pulses; density dependence via Ricker term; exogenous immigration.
- Observations: lognormal for adults; logit-normal for coral fractions.

Fit and residuals:
- The residuals file was not found in the provided files. Please supply it to refine diagnostics and assess timing/magnitude discrepancies quantitatively.
- Based on structure alone, the model can yield boom-bust dynamics, but the direct larvae-to-adult transition likely advances adult outbreak timing relative to observations (COTS typically mature in ~2–3 years).

Alignment with project context:
- Strengths: incorporates key non-linearities and environmental drivers needed for episodic outbreaks.
- Limitation: lacks a juvenile/subadult stage, which is critical for realistic lags between recruitment pulses and adult outbreaks, and for sustaining multi-year outbreak plateaus.

Key oversimplification addressed:
- Missing juvenile stage (maturation delay). The previous formulation assumed a one-year larvae-to-adult transition governed by mu_adult. This can force outbreaks to occur too soon after favorable larval conditions, under-representing observed delays.

Chosen improvement: add a juvenile state with maturation delay
- Ecological justification: COTS reach detectable adult densities after multiple years. Introducing a juvenile pool that survives and matures over time improves timing and duration of outbreaks without requiring additional external forcings.
- Mathematical form (annual):
  - L_t = phi * C_t * Food_t * EnvLarv_t * exp(-beta * C_t) * A_gate_t * Pulse_t + k_imm * cotsimm_t
  - J_{t+1} = sJ * (1 - mJ) * J_t + L_t
  - C_{t+1} = sA_t * C_t + sJ * mJ * J_t
  - sA_t = exp(-(mA + mA_food*(1 - Food_t) + M_temp(SST_t)))
  - mJ = invlogit(logit_mu_adult): annual maturation fraction (reinterpreted)
  - sJ = invlogit(logit_sJ): annual juvenile survival (new)
- Expected effects:
  - Introduces lag (1–several years depending on sJ and mJ) between larval pulses and adult abundance peaks.
  - Allows multi-year outbreaks when strong cohorts ‘queue’ in the juvenile pool.
  - Retains existing environmental sensitivities on fecundity and adult survival; avoids data leakage.

Parameter updates
- logit_mu_adult: reinterpreted as maturation fraction from juvenile to adult (annually). No numeric change required; value ~ -1.386 implies mJ ~ 0.2/year (median ~5-year half-life), which is ecologically plausible.
- New parameters:
  - logit_sJ (initial 0.0): juvenile annual survival on logit scale (sJ ~ 0.5). Bounds [-5, 5] constrain to (0,1) after invlogit; can be narrowed after calibration.
  - log_juv_init (initial -2.302585): initial juvenile density, with broad bounds [-9.21, 2.30].

Notes for validation
- Please provide the residuals file to verify that the added delay improves outbreak timing and reduces autocorrelated residuals in adults. If nutrient/runoff data become available, consider replacing or augmenting the SST anomaly pulse for larvae with a nutrient-driven modifier.
- The change preserves the rule of not using observed time-step data in predictions.
