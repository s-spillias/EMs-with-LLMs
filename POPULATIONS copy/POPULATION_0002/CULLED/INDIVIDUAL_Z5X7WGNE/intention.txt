Assessment and rationale

1) Model fit to data
- We were asked to consult a residuals file, but it was not provided here. Without residuals, a quantitative assessment is not possible. Qualitatively, the current structure should reproduce key features: rapid increases of adults (COTS) when food is abundant and environmental conditions favor recruitment, followed by bust phases amplified by food limitation, temperature-driven adult mortality, and rubble-delayed coral recovery.
- Potential fit issues commonly seen in COTS models that this structure may still experience:
  a) Outbreak timing: relying on SST anomalies alone to drive larval pulses may misalign with years when nutrient/runoff pulses are the primary driver.
  b) Outbreak magnitude and duration: adult crashes can be too abrupt if there is insufficient “storage” in early life stages to sustain multi-year waves.
  c) Coral recovery lag: already addressed partly via rubble R_t occupying substrate, but the link to future COTS dynamics may be underspecified.

2) Coverage of the PROJECT CONTEXT
- The model already encodes: selective predation (fast vs slow coral), rubble-mediated delay in coral recovery, larval recruitment pulses (via SST anomalies), Allee effects in reproduction, juvenile stage with maturation delay, and adult mortality modulated by food and temperature.
- These mechanisms collectively target boom–bust dynamics. A key missing link for episodicity is a mechanism that can store potential outbreak pressure in the juvenile pool during/after coral collapse, then release it with a lag—this is important for both timing and duration of outbreaks.

3) Missing or oversimplified ecological processes
- Juvenile shelter/refuge in rubble: After coral loss, newly created rubble provides cryptic habitat for juveniles that feed on algae and remain undetected for years before switching to corallivory. This can elevate juvenile survival during high-rubble years and create lagged recruitment to adulthood, sustaining outbreaks beyond a single pulse. The current model tracks rubble and delays coral regrowth but does not let rubble feed back to COTS demography.
- Nutrient/river runoff pulses: The larval pulse is currently driven by SST anomaly; when nutrient pulses dominate, this proxy may be imperfect. This could be revisited if a nutrient/river index becomes available.

Chosen improvement: Rubble-mediated enhancement of juvenile survival
- Ecological reasoning: Coral mortality generates rubble that offers shelter/foraging habitat to juvenile COTS, improving their survival while adult food is scarce. This stores cohorts that can later mature, sharpening booms and extending their duration even as adult numbers temporarily decline.
- Mathematical form: Multiply juvenile survival by a saturating Hill function of rubble at time t: sJ_eff_t = clamp01( sJ * exp(-k_can * (C_t + J_t)) * (1 + A_sJ_rub * R_t^q / (K^q + R_t^q)) ). This:
  a) Keeps the original crowding/cannibalism effect via k_can.
  b) Adds a flexible, bounded rubble shelter boost with interpretable parameters.
  c) Preserves no-effect behavior if A_sJ_rub is tiny (or estimated near zero).
- Expected impact on fit: Improves timing and duration of booms by creating a lagged reservoir of juveniles in high-rubble years after heavy predation/bleaching. Helps produce multi-year waves characteristic of GBR outbreak sequences.

Parameter review and notes
- Growth and mortality rates for corals (r_fast > r_slow; m_fast ≈ m_slow) are plausible.
- Bleaching parameters (T_bleach ~29.5°C, moderate transition width) are reasonable for a smooth annual model.
- Predation rates and saturation (alpha_fast > alpha_slow; q_pred ~ e^0.693 ≈ 2) allow a Type-III-like response, supporting prey refuge at low cover.
- Reproduction and food limitation terms follow standard Ricker and saturating forms.
- Adult temperature mortality is included (mA_temp, T_mA, tau_mA) and should help bust phases in hot years.
- Juvenile stage parameters (logit_sJ, logit_mu_adult, k_can) enable delays and crowding effects; adding rubble feedback completes an important indirect pathway.

Implementation summary
- Added three parameters to control rubble shelter effect on juvenile survival:
  1) log_A_sJ_rub (amplitude on log scale; A >= 0): stronger rubble benefit when larger.
  2) log_K_sJ_rub (half-saturation for rubble cover, same units as coral cover): where the effect is half of its maximum.
  3) log_q_sJ_rub (Hill shape exponent >0): sharpness of the rubble effect.
- Modified juvenile survival:
  Old: sJ_eff = sJ * exp(-k_can * (C + J))
  New: sJ_eff_raw = sJ * exp(-k_can * (C + J)) * (1 + A_sJ_rub * sat_hill(R, K_sJ_rub, q_sJ_rub))
       sJ_eff = clamp_open01(sJ_eff_raw, eps)
- No data leakage is introduced: only previous-step predicted states (C_t, J_t, R_t) and exogenous forcings enter sJ_eff_t.

Initial values and bounds
- log_A_sJ_rub: 0.0 (A = 1.0) with bounds [-4.60517, 2.302585] ~ [0.01, 10] amplitude. If you want a more conservative start, set to -2.302585 (A ≈ 0.1).
- log_K_sJ_rub: 2.302585 (≈10% cover) with bounds [0, 4.60517] (from ~1% to 100%).
- log_q_sJ_rub: 0.0 (q=1) with bounds [0, 2.302585] (q up to ~10 for threshold-like effects).

Next steps
- Please provide the residuals file so we can verify whether this addition improves outbreak timing/magnitude and whether alternative drivers (e.g., nutrient/runoff indices) should be added as environmental modifiers of larval survival.
