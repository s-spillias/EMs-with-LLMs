Goal: Predict the coupled dynamics of nutrient (N), phytoplankton (P), and zooplankton (Z) concentrations (g C m^-3) in an ocean mixed layer using a mechanistic NPZ model that is parsimonious yet biophysically consistent.

Ecological functioning:
- Primary production: Phytoplankton growth is limited simultaneously by nutrients and light and scaled by temperature (Q10 rule). We use saturating Michaelisâ€“Menten limitation for nutrients and a saturating (Monod-style) light limitation. The product of these limitation terms multiplies a maximum growth rate.
- Grazing: Zooplankton graze on phytoplankton via a Holling type III functional response (threshold-like at low P, saturating at high P), scaled by temperature. A constant assimilation efficiency partitions ingested P into Z production vs. unassimilated material recycled to dissolved nutrients.
- Losses and recycling: Phytoplankton and zooplankton suffer linear mortalities; a fraction of these losses remineralizes back to dissolved nutrients. Zooplankton also excrete directly to nutrients. Optional quadratic self-limitation of Z represents interference/closure of grazing at high Z.
- Physical supply: Vertical mixing relaxes mixed-layer nutrients toward a deep source concentration (Newtonian relaxation).
- Mass balance: Uptake removes N; grazing transfers P to Z and N; mortality and excretion recycle to N. All flows are expressed in consistent carbon units.

Numerical choices:
- Discrete-time Euler stepping with observed time steps; predictions initialized from the first observations to avoid parameterizing initial states.
- Smooth non-negativity and small epsilons prevent division-by-zero and negative states.
- Parameter bounds are softly enforced with smooth penalties rather than hard constraints.

Observation model:
- Lognormal errors for N, P, Z with a fixed minimum standard deviation ensure numerical robustness and appropriate handling of positive-valued data.
