ASSESSMENT OF CURRENT MODEL
- Fit to data:
  • Unable to quantitatively evaluate without the residuals file (not provided). Please add it and I will compute bias, autocorrelation, and peak-timing errors for COTS and corals (on the log and logit scales as implemented).
  • From structure alone, likely misfits appear as: (i) lagged positive residuals before outbreaks (adults grow too slowly vs observed), (ii) negative residuals immediately after peaks (declines too slow), and (iii) coral cover declines potentially mis-timed relative to adult peaks.

- Alignment with PROJECT CONTEXT (boom-bust COTS outbreaks):
  • Strengths: Includes Allee effects, temperature-modulated recruitment, coral-resource-limited larval survival, immigration forcing, density-dependent adult mortality, and a flexible multi-prey functional response (Type II/III blend). These are all important to boom–bust dynamics.
  • Gaps: Lacks a maturation delay between larval recruitment and adult abundance. Empirically, juveniles can persist cryptically for 1–3+ years before emerging as coral-feeding, reproductive adults. This time delay is a key driver of episodic, pulse-like outbreaks and their propagation.
  • Environmental drivers of larval success beyond SST (e.g., nutrient pulses from floods/CHL) are absent. If available, they should modulate recruitment survival.

- Potentially missing or oversimplified processes:
  • Stage structure (juveniles vs adults): missing; currently recruits go directly to adults.
  • External nutrient pulses: not included, yet known to modulate larval survivorship dramatically.
  • Predator control on adults: not included (could be absorbed into muC but lacks variability).
  • Juvenile refuge/prey switching at low coral cover: partly captured by eta exponents but juveniles do not consume coral in reality.
  • Spatial spread dynamics: partially represented by cotsimm_dat but not explicit; acceptable given scope.

PARAMETER REVIEW
- Many parameters are “initial estimate” with broad bounds and weak penalties. Literature-based values are noted for a subset (e.g., T_opt_rec, coral growth). No flags indicate updated values requiring structural change at this time.
- Current recruitment Rec = alpha_rec * C^phi * f_Allee * f_food * f_Trec has reasonable form; however, sending Rec directly into adults compresses the real-world delay between spawning and adult emergence.
- cotsimm_dat is labeled as larval immigration; routing it to adults (previous formulation) is inconsistent with the label.

ONE MEANINGFUL ECOLOGICAL IMPROVEMENT
Chosen approach: Introduce a juvenile stage with explicit maturation delay (indirect pathway/feedback + resource limitation carried through recruitment).

Justification:
- Ecological realism: Juveniles are cryptic, primarily algivorous, and can accumulate in the benthos before a cohort transitions to coral-feeding adults. This delay produces pulse-like adult outbreaks and better captures timing and magnitude of boom–bust cycles.
- Parsimony vs benefit: Adds two interpretable parameters (mJ, muJ). No new data streams required. Improves outbreak timing without complicating the observation model.
- Consistency: cotsimm_dat is larval immigration; it now augments the juvenile pool, matching its semantics.

STRUCTURAL CHANGES IMPLEMENTED
- New state J (juveniles). Dynamics (yearly discrete time):
  • Rec_det = alpha_rec * C^(phi) * f_Allee * f_food * f_Trec
  • Rec_in = Rec_det + cotsimm (larval immigration)
  • Juveniles: J_t = J + Rec_in - mJ*J - muJ*J
  • Adults:   C_t = C + mJ*J - Mort, with Mort = (muC + gammaC*C)*C
- Coral dynamics unchanged (still driven by adult predation).
- Temperature and resource effects on recruitment unchanged; these now affect Rec_in, which fills the juvenile pool before maturing.

NEW/UPDATED PARAMETERS
- mJ (yr^-1): Juvenile maturation rate (0–1). Initial 0.4 yr^-1 ⇒ ~2.5-year average to adulthood, consistent with literature-reported juvenile periods.
- muJ (yr^-1): Juvenile mortality (0–3). Initial 0.6 yr^-1. Bounds broad to accommodate site variability; interpretable as background plus unmodeled biotic/abiotic pressures.

LIKELIHOOD AND IDENTIFIABILITY
- Observation model unchanged (adults lognormal, corals logit-normal). Juveniles are latent, but constrained by recruitment, maturation, and adult dynamics.
- Soft range penalties added for mJ and muJ, consistent with existing approach.

EXPECTED IMPACT ON FIT
- Earlier accumulation of juveniles reduces positive pre-peak residuals and enables sharper, timed adult increases when mJ*J releases a cohort.
- Post-peak declines become steeper due to adult density-dependent mortality acting on a cohort with limited immediate backfill (juveniles still maturing over time).
- Coral loss timing should better align with adult peaks.

NOTES AND NEXT STEPS
- Please provide the residuals file so I can:
  • Quantify bias across phases (pre-peak, peak, post-peak).
  • Check autocorrelation; remaining temporal correlation in residuals may warrant adding low-dimensional process noise (e.g., AR(1) on log recruitment survival) if needed.
- If nutrient proxies (river flow, CHL) are available, we can add an environmental multiplier to Rec_in to capture episodic larval survival pulses explicitly.
- If evidence emerges that feeding rates are temperature-sensitive, a modest temperature modifier on h or aF/aS can be explored, but I recommend first validating the maturation-delay improvement.
