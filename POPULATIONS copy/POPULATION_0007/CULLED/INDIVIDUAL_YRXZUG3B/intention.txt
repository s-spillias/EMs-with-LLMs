Assessment and rationale for model improvement

1) Model fit (based on available data)
- A residuals file was referenced but not included. Typical misfit without an Allee effect in broadcast spawners:
  - Underestimation of abrupt outbreak onset (positive residuals just before peaks).
  - Overestimation of recovery from troughs (negative residuals during low-density phases), because low densities rebound too easily.
  - Coral residuals can be phase-shifted relative to predation if COTS peaks are mistimed.
- The time series provided shows strong nonlinearity (e.g., COTS increases around 1989–1991 with immigration pulses). Without a low-density threshold, the model may not reproduce sudden take-offs synchronized with favorable conditions and immigration.

2) Alignment with project context
- Strengths:
  - Food limitation via H_food.
  - Temperature effects for COTS and corals (Gaussian), plus an outbreak amplifier O(T).
  - Multi-prey feeding with Type III-like functional response and preference toward fast coral.
  - Shared space limitation for corals (K_tot).
  - Exogenous larval immigration driver.
- Gap:
  - Outbreak initiation lacks a low-density mechanism. COTS are broadcast spawners with fertilization success strongly reduced at low density, implying an Allee effect. This threshold is central to episodic outbreak dynamics.

3) Potentially missing or oversimplified processes
- Missing: Low-density limitation (Allee effect) on COTS reproduction/survival (mate-finding/fertilization).
- Possible future refinements (not implemented here):
  - Temperature-dependent mortality spikes or bleaching-driven coral loss independent of predation during extreme SST.
  - Variable predation efficiencies with coral condition.
  - Stage structure or time-to-maturity delays for COTS.

4) Parameter review
- m0_C updated from literature (2.56 yr^-1, near-fixed). High baseline mortality means positive drivers must be strong and well-timed. An Allee effect complements this by preventing unrealistic rebounds from very low densities.
- Other parameters are plausible; no structural changes required aside from the Allee addition.

Chosen improvement: Allee effect on COTS positive growth
- Ecological rationale: Broadcast spawning and mate limitation lead to low fertilization success at low density; outbreaks require surpassing a density threshold in conjunction with favorable temperature, food, and immigration.
- Mathematical form (Hill function):
  A(C) = C^eta / (C^eta + A50^eta), where C is the previous-step predicted adult density.
- Implementation in process model:
  r_eff = r_C * H_food * E_C * O(T) * A(C_prev) - mC
  C_{t+1} = C_t * exp(r_eff - a_C * C_t) + I_t
- New parameters:
  - A50_C (ind m^-2): density at which the Allee multiplier is 0.5 (initial 0.1; bounds 0.01–0.5).
  - eta_Allee (dimensionless): steepness of the Allee curve (initial 4.0; bounds 1–10).
- Expected effects on residuals:
  - Improved timing of outbreak onset and persistence of low-density troughs.
  - Better alignment of coral declines with COTS peaks.

Data-leakage safeguard
- The Allee multiplier uses only previous-step predicted COTS density; no current-step observations enter prediction equations.

Additional files recommended
- Please add the residuals file you referenced and any driver script that prepares inputs for TMB, so we can validate improvements against residual patterns and ensure correct data alignment.
