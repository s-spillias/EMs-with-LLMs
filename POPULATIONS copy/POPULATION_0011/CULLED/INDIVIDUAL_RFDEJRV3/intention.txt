Goal
Simulate and infer the dynamics of an ocean mixed-layer plankton system consisting of dissolved nutrient (N), phytoplankton (P), and zooplankton (Z) using a mechanistic NPZ model suitable for forecasting from initial conditions.

Ecological functioning
- Primary production: Phytoplankton growth is limited by multiple resources and conditions. We couple (i) nutrient limitation via a saturating Monod function with (ii) a smooth threshold that captures sharply reduced growth at very low nutrient, and (iii) light limitation using a saturating response to available irradiance attenuated by self-shading from phytoplankton biomass (Beer–Lambert). Growth rates are temperature-dependent via a Q10 formulation.
- Trophic transfer: Zooplankton graze on phytoplankton following a sigmoidal (Holling type III) functional response that captures switching/low-grazing at low prey and saturation at high prey. The ingestion rate is also temperature-modified via Q10.
- Efficiencies and losses: A fixed assimilation efficiency converts grazed phytoplankton into zooplankton biomass; the remainder is immediately remineralized to dissolved nutrients. Both P and Z suffer linear (e.g., lysis/excretion) and quadratic (density-dependent/aggregation or predation) mortalities, with specified fractions remineralized to nutrients.
- Physical supply: Vertical mixing supplies nutrients from a deep reservoir and relaxes surface nutrient toward a background deep concentration.
- Feedbacks:
  - Bottom-up: N limits P; light attenuation increases with P and reduces growth.
  - Top-down: Z grazes P; Z is fueled by P via assimilation.
  - Recycling: Mortalities and unassimilated grazing return nutrients to the dissolved pool.
  - Environment: Temperature modulates biological rates; mixing links to a deep nutrient state.

Numerical and statistical choices
- Time stepping uses variable-Δt forward Euler based on observation times; initial model states equal the first observed values (no state-parameter initial conditions).
- Smooth functions and small constants prevent instability (e.g., soft thresholds, soft non-negativity).
- Observation model is lognormal with a standard deviation floor; all observations contribute to the likelihood.
- Parameter ranges are softly enforced via smooth penalties (no hard bounds) to keep estimates biologically plausible.

Intended use
- Parameter estimation and state reconstruction from time series of N, P, Z.
- Forecasting from observed initial conditions under constant or specified environmental settings (temperature, light, mixing).
