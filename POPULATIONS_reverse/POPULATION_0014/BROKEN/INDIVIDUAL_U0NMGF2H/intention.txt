# Model Improvement: Coral-Dependent COTS Reproduction

## Current Model Performance
Based on the comparison plots between modeled and historical data:

1. **COTS Population (cots_pred)**: The current model significantly underestimates population spikes, particularly around 1990-1992 and 1994-1995. The model shows a smoothed trend that misses the outbreak dynamics characteristic of COTS populations.

2. **Slow-Growing Coral (slow_pred)**: The model underestimates peaks (especially around 1990) and overestimates troughs (particularly in the 2000-2005 period). This suggests the model isn't capturing the full dynamics of coral recovery and decline.

3. **Fast-Growing Coral (fast_pred)**: Similar to slow-growing coral, the model misses extremes but to a lesser extent. The model generally smooths out the fluctuations seen in the historical data.

## Ecological Improvement
I've implemented a coral-dependent reproduction mechanism for COTS using a simplified linear relationship with a maximum cap. This represents a key ecological feedback in coral reef systems:

1. **Mechanism**: COTS reproduction is enhanced by coral abundance, with the enhancement increasing linearly with total coral cover up to a maximum value. This reflects the biological reality that:
   - COTS larvae feed on phytoplankton, which can be more abundant in waters around healthy coral reefs
   - Adult COTS need coral for nutrition to develop gonads and reproduce successfully
   - There is a maximum reproductive benefit that coral abundance can provide

2. **Implementation**: The coral effect is implemented directly in the model code with a simple linear relationship:
   ```
   coral_effect = 1.0 + 0.02 * total_coral
   coral_effect = coral_effect > 3.0 ? 3.0 : coral_effect
   ```
   This creates a relationship where:
   - At low coral cover, reproduction increases linearly with coral abundance
   - At high coral cover, the effect is capped at a maximum value (3.0)

3. **Parameter Choice**: The coefficient 0.02 represents a 2% increase in reproduction rate per unit of coral cover, which means that at 50% coral cover, COTS reproduction would be doubled. This value is based on literature suggesting significant enhancement of COTS reproduction in coral-rich environments.

## Expected Improvements
This change should better capture:

1. **COTS Outbreaks**: By making reproduction more sensitive to coral abundance, the model should better reproduce the rapid population increases seen in the historical data.

2. **Feedback Dynamics**: The model now includes a critical feedback loop where:
   - High coral cover → Enhanced COTS reproduction → COTS population increase
   - COTS population increase → Increased coral predation → Reduced coral cover
   - Reduced coral cover → Reduced COTS reproduction → COTS population decline
   - COTS population decline → Reduced coral predation → Coral recovery

3. **System Resilience**: This feedback mechanism represents an important self-regulating aspect of coral reef ecosystems that was missing in the original model.

The simplified implementation was chosen to improve numerical stability while maintaining the essential ecological relationship between coral abundance and COTS reproduction. This approach avoids potential issues with parameter estimation while still capturing the key dynamics of the system.
