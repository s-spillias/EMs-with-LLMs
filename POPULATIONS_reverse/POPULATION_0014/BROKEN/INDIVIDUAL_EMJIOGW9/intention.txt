# Model Improvement: Nutrient-Dependent COTS Reproduction

## Current Model Performance
Looking at the comparison plots between modeled and historical data:

1. **COTS Population (cots_pred)**: The current model fails to capture the sharp peaks in COTS abundance observed around 1990-1993 and 1994-1995. The modeled values show a much smoother trajectory that misses these outbreak events.

2. **Slow-Growing Coral (slow_pred)**: The model underestimates the peaks (especially around 1990) and overestimates the troughs in slow-growing coral cover. The historical data shows much more variability than the model captures.

3. **Fast-Growing Coral (fast_pred)**: Similar to slow-growing coral, the model smooths out the dynamics too much, missing important fluctuations in the historical data.

## Ecological Improvement: Nutrient-Enhanced COTS Reproduction

I've implemented a nutrient-dependent mechanism for COTS reproduction, which is a well-documented ecological process in coral reef systems. Research has shown that elevated nutrient levels (particularly nitrogen and phosphorus from terrestrial runoff) significantly enhance COTS larval development, survival, and settlement success, leading to population outbreaks.

### Ecological Justification:
1. **Nutrient-Phytoplankton-Larvae Connection**: Increased nutrients stimulate phytoplankton blooms, which provide food for COTS larvae, dramatically increasing their survival rates.

2. **Outbreak Dynamics**: COTS outbreaks often follow major rainfall or flooding events that bring nutrient-rich runoff to reef systems. This explains the sharp, episodic nature of COTS population spikes seen in the historical data.

3. **Threshold Response**: The effect is implemented as a threshold-based linear response function with a maximum cap. This creates a non-linear response where increases in nutrients above a threshold lead to enhanced COTS reproduction, but with a biologically realistic upper limit.

### Implementation:
- Added a nutrient proxy using the COTS immigration rate (cotsimm_dat), which often correlates with nutrient-rich conditions
- Implemented a threshold-based linear response function to model the effect of nutrients on COTS reproduction
- Added two new parameters:
  - `nutrient_threshold`: The threshold level at which nutrients begin to enhance COTS reproduction
  - `nutrient_effect`: The maximum multiplicative effect of nutrients on COTS reproduction rate

### Expected Improvements:
1. **Better Capture of COTS Outbreaks**: The nutrient-dependent reproduction mechanism should allow the model to reproduce the sharp peaks in COTS abundance seen in the historical data.

2. **Improved Coral Cover Dynamics**: By more accurately modeling COTS population dynamics, the model should better capture the subsequent impacts on both slow and fast-growing coral cover.

3. **More Realistic System Feedback**: This mechanism represents an important indirect pathway in the system (nutrients → COTS reproduction → coral predation) that was missing in the original model.

This improvement adds ecological realism without excessive complexity, focusing on a well-documented mechanism that is likely responsible for the outbreak dynamics observed in the historical data. The threshold-based linear response function with a cap is both numerically stable and ecologically justified, as it represents a common form of biological response to resource availability.
