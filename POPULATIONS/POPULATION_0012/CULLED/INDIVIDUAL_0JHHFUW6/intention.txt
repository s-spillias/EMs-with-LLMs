MODEL ASSESSMENT AND IMPROVEMENT PLAN

=== CURRENT MODEL EVALUATION ===

Strengths:
1. Comprehensive temperature and nutrient-mediated recruitment mechanisms
2. Age-structured mortality with maturity tracking
3. Multiple density-dependent processes (Allee, crowding, food limitation)
4. Realistic coral predation with Type II functional responses
5. Competitive coral dynamics with dynamic carrying capacities

Critical Gap Identified:
The model lacks LOCAL REPRODUCTION - a fundamental driver of COTS outbreak dynamics. Currently, recruitment only comes from external larval immigration (cotsimm_dat), missing the positive feedback loop where outbreak populations produce massive numbers of larvae that recruit locally.

Ecological Evidence:
- Adult COTS produce 12-24 million eggs per spawning season (Pratchett et al. 2014)
- Fertilization success is density-dependent: requires minimum density for successful spawning, but saturates at high densities due to polyspermy
- Local larval production during outbreaks can overwhelm immigration signals
- The boom phase of outbreaks is driven by exponential growth from local reproduction, not just immigration

Current Parameter Values Supporting This Change:
- log_cots_recruit_base = -1.0 (recruit_base ≈ 0.37) appears to be compensating for missing local reproduction by inflating immigration effects
- Maturity tracking (maturity_pred) is already implemented but not connected to reproductive output
- log_conversion_eff = -1.5 (≈0.22) is high, possibly compensating for missing reproduction-driven growth

=== PROPOSED IMPROVEMENT ===

Add explicit local reproduction with density-dependent fecundity:

1. FECUNDITY PARAMETER (new):
   - log_fecundity_max: Maximum per capita egg production rate (eggs/individual/year)
   - Ecological basis: Adult COTS produce millions of eggs; this scales to recruitment rate

2. FERTILIZATION EFFICIENCY (new):
   - Unimodal density dependence using a Ricker-type function
   - Low efficiency at low density (Allee effect - hard to find mates)
   - Optimal efficiency at intermediate density (successful spawning aggregations)
   - Reduced efficiency at very high density (polyspermy, sperm limitation)
   - Parameters: log_fertilization_optimal (optimal density), log_fertilization_width (sensitivity)

3. LARVAL SURVIVAL TO SETTLEMENT (new):
   - log_larval_settlement_rate: Proportion of fertilized eggs that survive to settlement
   - Ecological basis: High larval mortality (typically 10^-6 to 10^-4 survival)

4. MODIFIED RECRUITMENT EQUATION:
   - Total recruitment = Immigration recruitment + Local reproduction recruitment
   - Immigration: existing mechanism (immigration × temperature × nutrient effects)
   - Local reproduction: fecundity × maturity × fertilization efficiency × settlement rate × environmental effects
   - Both pathways affected by temperature and nutrient conditions

Mathematical Implementation:
- Fertilization efficiency: exp(-((log(density) - log(optimal_density))^2) / (2 * width^2))
  This creates a bell-shaped curve in log-density space
- Local recruitment: fecundity_max × cots_prev × maturity_prev × fertilization_eff × settlement_rate × temp_response × larval_survival
- Immigration recruitment: unchanged (existing Equations 1-3)

Expected Outcomes:
1. Positive feedback loop enabling explosive outbreak growth
2. More realistic boom-bust dynamics driven by internal population processes
3. Better separation of outbreak initiation (immigration + favorable conditions) vs outbreak amplification (local reproduction)
4. Improved model fit during rapid population increase phases
5. More biologically realistic parameter values for recruitment and conversion efficiency

This improvement maintains all existing mechanisms while adding the critical reproductive feedback that drives COTS outbreak dynamics in nature.
