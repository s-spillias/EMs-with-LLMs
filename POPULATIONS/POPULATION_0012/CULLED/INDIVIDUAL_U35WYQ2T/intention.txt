ASSESSMENT OF CURRENT MODEL:

The model captures many important COTS-coral dynamics including age-structured mortality, 
temperature-dependent recruitment, bloom-mediated larval survival, and Type II functional 
responses for predation. However, it has a critical limitation for modeling boom-bust outbreak 
cycles: recruitment is driven entirely by external larval immigration with no contribution from 
local adult reproduction.

KEY MISSING MECHANISM:

Real COTS outbreaks exhibit self-sustaining population explosions because well-fed adults 
produce enormous numbers of eggs (10-60 million per female annually). When coral is abundant, 
high fecundity drives exponential population growth. As the outbreak depletes coral, fecundity 
collapses, reproduction fails, and the population crashes. This food-dependent reproduction 
feedback is THE central mechanism for boom-bust dynamics.

Current model: Recruitment = f(immigration, temperature, blooms)
Missing: Recruitment = f(immigration, temperature, blooms) + f(local adults, coral food, density)

ECOLOGICAL IMPROVEMENT IMPLEMENTED:

Added food-dependent local reproduction with four new parameters:

1. log_fecundity_base: Baseline egg production per adult COTS (eggs/individual/year)
   - Literature: Female COTS produce 10-60 million eggs annually
   - Log-transformed because fecundity spans orders of magnitude
   - This is the intrinsic reproductive potential

2. log_food_fecundity_effect: Sensitivity of fecundity to coral food availability
   - Well-fed adults produce more viable gametes with higher fertilization success
   - Poorly-fed adults have reduced egg quality and quantity
   - Creates the critical feedback: coral depletion → fecundity collapse → population crash

3. log_fertilization_rate: Density-dependent fertilization success coefficient
   - COTS are broadcast spawners requiring sufficient adult density for fertilization
   - Too few adults = gamete dilution = fertilization failure
   - Works synergistically with Allee effects on survival

4. local_retention_fraction: Proportion of locally-produced larvae recruiting locally
   - Not all larvae disperse away; some fraction settles on natal reef
   - Allows local reproduction to drive outbreak dynamics
   - Bounded 0-1 (proportion)

MATHEMATICAL IMPLEMENTATION:

New Equation (inserted after Equation 3, before recruitment calculation):

Food-dependent fecundity modifier:
  fecundity_modifier = total_coral / (total_coral + food_half_sat)
  
  Where food_half_sat is derived from food_fecundity_effect to create a saturating
  response (high coral → fecundity approaches maximum; low coral → fecundity approaches zero)

Density-dependent fertilization:
  fertilization_success = (fertilization_rate * cots_prev) / (1 + fertilization_rate * cots_prev)
  
  Michaelis-Menten form: at low density, fertilization is limiting; at high density, 
  fertilization saturates near 100%

Local larval production:
  local_larvae = fecundity_base * cots_prev * fecundity_modifier * fertilization_success * 
                 larval_survival * local_retention_fraction
  
  This is the number of locally-produced larvae that successfully recruit

Total recruitment (modified Equation 4):
  recruitment = immigration_recruitment + local_larvae
  
  Where immigration_recruitment is the existing term:
    cots_recruit_base * cotsimm_dat * temp_response * larval_survival

ECOLOGICAL JUSTIFICATION:

This modification directly addresses the PROJECT CONTEXT requirement to "accurately capture 
the timing, magnitude, and duration of population explosions" and "mechanisms that trigger 
and sustain outbreak events."

Outbreak triggering: When coral is abundant (post-disturbance recovery), high food availability 
+ sufficient adult density + favorable environmental conditions → explosive local reproduction

Outbreak sustaining: Positive feedback loop where growing population has more reproductive 
adults, sustaining high recruitment even as immigration varies

Outbreak termination: As coral is depleted, fecundity modifier drops toward zero, local 
reproduction collapses, and only immigration-driven recruitment remains (which alone cannot 
sustain outbreak densities)

This creates the characteristic boom-bust pattern:
1. Initial phase: Immigration + favorable conditions establish population
2. Boom phase: Local reproduction kicks in, exponential growth, coral depletion accelerates
3. Peak phase: Maximum COTS density, rapid coral consumption
4. Bust phase: Coral depletion → fecundity collapse → recruitment failure → population crash
5. Recovery phase: Low COTS density allows coral recovery, setting stage for next outbreak

PARAMETER BOUNDS RATIONALE:

log_fecundity_base: 14.0 to 18.0 (corresponds to ~1.2M to 65M eggs/individual/year)
  - Literature reports 10-60 million eggs per female
  - Males also contribute gametes
  - Log scale appropriate for values spanning orders of magnitude

log_food_fecundity_effect: -2.0 to 2.0 (controls steepness of food-fecundity relationship)
  - Negative values = weak food dependence (fecundity relatively constant)
  - Positive values = strong food dependence (fecundity highly sensitive to coral)
  - Zero = moderate sensitivity

log_fertilization_rate: -3.0 to 1.0 (controls density needed for fertilization success)
  - Higher values = fertilization succeeds at lower densities
  - Lower values = requires high density for successful fertilization
  - Interacts with Allee threshold parameter

local_retention_fraction: 0.0 to 0.5 (proportion of larvae retained)
  - 0.0 = all larvae disperse (no local recruitment)
  - 0.5 = half of larvae settle locally (upper bound, most larvae disperse)
  - Literature suggests most larvae disperse, but some local retention occurs
  - This is a key parameter for outbreak dynamics

EXPECTED MODEL BEHAVIOR:

With these additions, the model should now exhibit:
- Self-sustaining outbreaks when coral > threshold and adults > Allee threshold
- Outbreak collapse driven by coral depletion (not just external mortality)
- Realistic boom-bust periodicity linked to coral recovery time
- Stronger outbreaks on reefs with higher coral cover
- Failed outbreaks when coral is insufficient to support reproduction
- Spatial variation in outbreak intensity based on local coral availability

This represents a fundamental improvement in capturing the ecological reality of COTS 
outbreak dynamics on the Great Barrier Reef.
