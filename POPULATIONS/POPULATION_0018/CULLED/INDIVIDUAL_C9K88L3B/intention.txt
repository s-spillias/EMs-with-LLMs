ASSESSMENT OF CURRENT MODEL:
=============================

The current NPZ model captures basic plankton dynamics with nutrient limitation, grazing, and recycling. However, it oversimplifies phytoplankton growth by considering only nutrient limitation.

KEY MISSING PROCESS:
In oceanic mixed layers, phytoplankton growth is co-limited by both nutrients AND light availability. The current model assumes unlimited light, which is unrealistic for several reasons:

1. Light attenuates exponentially with depth in the water column
2. Phytoplankton biomass itself absorbs light, creating self-shading
3. Self-shading provides a critical negative feedback that prevents unrealistic bloom magnitudes
4. The interaction between nutrient and light limitation creates more realistic temporal dynamics

PROPOSED ECOLOGICAL IMPROVEMENT:
=================================

Add light limitation with self-shading to phytoplankton growth using a multiplicative model:

Growth = r_max * f(N) * f(I)

where:
- f(N) = N/(K_N + N) [existing nutrient limitation]
- f(I) = light limitation factor accounting for self-shading

Light limitation will be modeled as:
f(I) = I_avg / (I_avg + K_I)

where I_avg is the average light in the mixed layer, calculated as:
I_avg = I_0 * (1 - exp(-k_w * H - k_c * P * H)) / (k_w * H + k_c * P * H)

Parameters:
- I_0: surface light intensity (μmol photons m^-2 s^-1)
- k_w: background water attenuation coefficient (m^-1)
- k_c: phytoplankton self-shading coefficient (m^2 (g C)^-1)
- H: mixed layer depth (m)
- K_I: half-saturation constant for light (μmol photons m^-2 s^-1)

ECOLOGICAL JUSTIFICATION:
=========================

1. REALISM: Oceanic primary production is fundamentally controlled by both nutrient and light availability
2. SELF-REGULATION: Self-shading creates density-dependent growth limitation, preventing unrealistic blooms
3. DEPTH INTEGRATION: Accounts for the fact that phytoplankton in mixed layers experience varying light levels
4. ESTABLISHED THEORY: This formulation is well-supported in biological oceanography literature

MATHEMATICAL FORM:
==================

The light-limited growth rate becomes:
nutrient_uptake = r_max * (N/(K_N + N)) * (I_avg/(I_avg + K_I)) * P

This maintains the existing structure while adding a biologically essential process.

EXPECTED IMPROVEMENTS:
======================

1. More realistic bloom dynamics with self-limiting growth
2. Better representation of deep vs. shallow mixed layer scenarios
3. Improved seasonal dynamics if light varies
4. More accurate nutrient-phytoplankton coupling
