Assessment and rationale for model improvements

1) Fit to data and residuals
- Quantitative assessment: The residuals file was not provided in this context, so I cannot compute or summarize misfit numerically. Please supply the residuals to validate these diagnoses.
- Structural expectation: Given the current (original) formulation recruited adults were added in the same year as spawning/immigration, adult peaks are expected to occur too early and be too sharp relative to observations. Typical COTS datasets show a 1–3 year lag between high larval supply and visible adult outbreaks due to a cryptic juvenile stage. This often manifests as: (a) positive residuals in the years after strong larval pulses (model under-predicts delayed peaks), and/or (b) negative residuals immediately after pulses (model over-predicts immediate adult responses).

2) Alignment with the PROJECT CONTEXT
- The model already represents selective predation on two coral groups, temperature effects on coral growth and COTS reproduction, bleaching stresses, a Type-III prey limitation for settlement, and an Allee effect.
- However, a key ecological driver of boom-bust timing—the multi-year juvenile (cryptic) stage of COTS—is missing. Without it, outbreak timing and duration can be unrealistic, failing to capture the characteristic cohort-driven booms followed by busts.

3) Missing or oversimplified ecological processes
- Juvenile stage and maturation delay: COTS typically spend 1–3 years as juveniles feeding on algal resources before switching to corals as adults. This delay is central to outbreak timing.
- Density regulation at settlement: Already represented via prey-dependent K_eff; retaining this is reasonable. More detailed regulation involving juvenile density could be explored later if needed.
- Environmental modifiers: Temperature effects on reproduction and coral growth/bleaching are included; juvenile survival modifiers could be added later if warranted by data.

Chosen improvement: Introduce a juvenile (pre-adult) stage with maturation into adults
- Approach category: Indirect pathway and feedback mechanism via stage structure (adds a cohort delay); also refines resource limitation by placing density regulation at settlement into the juvenile pool.
- Implementation:
  a) Add a juvenile state vector J_t (juv_pred) and route all settlers (from local reproduction and immigration) into J_t rather than directly into adults.
  b) Adults at year t are updated by adult survival plus the matured fraction of last year’s juveniles.
  c) Juveniles survive with baseline survival s_juv and a fraction phi_mature matures each year.
  d) Density regulation at settlement is retained via a Beverton–Ricker multiplier linked to prey-dependent K_eff.
- Equations (discrete annual time step; computed using only t-1 inputs to avoid leakage):
  settlers_{t-1} = [r0_recruit * A_{t-1} * temp_repro_{t-1} * prey_lim_{t-1} + alpha_imm * cotsimm_{t-1} * prey_lim_{t-1}] * Allee(A_{t-1}) * exp(-A_{t-1}/K_eff_{t-1})
  J_t = (1 - phi_mature) * s_juv * J_{t-1} + settlers_{t-1}
  A_t = s_adult(A_{t-1}) * A_{t-1} + phi_mature * s_juv * J_{t-1}
  Coral dynamics remain unchanged.
- Expected impacts:
  - Delayed and more coherent adult peaks (cohort effect), improving alignment of peak timing and width with observed outbreak waves.
  - More realistic boom-bust cycles as strong settlement years propagate into adult outbreaks after a lag instead of instantly.
  - Reduced tendency for premature adult spikes following immigration pulses.

Parameter review and updates
- r0_recruit: Reinterpreted as the per-adult contribution to settled juveniles (juvenile pool) rather than immediate adults. Units remain indiv indiv^-1 year^-1; description updated accordingly.
- New parameters added:
  - s_juv (0.2–0.95): Annual juvenile survival; literature and expert knowledge suggest notable but sub-unity survival during the cryptic stage.
  - phi_mature (0.2–0.7): Annual maturation fraction; implies typical juvenile duration of ~1–4 years (1/phi_mature), consistent with observations.
  - log_J0: Initial log juvenile density at t=0, estimated to provide a flexible initial condition without data leakage.
- Existing literature-updated parameter Topt_coral (29 °C, upper bound 30 °C) remains compatible with the current growth/bleaching structure; no structural change needed there.

Assumptions and safeguards
- No current-step observations are used in process updates; all forcing and state variables are from t-1.
- Survival and maturation fractions are clamped to [0,1] for numerical stability.
- Juvenile state is reported for diagnostics but not observed, leaving the likelihood unchanged.

Next steps
- Please provide the residuals file to verify whether lagged adult peaks and outbreak duration mismatches are indeed the dominant misfit. If residuals instead point to different issues (e.g., biased coral decline or recovery rates), we can target those processes next (e.g., feeding functional response shapes, bleaching-coral interactions, or nutrient-modulated settlement efficiency).
