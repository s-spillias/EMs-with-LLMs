Assessment and rationale for model update

Data fit evaluation
- A residuals file was referenced but is not present in this context, so a quantitative residual analysis cannot be performed here. Please provide the residuals to enable a full diagnostic (e.g., timing errors, bias, variance structure, autocorrelation).
- Conceptually, the current structure should capture broad trends: COTS growth increases with prey intake (fast and slow corals), modulated by temperature (Gaussian around Topt) and an Allee effect, with logistic density regulation tied to coral-derived carrying capacity. Coral dynamics include predation via a multi-prey Holling disk equation with a flexible Type II/III exponent and heat-stress induced mortality and growth suppression.

Project context alignment
- Strengths: The model includes selective predation on fast (Acropora) vs slow corals, saturating intake, Type III response capability (q > 1), temperature effects on COTS reproduction, Allee effects, and immigration. These components are all relevant to boom-bust behavior.
- Gaps: A key ecological mechanism behind episodic outbreaks is recruitment pulses after favorable larval conditions, typically expressed with a 1–2 year delay to detectable juvenile/adult densities. The current model’s reproduction term is effectively instantaneous, which tends to blur outbreak timing and sustainment. Outbreaks may be under-triggered or mistimed without an explicit maturation delay.

Potentially missing or oversimplified processes
- Stage structure and maturation delay (larval → juvenile → adult) is absent. This is often important for generating realistic outbreak timing and amplitude.
- External nutrient/flood-driven larval survival is often critical but not available as a data input here; cotsimm_dat acts as an exogenous driver but cannot fully replace the endogenous delayed-recruitment signal.
- Updated-from-literature bounds exist for some parameters (e.g., T_bleach, mC_base) but were not reflected in the model’s soft penalties, risking biologically implausible fits.

Review of parameter values and implications
- T_bleach has updated-from-literature value/bounds (value ~31.25, bounds 29.0–34.5). The code penalized 24–32, which is inconsistent. Penalty bounds should be aligned upward to reflect modern bleaching thresholds.
- mC_base has updated-from-literature bounds 0.0013–2.56 yr^-1. The code penalized 0–5; this is overly permissive and inconsistent with evidence. Tightening penalties prevents unrealistic turnover rates that can distort boom-bust dynamics.
- Other parameters generally have plausible bounds and serve well as priors/soft constraints.

Chosen ecological improvement: delayed recruitment in COTS dynamics
- Motivation: Outbreaks are episodic and often follow favorable larval conditions by ~1–2 years. A maturation delay helps create sharp increases and subsequent declines, improving timing and amplitude of booms and busts without requiring exogenous pulses alone.
- Mathematical form:
  - Define a reproduction driver at time t: R_t = epsilon_food * I_sat_t * T_perf_t * Allee_t, where:
    - I_sat_t is the saturating intake index derived from multi-prey functional response,
    - T_perf_t is the Gaussian thermal performance around Topt,
    - Allee_t captures mate-limitation at low densities.
  - Use a lag-mixed per-capita growth: rC_t = rC_max * [(1 - lag_weight) * R_{t-1} + lag_weight * R_{t-2}],
    with lag_weight in [0, 1]. Early time steps handle edges by reusing available lags (no data leakage).
  - This introduces a single new parameter lag_weight to be estimated. When lag_weight ~ 0, the model reverts toward a 1-year lag; when ~1, a 2-year lag dominates, allowing data-driven selection of delay.
- Expected benefits:
  - Improved timing of outbreak onset (sharper pulses),
  - More realistic boom-bust cycles via endogenous delay dynamics,
  - Minimal added complexity (one parameter), high ecological plausibility.

Other structural considerations deferred
- Stage-structured population with explicit juvenile/adult classes could further improve realism but adds considerable complexity and identifiability challenges. The weighted-lag approach is a parsimonious compromise.
- Nutrient/river discharge modifiers for larval survival are ecologically sound but require data not presently available in this interface.

Implementation notes
- No data leakage: predictions at time t use only predicted states from previous time steps and exogenous SST_t; observed response variables are not used in prediction recursions.
- Parameter penalty alignment: T_bleach and mC_base penalty ranges in the code are updated to match parameters.json’s updated-from-literature bounds.

Please provide the residuals file when available for a full diagnostic pass (e.g., whether remaining misfit indicates additional process error, observation model refinements, or further structure like stochastic pulses).
