Goal: Predict the episodic boom–bust outbreaks of Crown-of-Thorns starfish (COTS) on the Great Barrier Reef and their selective predation impacts on coral communities (fast-growing Acropora vs. slow-growing Faviidae/Porites). The model uses mechanistic trophic coupling and environmental forcing to capture the timing, magnitude, and duration of outbreaks.

Core ecological functioning:
- Top-down control: Adult COTS graze corals with a multi-prey Holling type II functional response, with stronger preference for fast-growing Acropora. Grazing pressure reduces coral cover and indirectly limits future COTS survival/recruitment via prey limitation.
- Bottom-up and outbreak triggers: COTS recruitment is fueled by (i) exogenous larval immigration pulses (cotsimm_dat) and (ii) local adult fecundity modulated by temperature and prey (coral) availability. A smooth Allee-like effect raises the probability of recruitment success once adult densities exceed a soft threshold, helping produce rapid takeoffs (outbreak onsets).
- Resource limitation and density regulation: Multiple saturating processes limit rates: (a) prey-limited COTS survival and fecundity via a saturating prey index, (b) a prey-dependent carrying capacity for COTS that induces outbreak collapses as prey are depleted, and (c) logistic, space-limited coral growth constrained by total cover.
- Environmental modulation: Temperature (sst_dat) modifies (a) COTS reproductive success (Gaussian thermal performance) and (b) coral growth (Gaussian) and bleaching mortality (smooth logistic threshold), with fast-growing corals more bleaching-sensitive.
- Feedback loops: COTS reduce coral cover; reduced coral lowers COTS survival/recruitment and carrying capacity, producing characteristic boom–bust cycles; coral recovery is faster for Acropora but checked by selective COTS predation during booms.
- Numerical robustness: Smooth saturations and thresholds prevent discontinuities; small constants avoid divisions by zero; parameter ranges are softly penalized (not hard-clamped). Observations enter the likelihood with lognormal errors and minimum standard deviations; the first observations initialize the state predictions to avoid data leakage.

Outputs: Time series predictions for adult COTS density (cots_pred) and coral cover (%) for fast-growing (fast_pred) and slow-growing (slow_pred) corals aligned to the input Year vector. These can be used for forecasting and scenario analysis under varying temperature and larval immigration forcing.
