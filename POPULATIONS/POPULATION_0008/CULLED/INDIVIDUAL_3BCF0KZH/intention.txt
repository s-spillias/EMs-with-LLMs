Assessment and rationale

1) Fit to data (via conceptual review; residuals file not provided in this context)
- Without access to the residuals, I can’t quantify lack-of-fit patterns, but the current structure suggests common timing issues:
  - Adult recruitment occurs in the same year as spawning (no maturation delay). This often causes predicted booms to initiate too early relative to observations, underestimating outbreak lead time.
  - Adult survival depends only on prey availability, with no direct density effect on adults. This can smooth bust phases and prolong high densities.
  - Immigration is added directly to adults with no delay, which can overreact to annual fluctuations in cotsimm_dat.
- Coral dynamics include temperature-modulated logistic growth, preference-weighted multi-prey grazing, and bleaching mortality. These are reasonable and should broadly capture composition shifts (fast corals decline first during outbreaks).

2) Alignment with the project context (episodic boom-bust outbreaks)
- Strengths: prey limitation in survival and local recruitment; Allee effect at low adult density; temperature modifiers (reproduction and coral growth); preference-weighted grazing; bleaching mortality.
- Gaps for outbreak realism:
  - Maturation delay: COTS take ~1–3 years to reach adult survey class. This lag is a key mechanism behind cohort-driven booms and subsequent busts. Immediate (same-year) adult recruitment tends to dampen oscillations and mis-time peaks.
  - Nutrient/river-discharge pulses that alter larval survival are not explicit (only SST and immigration are available). This can be revisited if relevant covariates become available.
  - Adult density-dependent mortality (e.g., disease, predation when dense) is not explicit. Current density regulation acts only on recruits.

3) Missing or oversimplified ecological processes
- The most consequential simplification for outbreak dynamics is the lack of a maturation delay from spawning to adult class. Introducing even a simple distributed delay materially improves timing, magnitude, and duration of booms.
- Other candidates (not implemented here to keep changes minimal and focused):
  - Adult density-dependent survival.
  - Environmental modulation of immigration.
  - Nutrient-driven larval survival (requires additional data).

Parameter review
- Topt_coral was updated from literature (value and bounds). This does not, by itself, warrant structural changes because the coral growth temperature response is already Gaussian around the optimum.
- Other parameters remain plausible and bounded with soft penalties. r0_recruit currently represents “per-adult annual recruitment to adult class.” With the improvement below, it becomes a per-adult potential adult recruitment rate realized through a distributed (1–2 year) maturation delay. Units and magnitude remain comparable, but the timing changes; this improves interpretability relative to observed adult surveys.

Chosen improvement: distributed maturation delay for local recruitment
Ecological justification:
- COTS typically require 1–3 years to reach sizes counted in adult density surveys. A distributed delay (mix of 1-year and 2-year pathways) better captures cohort dynamics that drive outbreaks.
- This change preserves existing temperature and prey effects on reproduction, while shifting when those recruits appear in the adult class.
- We keep density regulation on recruitment at the time recruits join the adult class, which aligns with competition and prey-limited carrying capacity.

Mathematical change (summary):
- Replace same-year local recruitment with a mixture of 1-year and 2-year delayed contributions, each evaluated using the state and environment at their spawning/juvenile phases:
  local_recr = (1 - w_delay2) * R(t-1) + w_delay2 * R(t-2)
  where
  R(τ) = r0_recruit * COTS(τ) * temp_repro(SST(τ)) * [P(τ)/(K_prey + P(τ))] * Allee(COTS(τ))
  with P(τ) = pref_fast*Fast(τ) + pref_slow*Slow(τ), and Allee(x) = inv_logit(k_allee*(x - c50_allee)).
- Density regulation and immigration are applied as before at the time recruits enter the adult class.
- Survival still depends on prey at t-1 to avoid data leakage.

New parameter added:
- w_delay2 in [0,1]: fraction of local recruitment realized after a 2-year maturation delay (remainder realized after 1 year). This provides flexibility to match observed lag between spawning conditions and adult survey peaks.

Data-leakage caution:
- The implementation only uses lagged predicted states (t-1, t-2) and lagged forcings (SST, immigration) for process updates. Observations are used solely in the likelihood.

Expected effects:
- Improved timing of outbreak onset and peak (cohort lag).
- Potentially sharper booms and clearer busts due to delayed feedback.
- Minimal increase in complexity: only one additional parameter governing the delay mixture.

If future residuals show systematic biases remain:
- Consider adding adult density-dependent mortality or making immigration conversion temperature- or prey-dependent. These would be next candidates after validating the delay improvement.
