Assessment of current model and fit:
- Data fit: A residuals file was referenced but not provided here. Based on typical issues in COTS outbreak modeling, misfits often include (a) underestimation of outbreak peaks, (b) peaks occurring one year early/late (phase errors), and (c) overly slow declines after peaks (positive residual autocorrelation during bust). The current structure likely captures the general boom via food- and temperature-modulated recruitment with an Allee effect, but may underperform on the speed of the post-peak collapse.
- Project context alignment: The model includes key mechanisms for boom-bust dynamics: (1) multi-prey functional response and handling saturation (selective predation on coral), (2) temperature-modulated recruitment via a Gaussian performance curve, (3) Allee effect for low-density limitation, (4) carrying capacity that increases with coral cover, and (5) external immigration. These address outbreak timing and magnitude drivers but may lack a mechanism that accelerates busts when food becomes scarce after coral depletion.
- Missing or oversimplified processes:
  1) Starvation-driven mortality after outbreaks: Mortality is currently a fixed mC_base, independent of food availability. Empirically, rapid declines post-outbreak are associated with prey depletion and increased mortality. Without food-dependent mortality, collapses can be too gradual.
  2) Thermal bounds for reproduction (Topt) were updated in parameters.json (28–30 °C), but the penalty bounds in the model were wider, risking unrealistic thermal optima during estimation.

Chosen single ecological improvement:
- Approach: Environmental modifier/resource limitation — add food-dependent mortality for COTS that increases as per-capita intake declines.
- Justification: As outbreaks deplete preferred fast-growing corals, per-capita intake (I_sat) drops. Elevated starvation and predation vulnerability then increase mortality, producing rapid busts characteristic of COTS dynamics. This is a minimal-complexity addition consistent with ecological understanding and avoids using current observations (uses only predicted states from t-1 and forcings at t).

Mathematical change:
- Define I_sat_t = (per_pred_F + per_pred_S) / (K_food + per_pred_F + per_pred_S + eps).
- Replace constant mortality with food-modulated mortality:
  mC_eff(t) = mC_base + mC_food * (1 - I_sat_t), constrained to be non-negative.
- Population update becomes:
  C_t = C_{t-1} + rC*C_{t-1}*(1 - C_{t-1}/Kc) - mC_eff(t)*C_{t-1} + gamma_imm * immigration_t.
- This preserves existing boom mechanisms while sharpening busts when food becomes limiting.

Parameter updates and bounds:
- New parameter mC_food (year^-1): scales the additional mortality when food is scarce. Bounds 0.0–3.0 year^-1 reflect plausible annual mortality increases without allowing unrealistically extreme values. Initial value: 0.8.
- Align Topt bounds in model penalties to the updated literature-informed range 28–30 °C already in parameters.json, preventing unrealistic thermal optima during estimation.

Notes on data usage:
- The modification uses only lagged predicted states (F_state, S_state, C_prev) and current exogenous drivers (SST_t, immigration) in calculations, avoiding data leakage from current observations.

Expected effects on fit:
- Faster post-peak declines (reduced positive residual autocorrelation after peaks).
- Improved timing of returns to low density due to stronger bust dynamics.
- Little impact on outbreak initiation timing/magnitude beyond interacting with food availability; rC_max and epsilon_food still govern the boom.

Files changed:
- model.cpp: Implemented mC_eff = mC_base + mC_food*(1 - I_sat_curr), applied in the COTS update; aligned Topt penalty bounds (28–30 °C).
- parameters.json: Added mC_food parameter with description and bounds.
