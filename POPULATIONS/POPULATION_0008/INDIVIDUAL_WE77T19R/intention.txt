Assessment and rationale for model improvement

1) Model fit to data
- Residuals: A residuals file was not provided in this chat, so I could not quantitatively assess fit. Please share it to refine the evaluation. In the meantime, based on the model structure and typical performance of similar COTS models, I would look for:
  - Timing mismatches: predicted outbreaks peaking too early relative to observations (a common issue when recruitment responds immediately to conditions without a maturation delay).
  - Amplitude errors: under/overestimation of outbreak peaks due to reproduction drivers lacking a lag or overly smooth responses.
  - Duration biases: bust phases that are either too abrupt (if prey depletion is too strong) or too slow (if mortality and density limitation do not scale sufficiently with coral state).

2) Alignment with the PROJECT CONTEXT
- Strengths:
  - Selective predation on fast vs slow corals is represented via a two-prey Holling-type response with preference/handling differences (aF/aS, hF/hS, q_func).
  - Boom-bust dynamics are enabled through: (i) prey depletion feedback (coral removal reduces Kc), (ii) temperature effects on coral growth/mortality (bleaching), (iii) logistic-type regulation for COTS tied to coral cover.
  - Immigration driver (cotsimm_dat) allows external pulses.
- Limitations relevant to episodic outbreaks:
  - Recruitment timing: Outbreaks of adult/visually detectable COTS typically lag favorable spawning/larval conditions by about 1+ years because juveniles remain cryptic and feed on non-coral resources before transitioning to coral. The current model links per-capita growth directly to same-year food and temperature, which tends to produce peaks without the characteristic lag.
  - Environmental pulses beyond SST (e.g., nutrient runoff influencing larval survival) are not explicitly modeled. With the given inputs, this can be approximated by an immigration scaler but lacks mechanistic internal timing.

3) Potentially missing/oversimplified ecological processes
- Juvenile maturation delay: A 1–3 year delay between spawning and adult abundance increases is key for reproducing outbreak timing. Currently absent.
- Nutrient/runoff pulses: Important drivers of larval survival not represented (no external driver provided here; cannot be added without new data inputs).
- Stage structure: Adults vs juveniles not explicitly tracked; the single-population state can still approximate dynamics with a lag term.

Parameter review
- T_bleach has been updated from literature (value = 31.75 °C), which is compatible with the current logistic bleaching formulation; no structural change needed.
- mC_base bounds are aligned with literature. Other parameters appear as initial estimates with plausible bounds.
- Given the importance of timing in the PROJECT CONTEXT, the most impactful structural improvement is to include a recruitment/maturation lag in the COTS growth driver, rather than modifying existing parameter values alone.

Chosen improvement: One-year recruitment/maturation lag (blended)
- Ecological basis: COTS have pelagic larvae and benthic juvenile stages feeding largely on crustose coralline algae before shifting to corals; detectable adult outbreaks typically lag favorable conditions. A one-year lag in the reproduction driver improves timing and helps generate realistic boom onset following favorable conditions.
- Mathematical implementation:
  - Introduce a new parameter lag_recruit in [0,1] that blends immediate vs lagged drivers for COTS recruitment:
    rC ∝ epsilon_food * [(1 - lag_recruit) * (I_sat_t * T_perf_t) + lag_recruit * (I_sat_{t-1} * T_perf_{t-1})] * Allee(C_{t-1})
    where I_sat is the saturating food index based on per-predator intake and T_perf is Gaussian thermal performance. This preserves the original form when lag_recruit = 0 and uses a full 1-year lag when lag_recruit = 1.
  - To avoid leakage, the lagged terms use only previous time-step states and SST.
- Expected effects:
  - Shifts outbreak peaks to occur after favorable conditions, improving alignment with observed episode timings.
  - Allows sharper pulses if environmental/food conditions fluctuate, while preserving the bust via prey depletion and mortality.
- Complexity/identifiability:
  - Adds just one parameter with clear interpretation and tight bounds [0,1], minimizing identifiability issues relative to adding full stage structure.

Notes and next steps
- Please provide the residuals file to verify the improvement specifically resolves timing residual patterns (e.g., positive residuals before peaks and negative after).
- If residuals later indicate underestimation of bust speed, consider adding coral-dependent adult mortality or disease pressure at high density; however, this was not added now to keep to a single, targeted improvement focused on timing.
