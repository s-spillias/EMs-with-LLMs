Assessment of current model and rationale for changes

1) Model fit (inferred without residuals file)
- The current adult COTS dynamics use an instantaneous logistic increment (deltaC) driven by food intake, temperature, and Allee effects. This structure often produces adult peaks too soon after favorable conditions, smoothing outbreak profiles and mistiming the characteristic boom-bust cycles. In many reef systems, observed outbreaks show a lag between environmental/reproductive pulses and the rise of survey-detectable adult densities. Without a maturation delay, predicted peaks can be phase-advanced, leading to systematic residual patterns (e.g., positive residuals pre-peak, negative residuals during peaks).

2) Alignment with project context
- Strengths: The model already incorporates (a) selective multi-prey predation on coral groups, (b) thermal performance of reproduction, (c) Allee effects, (d) carrying capacity linked to coral cover, and (e) external immigration. These are core mechanisms for COTS outbreak ecology.
- Gaps: The model lacks stage structure and the delay from larval/juvenile stages to adult survey classes. Empirically, COTS spend months to years as cryptic juveniles, feeding on algae before switching to corallivory; outbreaks are cohort-driven, with adult peaks appearing 1–3 years after favorable recruitment conditions (e.g., food pulses, thermal windows, or immigration).

3) Missing/oversimplified processes
- Maturation delay: No explicit representation of larval/juvenile development time causes immediate adult response to reproduction.
- Juvenile ecology: Refuge and non-coral diet phases (algae) are not represented; approximating with a delay captures the dominant timing signal without extra data.
- External nutrient/runoff pulses: Not available in provided data; therefore not added.
- Predator control on juveniles: Important but would require additional structure and parameters; omitted to keep changes focused.

Selected improvement: One-year maturation delay for COTS recruitment

Ecological reasoning
- Outbreaks are typically cohort-driven; a one-year lag between reproduction and adult detectability is a parsimonious way to capture timing and duration of booms without adding many parameters.
- This delay preserves existing ecological drivers (food saturation, thermal performance, Allee effects, capacity via coral cover) but moves their effect on adults forward by one year, better reflecting life history.

Mathematical formulation
- Previously (instantaneous):
  C_next = C_prev + [rC(C_prev, F_prev, S_prev, SST_t) * C_prev * (1 - C_prev / Kc)] - mC_base*C_prev + gamma_imm*IMM_t

- Now (delayed recruitment pipeline):
  1) Reproductive output in year t (stored for next year):
     recruits_t = rC(C_prev, F_prev, S_prev, SST_t) * C_prev * (1 - C_prev / Kc)
     where rC = rC_max * epsilon_food * I_sat * T_perf * Allee_m,
           I_sat = I / (K_food + I), I = per_pred_F + per_pred_S,
           T_perf = exp(-0.5 * ((SST_t - Topt)/sigma_T)^2),
           Allee_m = C_prev / (A50 + C_prev),
           Kc = Kc0 + kCF * F_prev + kCS * S_prev.
  2) Adults updated with last year’s recruits:
     C_next = softplus(C_prev - mC_base*C_prev + gamma_imm*IMM_t + recruits_{t-1})

- Coral dynamics, predation, and bleaching remain as before and continue to use previous-year states for updates. Recruits added at year-end do not contribute to within-year coral consumption, matching ecology.

Data usage and leakage
- Only initial conditions (t=0) use observations to start states.
- At year t, predictions use states from t-1 and exogenous drivers at t (SST, immigration). No use of current-year observed response variables is introduced.

Parameter review
- No new parameters introduced. The literature-updated T_bleach is already honored via smooth penalties and does not require structural change. Current bounds remain consistent with the revised dynamics.

Expected outcomes
- Improved timing of adult peaks relative to environmental forcing.
- More realistic outbreak duration as cohorts pass through the delayed pipeline.
- Retains the ability to fit outbreak magnitude via existing rC_max, epsilon_food, K_food, Allee, and capacity linkage to coral cover.

Implementation notes
- A new internal vector recruits is reported for diagnostics.
- recruits_0 is computed using year-0 states and SST_0 and added to adults in year 1.
- The former deltaC term is removed from the adult update to avoid double-counting recruitment.
