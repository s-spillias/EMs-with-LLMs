Assessment and alignment with PROJECT CONTEXT (NPZ)

1) Model fit to data
- Quantitative assessment is pending: a residuals file was referenced but not supplied here, so I cannot compute or summarize residual diagnostics. Please provide the residuals to evaluate bias structure (level/trend), heteroskedasticity, and temporal autocorrelation for COTS, fast coral, and slow coral.
- Likelihood choices appear reasonable: lognormal for COTS abundance (positive, skewed) and normal on logit for % coral cover (bounded). A small SD floor is used for numerical stability.

2) Alignment with NPZ project context
- The current model targets a COTS–coral–temperature system, not an explicit NPZ (nutrient–phytoplankton–zooplankton) model.
- However, COTS early life stages depend on phytoplankton (food) which is driven by nutrients. Thus, an NPZ-relevant process can enter as a resource limitation on larval recruitment.

3) Potentially missing or oversimplified processes
- Relative to NPZ:
  - No explicit nutrient, phytoplankton, or zooplankton states; no resource limitation on recruitment or growth.
  - No remineralization, vertical mixing, or external nutrient inputs.
- Within the current COTS–coral framework:
  - Recruitment depends on adult stock, an Allee effect, and a Gaussian temperature modifier, but not on larval food availability (phyto).
  - Coral dynamics exclude macroalgal competition and storm/cyclone disturbances.
  - No explicit predation control on COTS (e.g., fish predators) beyond density-dependent mortality.
- Given constraints, the most impactful NPZ-aligned addition is to make COTS recruitment resource-limited by larval food.

Chosen improvement: Resource-limited recruitment via SST-driven nutrient/food proxy

Ecological rationale
- COTS larval survival is strongly food-limited by phytoplankton abundance, which is linked to nutrient supply and mixing. Cooler-than-typical SST in many reef systems corresponds to increased nutrient availability and higher phytoplankton.
- The current model already has a temperature-optimum term (physiological/phenology). Adding a separate food-limitation term distinguishes physiology from resource availability and aligns with NPZ dynamics without requiring new data streams.

Mathematical form (implemented)
- Define a nutrient/food proxy from SST at the previous time step:
  dTc = max(0, T_ref_nutr − SST_{t−1})   (cooler-than-reference => more nutrients/phyto)
  f_nutr = f_nutr_min + (1 − f_nutr_min) * dTc / (K_nutr + dTc)   (Monod saturation, bounded in [f_nutr_min, 1])
- Modify recruitment:
  Rec_{t} = alpha_rec * [C_{t−1}^phi / (1 + C_{t−1}/C_sat_rec)] * f_Allee(C_{t−1}) * f_Trec(SST_{t−1}) * f_nutr(SST_{t−1}) + cotsimm_{t−1}
- This preserves the no–data-leakage rule by only using t−1 exogenous drivers and states.

New parameters and suggested bounds
- T_ref_nutr (degC): Reference SST where cooler temperatures imply higher nutrients; bounds [20, 34]. Initial 26.0.
- K_nutr (degC): Half-saturation scale for the nutrient proxy; bounds [0.1, 10]. Initial 1.0.
- f_nutr_min (0–1): Baseline food availability under oligotrophic conditions; bounds [0.0, 0.5]. Initial 0.1.

Notes on identifiability and complexity
- The added term is parsimonious (three parameters) and targets a process known to affect COTS outbreaks. It separates physiological temperature effects (Gaussian peak) from resource limitation (Monod saturation), aiding interpretability.
- If residuals later show redundancy between f_Trec and f_nutr, we can constrain one or reparameterize to reduce confounding (e.g., fix f_nutr_min, or tie T_ref_nutr to T_opt_rec).

Next steps once residuals are available
- Examine residuals for COTS: warm-period underprediction would be consistent with missing resource limitation (now addressed). If overfitting occurs, consider simplifying by fixing f_nutr_min.
- If strong seasonal/annual structure remains, consider adding stochasticity or external nutrient indices (e.g., chlorophyll-a), or an explicit NPZ submodel if data permit.
