Assessment of current model fit and alignment with project context:
- Data fit: A quantitative evaluation against residuals is not possible here because a residuals file was not provided in this context. Structurally, the likelihood uses lognormal error for COTS and logit-normal errors for coral covers, which is appropriate. Typical misfit risks include recruitment booms/busts not captured by environmental modifiers and heatwave-driven coral losses that are too linear.
- Alignment with PROJECT CONTEXT (NPZ in the mixed layer): The present model simulates COTS–coral dynamics and does not explicitly simulate nutrient (N), phytoplankton (P), and zooplankton (Z). However, the code already hints at a bottom-up larval food limitation pathway (K_food), which offers a natural bridge to NPZ concepts. At present, f_food is neutral (set to 1), so the model lacks any explicit planktonic modulation of recruitment.
- Missing/oversimplified ecological processes:
  1) Bottom-up control of larval survival by phytoplankton availability is absent (f_food = 1).
  2) There is no indirect NPZ feedback onto the benthic system, despite larval stages depending on planktonic food.
  3) Temperature modifies recruitment and coral growth/bleaching, but there is no resource (food) co-modifier to explain recruitment variability during otherwise suitable temperatures.

Parameter review highlights:
- Many parameters are placeholders/initial estimates. Some temperature optima are literature-informed (e.g., T_opt_rec, T_opt_bleach).
- K_food exists but has been neutralized; its intended role suggests adding a driver consistent with NPZ theory.
- No changes in current observations require altering the error structure.

Chosen ecological improvement (one change):
Introduce an SST-derived phytoplankton index to drive larval food limitation of COTS recruitment (NPZ-inspired bottom-up control).

Rationale:
- Ecological: COTS larval survival depends strongly on phytoplankton concentrations. In tropical systems, phytoplankton dynamics often covary with temperature and stratification. Using an SST-derived Gaussian index is a pragmatic proxy consistent with NPZ themes while avoiding new data dependencies.
- Mathematical: Implement a Monod (saturating) resource limitation term f_food = P / (K_food + P), where P = P_max * exp(-beta_food * (SST - T_opt_food)^2). This introduces a non-linear resource limitation and an environmental modifier without risking data leakage (we use SST at t-1).
- Model–data fit expectation: This pathway should help explain recruitment spikes or failures that align with warm/cool regimes even when adult stock and Allee effects alone cannot, potentially reducing residual structure in COTS abundance during anomalous temperature years.

Structural changes implemented:
- Added three parameters to characterize the phytoplankton proxy: P_max (scale), T_opt_food (temperature optimum), beta_food (curvature).
- Computed a per-year SST-derived phytoplankton index (food_index) using SST at the previous time step and applied the Monod limiter to recruitment.
- Reported food_index for diagnostics and posterior predictive checks.
- Retained existing constraints against data leakage (only t-1 drivers used for t updates).

Parameter additions and bounds (ecological justification):
- P_max: Sets the amplitude of the phytoplankton index; broad bounds [0.01, 100] allow the data to scale the effect.
- T_opt_food: Literature-informed tropical phytoplankton growth optima centered near ~28°C; bounds [20, 34] reflect feasible mixed-layer temperatures in the system.
- beta_food: Controls temperature sensitivity; bounds [0, 2] cover from flat to sharply peaked responses.
- K_food: Upper bound raised to 1000 to avoid over-constraining half-saturation during calibration; units are the same as the phytoplankton index.

Notes and future directions:
- If residual diagnostics (when available) still show systematic patterns, consider a fuller NPZ submodel (e.g., explicit N and P with seasonal mixing and a zooplankton-like grazer) or introducing seasonal/ENSO indices to modulate P. For now, we keep complexity minimal and targeted to one improvement consistent with the project’s NPZ context.
