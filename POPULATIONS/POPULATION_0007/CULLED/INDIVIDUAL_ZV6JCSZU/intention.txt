Assessment and rationale for model refinement

1) Model fit to data
- Note: A residuals file was referenced but not provided in this context. The following assessment is based on structural properties of the current model and typical misfit patterns seen in COTS outbreak models.
- Expected fit strengths:
  - The model can generate boom–bust dynamics via (i) nonlinear stock–recruitment with Allee effect and (ii) density-dependent mortality (gammaC*C^2) alongside prey depletion through a saturating multi-prey functional response.
  - Temperature modifies recruitment and bleaching, allowing some environmental variability in both COTS and coral trajectories.
- Likely fit limitations:
  - Outbreak timing and duration are often governed by lags between larval cohorts and availability of coral prey for ontogenetic diet shift. With a constant juvenile maturation fraction (mJ), the timing of adult pulses may be too tightly linked to recruitment pulses and not sufficiently conditioned on coral availability. This can cause phase mismatches (e.g., peaks too early/late).
  - If outbreaks are sustained longer than observed, linear-in-predator consumption without predator interference, combined with constant maturation, may maintain adult numbers longer than the data suggest, unless gammaC is large.
  - Coral cover residuals often show boundary effects (near 0 or 100%), which the current model partly addresses with smooth clamping and logit observation models, but consumption at low coral cover may still be too permissive or too restrictive depending on etaF/etaS.

2) Alignment with project context
- The project emphasizes accurate timing, magnitude, and duration of episodic outbreaks and the selective predation on fast (Acropora) vs slow (Faviidae/Porites) corals.
- Current mechanisms included:
  - Selective/saturating predation with separate attack exponents and efficiencies (aF,aS,etaF,etaS,qF,qS).
  - Temperature-modified recruitment and temperature-induced coral bleaching and growth reduction.
  - Allee effect in reproduction and Beverton–Holt taper at high adult density.
- Missing linkage to context:
  - A key ecological driver of outbreak timing is the dependency of juvenile maturation into coral-feeding adults on coral availability (juveniles are cryptic and rely on algae; they transition to corallivory when coral prey are available). A constant maturation fraction (mJ) does not capture this gating of adult emergence by coral cover, which is critical for predicting when cohorts convert into outbreaking adults.

3) Missing or oversimplified processes
- Juvenile maturation dependency on coral availability: Oversimplified (constant mJ). Ecologically, maturation should increase with coral cover, introducing a lagged, resource-driven release of adults that helps match observed outbreak timing.
- Predator interference among COTS (Beddington–DeAngelis): Not represented; could limit per-capita consumption at high COTS densities, affecting bust speed. This is a secondary candidate.
- Environmental drivers of larval survival other than temperature (e.g., chlorophyll-a/runoff): Not represented; could be incorporated if data are available but are outside the current data inputs.

Parameter review
- Many parameters are flagged as initial estimates. No parameters are flagged as updated_from_literature = true, so there is no explicit trigger to rescale the existing equations solely due to updated numeric values.
- The structure using coral cover as a “resource” for larval success (K_R, wF, wS) is a pragmatic proxy in absence of chl-a/runoff drivers. Retaining this proxy, we can leverage the same or similar resource index to drive juvenile maturation.

Chosen single structural improvement
- Implement coral-dependent juvenile maturation:
  - Ecological reasoning: Juveniles remain cryptic and non-corallivorous until suitable coral prey becomes available; maturation to the observable adult stage accelerates with increasing coral cover. This mechanism introduces a biologically grounded lag that can sharpen outbreak onset and improve timing and duration of adult peaks.
  - Mathematical change:
    - Replace constant mJ with a saturating function of coral resource R = wF*F + wS*S (already used for larval success):
      mJ_eff(t-1) = mJ * [ R(t-1) / (K_mJ + R(t-1)) ]
      Mat(t) = mJ_eff(t-1) * J(t-1)
    - Add new parameter K_mJ (half-saturation % cover for maturation). mJ retains interpretation as maximum annual maturation fraction (0–1).
  - Advantages:
    - Preserves existing structure and parameters while adding one identifiable parameter with clear ecological meaning.
    - Avoids data leakage by using only t-1 states.
    - Introduces a realistic delay and coral dependence for adult emergence, improving outbreak timing and decay without overcomplicating the model.

Implementation notes
- Added K_mJ as a new parameter with weakly informative smooth penalties and reasonable bounds.
- Updated the model equations and comments accordingly.
- No other changes to observation models or state initialization were required.

Next steps if residuals become available
- Check whether adult peaks are advanced or delayed relative to observations; adjust K_mJ to tune maturity gating.
- If peaks remain too prolonged at high COTS density, consider adding predator interference (Beddington–DeAngelis term) as a future, separate improvement.
