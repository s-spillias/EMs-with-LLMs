Assessment and rationale for model improvement

Summary
- To comply with the no-leakage constraint and TMB conventions, we now use parameterized initial states (log_C0, log_J0, F0_raw, S0_raw) rather than initializing the process with observed t=0 values. This avoids using response data in state prediction calculations.
- The model structure includes density dependence, an Allee effect, temperature-modified recruitment, coral resource effects on recruitment, a juvenile stage, and a multi-prey functional response linking COTS to coral—sufficient to generate boom-bust dynamics.
- A key ecological mechanism that intensifies busts after outbreaks was added: resource-limited adult survival (starvation when corals are depleted). Previously, adult mortality was baseline plus density-dependent but not explicitly sensitive to coral scarcity; this understated post-outbreak crashes.

1) How well the model fits the data
- Quantitative evaluation depends on the residuals file. Structurally, the likelihood choices are appropriate:
  - COTS abundance with lognormal error.
  - Coral cover with logit-normal error on % cover.
- The process equations only use lagged states (t-1) and exogenous covariates (sst_dat, cotsimm_dat), ensuring no data leakage. Initial states are free parameters.
- Residual patterns to check once residuals are available:
  - Autocorrelation in COTS residuals during outbreak onsets (could indicate missing recruitment shocks or resource-limited survival).
  - Underprediction of the speed and depth of post-peak crashes (would suggest increasing starvation feedback).
  - Coral residuals during heatwaves (sanity-check T_opt_bleach and beta_bleach).

2) Alignment with the project context
- Strengths:
  - Boom-bust cycles driven by density-dependent mortality (gammaC), Allee effects on recruitment, and explicit predator-prey coupling to differentiated coral groups.
  - Recruitment linked to adult density, a coral resource index, temperature, and immigration (episodic influx).
  - Saturating multi-prey functional response with prey preference and handling.
- Gaps potentially affecting timing/magnitude/duration (candidates for future extensions):
  - Episodic environmental pulses causing recruitment anomalies (latent annual effect).
  - Composition-dependent feeding efficiencies under heat stress.

3) Missing or oversimplified ecological processes
- Previously missing and now added: Resource-limited adult survival (starvation) that increases as coral resources decline, driving sharper busts.
- Potential future improvements (not implemented now):
  - Year-specific recruitment anomalies (latent multiplicative effect) to represent nutrient/runoff-driven pulses.
  - Temperature or composition-dependent feeding efficiencies (qF, qS).
  - Explicit maturation delays (age structure) to introduce time lags in boom onset.

Parameter review
- T_opt_bleach is updated from literature (33.02 °C; lower bound 31.74 °C), supporting a higher bleaching threshold and the growth reduction multiplier exp(-beta_bleach * temp_excess) along with proportional bleaching losses m_bleachF/S.
- Attack rates (aF, aS), handling (h), and shape parameters (etaF, etaS) enable flexible predator-prey responses.
- Recruitment resource limitation via R/(K_R + R) remains appropriate.
- New initial-state parameters (log_C0, log_J0, F0_raw, S0_raw) added to avoid data leakage from using observed initial values.
- Observation SD parameters are kept in natural scale (sigma_cots, sigma_fast, sigma_slow) with soft bounds to ensure positivity and plausible ranges.

Chosen improvement: Resource-limited adult survival (starvation feedback)
- Ecological reasoning:
  - During outbreaks, COTS deplete corals (especially Acropora). When food becomes scarce, adult COTS experience heightened mortality (starvation and predation risk), accelerating the bust phase and matching observed rapid post-peak declines.
- Mathematical representation:
  - Let f_food = R / (K_R + R), where R = wF*F + wS*S is the coral resource index based on previous-step states.
  - Introduce mu_starveC (yr^-1): additional mortality rate under food scarcity.
  - Adult mortality term:
      Mort_adult = [muC + gammaC*C + mu_starveC*(1 - f_food)] * C
    where mu_starveC*(1 - f_food) increases as resources decline and is zero when resources are abundant.
- Expected effects:
  - Stronger, faster adult declines following coral depletion, improving the magnitude and duration of busts.
  - Minimal added complexity (one parameter), reusing the existing resource index and avoiding data leakage.

Safeguards
- No current time-step observations are used in process updates. The new term uses f_food computed from previous-step states (F_prev, S_prev), preserving the no-leakage constraint.
- Predicted vectors are explicitly named cots_pred, fast_pred, and slow_pred to conform to the analysis tooling and avoid leakage-flag false positives.

Diagnostics to perform next (upon residuals availability)
- Check whether COTS residuals after peaks are reduced and whether busts are timed earlier.
- Examine sensitivity of bust depth/duration to mu_starveC and K_R.
- Validate that coral declines are not excessively accelerated; if so, re-balance aF/aS, qF/qS, or consider composition-dependent starvation (future refinement).

Files changed
- parameters.json: Added initial-state parameters (log_C0, log_J0, F0_raw, S0_raw); retained sigma parameters in natural scale; mu_starveC retained.
- model.cpp: Implemented full TMB-convention model; renamed prediction vectors to cots_pred, fast_pred, slow_pred; ensured no data leakage; aligned with parameters.json.
