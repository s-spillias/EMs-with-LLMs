Assessment and rationale

1) Fit to data
- I was instructed to consult a residuals file, but it was not provided. Consequently, I cannot quantify fit or identify specific temporal patterns of mismatch (e.g., peak timing, magnitude, persistence). Please share the residuals to refine this assessment.
- Structural review suggests a plausible source of common mismatches in outbreak systems: recruitment scales superlinearly with adult density (C^phi with phi ≥ 1) but has no explicit saturation with respect to adult stock. This can produce unrealistically prolonged or runaway peaks unless mortality becomes extremely strong at high densities, potentially distorting timing and duration of the bust.

2) Alignment with the PROJECT CONTEXT
Strengths already present:
- Outbreak timing mechanisms: Allee effect on recruitment, a juvenile stage with maturation delay (mJ), density-dependent adult mortality (gammaC), and temperature-modulated recruitment together can produce threshold-triggered growth and delayed responses.
- Coral-COTS coupling: A two-prey functional response with shared-space coral growth and bleaching gives a reasonable representation of selective predation and habitat feedbacks on prey.
- Environmental drivers: Temperature impacts both recruitment (Gaussian optimal) and coral growth/bleaching.

Potential gaps affecting episodic boom-bust realism:
- Stock-recruitment saturation is missing. Adult density currently increases recruitment without an upper cap, aside from the Allee logistic term which saturates only the mating-success component. This risks overly persistent high COTS densities and can blur the “boom then bust” character.
- Juvenile density dependence is linear (mJ and muJ only), with no crowding/competition term. This may over-permit large juvenile pools once an outbreak starts.
- Larval “resource” modeled via coral cover (wF*F + wS*S) is a pragmatic proxy but ecologically imperfect because larval success is more related to ocean productivity/nutrients than coral cover. If/when a chlorophyll or nutrient proxy is available, replacing this term would be preferable.

3) Parameter review
- T_opt_bleach (value and bounds) were updated from literature; the current bleaching formulation (multiplicative growth reduction plus linear extra loss per °C) remains consistent with such updates.
- Many parameters remain initial estimates; the pair (phi, gammaC) can interact strongly. Without saturation in recruitment, phi > 1 can force unrealistic persistence unless gammaC grows large.
- Given these considerations, the primary structural tension is recruitment scaling vs. adult stock.

Chosen improvement

Introduce adult stock saturation in recruitment using a Beverton–Holt-like cap:
- Ecological reasoning: Even with improved mating success (Allee), fertilization, egg production, and successful larval production do not increase without bound with adult density due to spawning synchrony limits, spatial dispersion, and environmental carrying limits. A saturating stock-recruitment term is biologically well-supported and helps generate transient, episodic peaks that collapse when conditions deteriorate.
- Mathematical change: Modify the recruitment term from:
  Rec_det = alpha_rec * C^phi * f_Allee * f_food * f_Trec
  to:
  Rec_det = alpha_rec * [ C^phi / (1 + (C / C_sat)^phi) ] * f_Allee * f_food * f_Trec
  where C = adult density at t-1, C_sat is the adult density scale at which recruitment is half-saturated (in combination with phi).

Expected effects on dynamics:
- At low C: The Allee function retains a threshold; small C yields limited recruitment.
- At moderate C: Recruitment rises steeply (controlled by phi and Allee), enabling outbreaks.
- At high C: Recruitment plateaus near alpha_rec * C_sat^phi, avoiding unrealistic runaway growth and allowing density-dependent mortality and prey depletion to drive a bust. This tends to sharpen peaks and shorten outbreak duration, improving alignment with observed boom-bust cycles.

Implementation notes
- New parameter: C_sat (units ind m^-2). Added a weak smooth penalty to keep it within a broad, plausible range.
- No use of current-step observations in process equations; all terms use t-1 states as before.
- The juvenile initialization at t=0 uses the same saturated formula for internal consistency.

Next steps once residuals are available
- Check peak timing and height: Over-persistent peaks should diminish with the new cap. If peaks become too short, consider relaxing gammaC or adjusting C_sat and phi.
- If early growth is still too slow, revisit Allee steepness (k_allee) or maturation (mJ).
- If mismatch appears linked to thermal anomalies, consider extending temperature effects to adult survival in future iterations (not included now to keep changes focused and interpretable).

Please share the residuals so we can target any remaining systematic patterns.
