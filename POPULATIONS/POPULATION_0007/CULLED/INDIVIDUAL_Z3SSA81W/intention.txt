Assessment and rationale

1) Fit to data (using available information)
- A residuals file was referenced but not provided here, so I cannot quantify misfit. Based on the current structure, several typical misfit patterns are likely:
  - COTS: Without explicit low-density mate limitation (Allee effect) or stage structure, the Ricker growth can allow rebounds from very low densities too easily, often producing gradual increases rather than the sharp threshold-like outbreak initiation seen empirically.
  - Coral: Predation and bleaching are represented, but peaks in COTS may be temporally too diffuse, leading to longer-than-observed periods of elevated COTS and over-prediction of chronic coral losses rather than episodic losses.

2) Alignment with PROJECT CONTEXT
- The model includes: selective predation (preference-weighted Holling III), coral competition and growth, SST-driven bleaching, COTS temperature performance, and coral-dependent settlement filtering for immigration. These are core mechanisms for coral–COTS interactions.
- Missing or oversimplified processes directly tied to episodic outbreaks:
  - Mate limitation/Allee effect on adult COTS reproduction at low densities (key threshold that can trigger outbreaks when density passes a critical level).
  - Stage structure or explicit recruitment delay (settlement to maturity), which sharpens the timing of outbreaks.
  - Environmental modulation of larval survival (e.g., nutrient/runoff-driven pulses) beyond the exogenous immigration series.

3) Key ecological processes missing/oversimplified
- The most consequential omission for boom–bust timing is a mate-finding Allee effect in adult COTS. Empirically, fertilization success rises steeply with adult density; below a threshold, populations tend to decline or persist at low densities, and above it, rapid growth—i.e., outbreak initiation—occurs. Without this, the model can produce frequent low-density rebounds and overly smooth transitions.
- A maturation delay would further improve realism but adds a state variable and more parameters. Given the ONE change constraint, adding mate limitation is the highest benefit-to-complexity improvement.

Chosen improvement: Add an Allee (mate limitation) modifier to the adult COTS per-capita growth

Ecological motivation
- Adult broadcast spawners (COTS) show strongly density-dependent fertilization success. Low adult densities have very low effective reproduction; once density crosses a threshold, reproduction and recruitment surge, enabling characteristic outbreak initiation.

Mathematical form
- Introduce a saturating Allee factor f_allee(N) applied multiplicatively to the intrinsic-per-capita growth term in the Ricker process:
  - f_allee(N) = [ N / (A50_allee + N) ]^k_allee, with A50_allee > 0 and k_allee ≥ 1.
  - Properties: f_allee → 0 as N → 0; f_allee → 1 as N → ∞; steeper with larger k_allee.
- Modified COTS growth term (at time t uses N_{t-1} only; no data leakage):
  - growth_term = r_cots * [(1 - gamma_food) + gamma_food * f_food_t] * f_temp_t * f_allee(N_{t-1})
  - N_t = N_{t-1} * exp(growth_term - m_cots - beta_cots * N_{t-1}) + immigration_t
- Immigration remains filtered by coral-dependent settlement as before. This lets exogenous settlement pulses still matter, but endogenous adult reproduction requires crossing an adult density threshold, sharpening outbreak timing.

Expected effects on fit and dynamics
- Reduces spurious rebounds at very low COTS densities.
- Creates a clearer threshold for rapid growth, improving the timing and magnitude of outbreak onsets (boom phase).
- Helps terminate outbreaks (bust) as density declines below threshold, especially when combined with density dependence and food/temperature limitation.
- Maintains identifiability by using a simple two-parameter function with biologically interpretable scales.

Parameterization and priors (soft bounds via penalties)
- New parameters on natural scales (reported) with suggested plausible ranges:
  - A50_allee (m^-2): lower_bound ≈ 0.01, upper_bound ≈ 1.0 (mate-finding threshold typically between 0.05–0.3 m^-2 but allow flexibility).
  - k_allee (dimensionless): lower_bound ≈ 1.0, upper_bound ≈ 5.0 (steepness from mild to sharp thresholds).
- Estimation scale uses log-parameters to enforce positivity:
  - A50_allee = exp(A50_allee_raw)
  - k_allee = 1 + exp(k_allee_raw)

Notes and future extensions (not implemented here)
- Adding a juvenile stage (settlers/subadults) with maturation delay would further sharpen outbreak timing and duration.
- If runoff/nutrient time series are available, an environmental driver on settlement/larval survival could be added to immigration or reproduction.

Summary of changes
- model.cpp: Added Allee effect factor f_allee(N_{t-1}) to COTS per-capita growth; added parameters A50_allee_raw and k_allee_raw, their transforms, reporting, and soft penalties; reported f_allee time series.
- parameters.json: Added A50_allee_raw and k_allee_raw with initial values and documentation.
- intention.txt: Documented assessment, rationale, and expected impacts, ensuring no use of current-timestep observed data in process equations.
