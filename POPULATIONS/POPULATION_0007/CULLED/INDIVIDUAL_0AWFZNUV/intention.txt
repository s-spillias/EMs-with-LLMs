Assessment and rationale for improvement

1) Fit to data
- I do not have the residuals file in this chat, so I cannot quantitatively evaluate fit. Please provide the residuals to enable checks for:
  - Systematic bias (positive/negative means), amplitude mismatch (under/overestimation of outbreak peaks), phase lag (timing errors).
  - Autocorrelation in residuals (indicating missing process memory such as cohort dynamics or thresholds).
  - Duration mismatch (too short/long predicted outbreaks vs observed).
- Based on the model structure, I expect common issues without additional mechanisms:
  - Underprediction of outbreak onset speed at low adult densities.
  - Difficulty sustaining the high, short-lived peaks without an explicit positive density-dependence in reproduction.
  - Potential phase mismatch if outbreak triggers rely solely on exogenous immigration.

2) Alignment with the project context (episodic COTS outbreaks)
- Strengths already present:
  - Outbreak termination: Negative density dependence (Ricker), temperature performance, and food limitation can drive busts.
  - Selective predation: Type III functional response with preference for fast coral, and conversion to percent cover loss per group.
  - Environmental modifiers: SST-driven bleaching for corals; Gaussian SST performance for COTS; settlement filtered by coral habitat.
- Gaps for episodic outbreak dynamics:
  - Missing positive density dependence (Allee effect) in adult reproduction/fertilization success. Empirically, COTS exhibit strong aggregation and broadcast spawning; fertilization success rises steeply with adult density. This creates a low-density threshold and helps explain rapid boom onset once the threshold is crossed, and failure to outbreak when below it.

3) Potentially missing or oversimplified processes
- Adult reproductive Allee effect (key for outbreak initiation) — missing.
- Pulsed larval survivorship linked to nutrient/runoff anomalies — partially captured via exogenous immigration, but not mechanistically modeled here.
- Stage structure (juvenile refugia and delayed recruitment) — not included; could explain lagged dynamics but adds substantial complexity.
- Spatial spread between reefs — out of scope for this individual-based time series.
- Coral recovery heterogeneity and recruitment limitation — partially represented via logistic growth and competition; likely adequate for current scope.

Chosen improvement: Add an Allee effect on adult COTS reproduction

Ecological rationale
- COTS are broadcast spawners with fertilization success strongly dependent on adult density and aggregation. This produces threshold behavior: below a critical density, populations rarely outbreak even if food and temperature are favorable; above it, growth can be explosive until density dependence and resource depletion truncate the peak. Adding an Allee multiplier to the per-capita growth provides a simple, biologically interpretable mechanism for outbreak initiation and helps reproduce boom-bust episodicity.

Mathematical formulation (applied to the per-capita growth term)
- Define f_allee(N_{t-1}) = N_{t-1}^q / (A50^q + N_{t-1}^q), with q ≥ 1, A50 > 0.
  - A50 is the adult density (indiv m^-2) at which Allee limitation is half-relieved.
  - q controls the steepness of the threshold response.
- Modified COTS growth in the Ricker term:
  growth_term_t = r_cots * [(1 - gamma_food) + gamma_food * f_food_t] * f_temp_t * f_allee(N_{t-1})
  N_t = N_{t-1} * exp(growth_term_t - m_cots - beta_cots * N_{t-1}) + immigration_t
- Properties:
  - At very low N, f_allee ~ 0, suppressing growth and preventing spurious outbreaks from noise.
  - Around N ≈ A50, growth accelerates, enabling rapid outbreak onset when density crosses the threshold.
  - At high N, f_allee → 1, leaving negative density dependence and resource limitation to terminate the outbreak.

Parameterization
- New parameters on convenient transformed scales (consistent with existing conventions):
  - half_sat_allee_raw (log scale), with half_sat_allee = exp(half_sat_allee_raw) in indiv m^-2.
  - q_allee_raw (log scale), with q_allee = 1 + exp(q_allee_raw) ≥ 1.
- Suggested priors/soft bounds for interpretability:
  - half_sat_allee in [0.001, 1.0] indiv m^-2 (covers sub-threshold to outbreak densities typically reported on the GBR; outbreak thresholds are often ~0.15–0.2 m^-2).
  - q_allee in [1, 5] to allow moderate to steep threshold shapes without excessive rigidity.

Data usage and identifiability notes
- No data leakage: f_allee uses only previous-step N.
- Expect improved timing (phase) and amplitude of outbreak peaks.
- Check for tradeoffs with gamma_food; Allee can reduce the need for extreme food-limitation weights to explain low-density stasis.
- Residual diagnostics post-refit:
  - Reduced positive autocorrelation around outbreak onsets.
  - Better alignment of peak timing and height.
  - More realistic durations of high-density phases.

Implementation summary
- Added two parameters and an Allee multiplier into the COTS Ricker growth term.
- Reported new derived quantities for transparency: f_allee, half_sat_allee, q_allee.
- Added smooth penalties on natural scales for biological plausibility.

Please provide the residuals if available so I can reassess fit and, if necessary, refine A50 bounds or q steepness based on observed onset dynamics.
