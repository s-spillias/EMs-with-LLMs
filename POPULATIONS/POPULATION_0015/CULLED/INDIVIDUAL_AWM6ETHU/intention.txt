Goal: Predict the time-evolving concentrations of nutrient (N), phytoplankton (P), and zooplankton (Z) in the oceanic mixed layer using a mechanistic NPZ (Nutrient–Phytoplankton–Zooplankton) model that balances realism, parsimony, and numerical stability.

Ecological functioning:
- Primary production: Phytoplankton grow via nutrient uptake with saturating (Monod) nutrient limitation and a smooth seasonal light-modifier. Growth is a specific rate applied to P, reflecting resource limitation and environmental modulation.
- Grazing: Zooplankton graze on phytoplankton via a flexible Holling-type functional response (type II to type III via a smooth exponent), with an assimilation efficiency that partitions ingested biomass into zooplankton growth versus excretion.
- Mortality and recycling: P and Z suffer linear natural mortality. A fraction of all lost biomass (mortality, unassimilated ingestion, and phytoplankton exudation/leakage) is remineralized back to the dissolved nutrient pool, closing the loop and creating feedbacks.
- Physical supply: Vertical mixing replenishes nutrient via a first-order exchange with an external reservoir concentration, stabilizing nutrient at low levels and allowing recovery after blooms.
- Indirect effects and feedbacks: Nutrient uptake reduces N and supports P, which fuels grazing that supports Z; losses from P and Z recycle to N, providing a stabilizing feedback. Seasonal light modifies both phytoplankton growth and grazing, introducing realistic temporal variability.

Numerical and statistical design:
- Dynamics are integrated by forward Euler using observed initial conditions N(0), P(0), Z(0); no data are used within the process equations beyond step t−1 states to avoid leakage.
- All nonnegative states are stabilized with smooth positivity enforcement; small constants prevent division by zero; seasonal effects use smooth sigmoids.
- Parameters are softly bounded within biologically meaningful ranges using smooth penalties to avoid hard constraints.
- Observations are modeled with lognormal errors and minimum standard deviations to handle different magnitudes and avoid numerical issues.

Intended use:
- Calibrate to time series of N, P, Z and use to forecast ecosystem states under varying initial conditions and seasonal forcing.
