Model intention: NPZ (Nutrient–Phytoplankton–Zooplankton) dynamics in a well-mixed ocean surface layer, designed for prediction from initial conditions.

Ecological functioning (concise)
- State variables:
  - N: dissolved inorganic nutrient (g C m^-3, carbon-equivalent).
  - P: phytoplankton biomass (g C m^-3).
  - Z: zooplankton biomass (g C m^-3).
- Core processes:
  1) Phytoplankton uptake of N drives production, limited by nutrient availability (Monod) and self-shading (light limitation proxy). A seasonal environmental modifier (sinusoidal) modulates maximum growth.
  2) Zooplankton graze on phytoplankton with a generalized Holling functional response (Type II–III continuum) and a smooth grazing threshold at low P. Grazing is seasonally modulated.
  3) Process efficiencies:
     - Phytoplankton carbon-use efficiency (fraction of uptake retained as biomass; remainder respired to N).
     - Zooplankton assimilation efficiency (fraction of ingestion converted to Z; remainder recycled to N).
  4) Mortality for P and Z (linear), with all mortality losses recycled to N, providing feedback that sustains the nutrient pool.
- Conservation: The formulation closes the carbon mass balance between N, P, and Z under the assumption of a well-mixed box and immediate recycling of unassimilated/respired carbon to N.
- Environmental modification: Seasonality (period ≈ 1 year, configurable) modulates both phytoplankton growth and zooplankton grazing, capturing light/temperature effects.
- Numerical design:
  - Time-varying step dt derived from the provided time series.
  - Smooth maximum ensures non-negative states.
  - Small epsilons prevent division by zero and log(0).
  - Smooth penalties nudge parameters into biologically meaningful ranges without hard constraints.
- Observation model:
  - Lognormal errors for strictly positive N, P, Z with a minimum SD floor to maintain stability across magnitudes.
- Use case:
  - Initialize predictions at the observed first values (N_dat(0), P_dat(0), Z_dat(0)) to anchor trajectories.
  - Calibrated via maximum likelihood; suitable for forecasting by forward simulation from fitted parameters.
