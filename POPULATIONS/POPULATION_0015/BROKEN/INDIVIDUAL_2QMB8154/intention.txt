Purpose: Simulate the coupled dynamics of a simple NPZ (nutrient–phytoplankton–zooplankton) food web in the surface mixed layer, with explicit process formulations suitable for forecasting under observed initial conditions.

Core processes:
- Phytoplankton growth is limited by nutrients and light, using saturating resource limitation and a smooth weighting between constraints to avoid discontinuities. A seasonal environmental driver (cosine) smoothly modulates maximal rates to represent changes in light/mixing over time.
- Zooplankton grazing follows a flexible Holling-type functional response (shape ≥ 1), with separate assimilation efficiency for growth, and unassimilated/egested fluxes recycled to dissolved nutrients.
- Mortality of phytoplankton and zooplankton includes linear (background) and quadratic (density-dependent) losses; fractions of these losses are remineralized to nutrients, providing an important feedback loop.
- Nutrient dynamics track uptake by phytoplankton, remineralization from losses and grazing byproducts, external supply, and first-order export/sinking.
- Indirect effects arise through recycling and grazing: higher grazing reduces phytoplankton, increases zooplankton growth, and simultaneously enhances nutrient regeneration via unassimilated feeding and mortality pathways.
- All fluxes use smooth, saturating forms with small positive constants added where necessary to maintain numerical stability, and parameters are softly bounded within biologically meaningful ranges.

Inference and predictions:
- The model is cast in discrete time (Euler integration over observed time steps) and initialized from the first observed values of N, P, and Z (no state-initialization parameters).
- Observations (N_dat, P_dat, Z_dat) enter the likelihood via lognormal errors with minimum standard deviations to stabilize fits across magnitudes.
- Predictions N_pred, P_pred, Z_pred are generated only from past predicted states (no data leakage), and are reported for comparison to observations.
