Model intention: Simple NPZ (Nutrient–Phytoplankton–Zooplankton) dynamics in a mixed layer for forecasting

This model simulates the coupled dynamics of:
- N: dissolved nutrient available to phytoplankton (g C m^-3; treated generically as a limiting resource in carbon-equivalent units),
- P: phytoplankton biomass (g C m^-3),
- Z: zooplankton biomass (g C m^-3),

within a well-mixed surface layer. Phytoplankton growth is co-limited by nutrient and a seasonal proxy for light, and modulated by temperature via a Q10 relationship. Zooplankton graze on phytoplankton using a Hill-type functional response, converting a fraction into growth while the remainder is routed back to dissolved nutrient (sloppy feeding, excretion, mortality remineralization). Non-grazing phytoplankton losses are remineralized to nutrient. Exchange with deeper waters allows external nutrient supply.

Numerical implementation uses forward Euler with irregular time steps taken from the provided “Time (days)” vector. To ensure robustness, all state updates are softly constrained to be positive, small constants prevent division by zero, and smooth penalties discourage parameters from leaving biologically plausible ranges. Observations for N, P, and Z are modeled with lognormal errors with a fixed minimum standard deviation to avoid degeneracy at small concentrations. Predictions at each time step depend only on the previous predictions (no use of current observed values), and initial conditions are set directly from the first observations to anchor the trajectory.

Key ecological processes represented:
1) Co-limited primary production: nutrient saturation and seasonal light limitation; temperature Q10 scaling.
2) Grazing: Hill-type functional response capturing saturation and potential switching.
3) Process-specific efficiencies: fraction of grazed biomass converted to zooplankton growth; remaining routed to nutrient.
4) Losses and remineralization: linear phytoplankton losses, linear and quadratic zooplankton mortality, all remineralized to nutrient.
5) External inputs and feedbacks: vertical exchange replenishes nutrient; feedbacks propagate through grazing and remineralization loops.

Intended use:
- Parameter estimation and forecasting under observed initial conditions.
- Exploration of seasonal/temperature effects on bloom dynamics and trophic transfer.
