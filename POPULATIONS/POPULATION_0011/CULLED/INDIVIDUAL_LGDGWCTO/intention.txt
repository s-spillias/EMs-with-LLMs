This model simulates the coupled dynamics of dissolved nutrient (N), phytoplankton (P), and zooplankton (Z) in the oceanic mixed layer using a carbon-based NPZ framework.

Core ecological processes
1) Phytoplankton growth is co-limited by nutrients and light using saturating functional forms (Monod for nutrients, saturating light function). Growth is temperature-modified with a Q10 formulation.
2) Zooplankton grazing follows a flexible Holling-type (order h) functional response on phytoplankton. A fixed assimilation efficiency partitions ingested carbon between zooplankton growth and unassimilated egestion.
3) Mortality includes linear (background) and quadratic (density-dependent/aggregation) losses for P and Z. Losses and unassimilated material are remineralized back to dissolved nutrients via specified fractions.
4) Physical mixing supplies or removes nutrients via relaxation toward an external concentration, representing entrainment and exchange with deeper waters.

Indirect effects and feedbacks
- Grazing reduces P, increases Z through assimilation, and instantaneously recycles a fraction to N.
- Mortality and excretion contribute to N via remineralization, closing the carbon loop.
- Environmental modifiers (temperature and light seasonality) act multiplicatively on physiological rates, producing realistic seasonal changes without non-differentiable thresholds.

Numerical and statistical treatment
- Simulation uses discrete-time Euler stepping with observed time increments; state non-negativity is enforced smoothly using a softplus mapping.
- Parameters are softly bounded within biologically plausible ranges using smooth penalties rather than hard constraints.
- Observations (N_dat, P_dat, Z_dat) are modeled with lognormal errors with a minimum standard deviation, ensuring all observations contribute to the likelihood.
- Initial conditions are set exactly to the first observed values to avoid fitting initial states.

This formulation yields a stable, interpretable model that can predict future ecosystem states from initial observations while respecting mass-balance feedbacks and robust ecological theory.
