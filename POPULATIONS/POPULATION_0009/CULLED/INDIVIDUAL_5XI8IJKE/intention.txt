PROJECT: Dynamical behaviour of a simple plankton population model (N-P-Z in the mixed layer)

Assessment summary
1) Model fit to data
- A quantitative residual-based evaluation was requested, but no residuals file was provided in this context. Please share the residuals to enable targeted diagnostics (bias, autocorrelation, phase errors, heteroscedasticity).
- Qualitatively, the current structure can produce classical spring-bloom dynamics, but two common misfit patterns are expected if present in your residuals:
  a) Positive N residuals during or immediately after high grazing: insufficient recycling causing N to remain too low.
  b) Phase or amplitude mismatches in P/Z: over-damped or overly fast crashes when ingestion losses are not partially returned to the dissolved pool.

2) Alignment with the project context
- The current NPZ model explicitly resolves N, P, and Z in the mixed layer and includes:
  - Resource limitation for P via a Monod term in N and a light limitation factor combined via a smooth-min (alpha_colim).
  - Temperature (Q10) scaling for core biological rates.
  - Mixed-layer exchange/dilution with a nutrient inflow (D_mix, N_in).
  - Mortality, excretion, and a Type II/III-like grazing response (Hill exponent h).
- This addresses the core processes expected for the stated context without unnecessary complexity.

3) Processes that may be missing or oversimplified
- Missing indirect pathway: Unassimilated ingestion (1 − AE_Z) currently exits the system, whereas in mixed layers a substantial fraction is quickly remineralized to dissolved nutrients (sloppy feeding, dissolved/particulate pathways that turn over rapidly).
- Light forcing: L_avail is constant; seasonal/diurnal variability and potential photoinhibition are not represented.
- Temperature scaling: Quadratic zooplankton mortality (gamma_Z) is not temperature-scaled (only linear m_ZL is), which may be inconsistent if gamma_Z represents predation/encounters that are temperature sensitive.
- Stoichiometric variability and detritus/DOC pools are not modeled (by design, given the simple NPZ scope).

Parameter review
- Q10 has been updated from literature (value ~2), and it is applied to multiple processes (growth, grazing, linear mortalities, excretion). The quadratic mortality gamma_Z is left unscaled; this is acceptable if gamma_Z represents processes not strongly temperature-dependent, but often it will be at least partly temperature sensitive (potential future refinement).
- AE_Z (0.6) is reasonable and within literature ranges (0.3–0.9). Without an egestion pathway, (1 − AE_Z) currently acts as an unaccounted sink, biasing nutrient mass balance.
- D_mix and N_in act as compensating parameters for both nutrient supply and biomass dilution; if the model is forced to use high D_mix to sustain P due to missing recycling, it may artificially dilute P and Z.

Chosen ecological improvement (implemented)
Approach: Indirect pathway and feedback mechanism — instant recycling of a tunable fraction of unassimilated ingestion to dissolved nutrients.

Ecological justification:
- A substantial portion of ingested phytoplankton is not assimilated by zooplankton. In mixed layers, much of this unassimilated material (sloppy feeding, excretion of dissolved products, fast-remineralizing particulates) can rapidly return to the dissolved nutrient pool.
- Adding this pathway improves mass balance and can reduce systematic biases where N is under-replenished during grazing-driven P declines.

Mathematical representation:
- Let grazing = gZ_rate * func_resp * Z_prev (existing).
- Unassimilated ingestion fraction: (1 − AE_Z).
- New parameter r_egN in [0, 1] controls the fraction of unassimilated ingestion that is instantly remineralized to nutrients.
- Egestion-driven nutrient recycling term: egest_N = r_egN * (1 − AE_Z) * grazing.
- Modify remineralization to: remin_N = r_PN * mortP + r_ZN * mortZ + excrZ + egest_N.

Expected effects on dynamics:
- Faster nutrient replenishment during/after high grazing, supporting secondary growth and more realistic post-bloom rebounds.
- Reduced need for unrealistically high D_mix to sustain nutrients, decoupling mixing from nutrient supply when not supported by data.
- Potential improvement of phase relationships between P decline and N recovery, and better Z dynamics through more realistic nutrient feedbacks.

Implementation notes:
- Added parameter r_egN with bounds [0, 1]; initial value 0.6 as a plausible midpoint.
- Introduced diagnostic output egest_N_pred for interpretability.
- Added a weak smooth penalty keeping r_egN within [0, 1] (like L_avail and AE_Z).
- No data leakage: only previous-step states are used in the process model.

Future candidates (not implemented here, pending residuals):
- Temperature scaling of gamma_Z to align all loss processes with Q10.
- Time-varying light availability or photoinhibition to explain seasonal/diurnal signals if present.
- Explicit detritus/DOC pool if residuals indicate a need for slower recycling timescales.

Action requested:
- Please provide the residuals file (or summary diagnostics) to evaluate the quantitative fit, check for remaining biases, and prioritize the next refinement (e.g., temp-scaling gamma_Z vs. light dynamics).
