Assessment and rationale for model improvement

Context
- Project: Simple NPZ mixed-layer model simulating nutrient (N), phytoplankton (P), and zooplankton (Z) concentrations.
- Current structure includes: Monod nutrient limitation, a saturating light limitation using a constant L_avail, smooth-min co-limitation, Holling-type grazing (Hill exponent h), linear P mortality, linear + quadratic Z mortality, Q10 temperature scaling of phytoplankton growth, and direct remineralization to N.

Fit to data
- Residuals file was not included in the supplied files, so a quantitative fit assessment is not possible here.
- Based on experience with similar NPZ models, common misfits include:
  - Over-prediction of bloom peaks or prolonged high P following a bloom.
  - Underestimation of nutrient rebound amplitude/timing after blooms.
  - Phase lags between predicted and observed Z peaks if P peaks are too sharp or long-lived.

Effectiveness relative to the project context
- The model aligns with the project’s scope (mixed-layer NPZ) and includes standard resource limitation and grazing dynamics.
- Light is currently treated as a fixed availability scalar (L_avail), which can be too coarse for mixed layers where self-shading modulates the realized light environment as P increases.

Potentially missing or oversimplified processes
- Light–biomass feedback (self-shading): Absent. This is important in mixed layers during blooms and is a low-cost addition.
- Temperature dependence for zooplankton processes: Only P growth is Q10-scaled; Z losses/grazing may also vary with T, but adding this now increases identifiability challenges.
- Detritus/DOM pool: Currently all losses recycle directly to N; adding a detritus compartment improves realism but adds state complexity beyond the “one change” request.
- Variable AE_Z: Often depends on prey/food quality; requires stoichiometric or prey-quality proxies not present here.

Updated parameters and structural adequacy
- Q10 has updated literature bounds and value (2.12). Limiting temperature scaling to phytoplankton growth is still acceptable for a first-order model. Extending temperature scaling to zooplankton processes remains a possible future enhancement but is not essential for the one-change constraint.

Chosen improvement: Phytoplankton self-shading of light
- Ecological reasoning: As P increases, water column light attenuates, reducing the effective light experienced by phytoplankton. This constrains bloom peaks and accelerates post-bloom decline, often improving fit for P and N without adding new state variables.
- Mathematical form:
  - L_eff(t) = L_avail * exp(-k_shade * P(t-1))
  - f_L(t) = L_eff(t) / (K_L + L_eff(t))
  - Co-limitation remains a smooth-min with the existing alpha_colim.
- Parameter added: k_shade (m^3 g C^-1), with suggested bounds [0, 5] and initial value 0.8. This keeps the exponent dimensionless and provides a plausible range for attenuation per unit biomass.
- Expected effects:
  - Dampens unrealistically high P peaks.
  - Improves timing and magnitude of N rebound.
  - May reduce the need to push m_P or g_max to extreme values to control blooms.
- Diagnostics:
  - A new diagnostic L_eff_pred is reported to inspect effective light over time.
- Data-leakage note: The prediction at time i uses P(i-1) only to compute L_eff(i), respecting the no-leakage requirement.

Future opportunities (not implemented here)
- Extend temperature dependence to Z processes (grazing and respiration).
- Introduce a detrital pool with finite remineralization time.
- Allow AE_Z to vary with food concentration or quality.

