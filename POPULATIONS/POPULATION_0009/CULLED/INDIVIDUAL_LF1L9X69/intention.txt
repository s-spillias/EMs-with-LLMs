Purpose: Predict the coupled dynamics of nutrient (N), phytoplankton (P), and zooplankton (Z) concentrations in the oceanic mixed layer using a mechanistic NPZ model suitable for forward simulation and data assimilation.

Ecological functioning:
- Primary production: Phytoplankton growth is limited by multiple resources via a smooth co-limitation formulation that blends nutrient limitation (Michaelis–Menten) with an environmental modifier (e.g., light/temperature seasonality). This avoids hard “minimum of” rules while capturing threshold-like behavior when one resource is scarce.
- Trophic transfer: Zooplankton graze on phytoplankton using a Holling-type functional response with adjustable curvature (handling threshold/saturation effects). Assimilation efficiency partitions ingested production into zooplankton biomass versus unassimilated material returning to the nutrient pool.
- Losses and recycling: Phytoplankton experience non-grazing losses (e.g., mortality/exudation). Zooplankton have linear and density-dependent (quadratic) mortalities. A remineralization efficiency routes a fraction of all losses and unassimilated material back to the dissolved nutrient pool, closing the feedback loop.
- Physical forcing: Vertical mixing relaxes nutrient towards an external concentration to represent exchange with deeper waters. An environmental seasonal signal (sinusoidal) smoothly modifies primary production rates.
- Indirect effects: Grazing reduces P, which reduces Z food supply; Z mortality and unassimilated ingestion increase N, which then feeds back to P growth. Mixing alters N and indirectly modulates P and Z.

Numerical and statistical approach:
- Time-varying step sizes are respected using the provided observation times. Euler forward integration with smooth positivity enforcement prevents negative states, and small constants avoid division by zero.
- Parameters are softly bounded within biologically plausible ranges via smooth penalties (no hard constraints), improving stability while allowing uncertainty.
- Observations (N_dat, P_dat, Z_dat) are strictly positive; a lognormal likelihood with a minimum observation error floor is used to maintain numerical robustness across magnitudes.
- Initial conditions are taken directly from the first observation for each state to prevent data leakage from current-step observations into process equations.

Outputs:
- Predicted trajectories N_pred, P_pred, Z_pred aligned to observation times, suitable for forecasting and for parameter inference via maximum likelihood or Bayesian extensions.
