Assessment

Data fit
- No residuals file was provided in this context, so I could not quantitatively assess fit. Conceptually, the likelihood structure is sensible: lognormal for adult COTS and logit-normal for coral proportions, with stabilized transforms and minimum SD floors to avoid singularities.
- The process model initializes states from data at t=0 and then uses only predictions (no leakage beyond initial conditions), which is correct.

Alignment with project context
- The model includes key ingredients: (i) temperature-modified larval performance for COTS and coral, (ii) selective predation on two coral functional groups with a flexible functional response (q), (iii) space-limited coral growth, (iv) food-dependent COTS survival, (v) external larval immigration, and (vi) Beverton–Holt crowding for adult COTS.
- However, the current recruitment formulation (recruits proportional to C with a simple saturating fertilization term C/(h_spawn + C)) may be too weakly depensatory to trigger realistic outbreak thresholds. In nature, fertilization depends on gamete encounter rates that scale with pair interactions; depensation is a core mechanism that governs when populations “ignite” into outbreaks.

Potentially missing or oversimplified processes
- Maturation delay/stage structure: COTS typically require multiple years to reach adulthood; direct same-year conversion from reproduction to adults can suppress boom–bust timing. A juvenile stage or delay queue would better capture lags.
- Stronger depensation in fertilization: Pair-encounter (quadratic) scaling of fertilization success is widely used and can generate ignition thresholds needed for episodic outbreaks.
- Environmental pulses (e.g., nutrient/runoff-driven larval survival): Currently only temperature modifies larval performance. Runoff/nutrient pulses are important in some systems; if data are available they should modulate larval survival.
- Predation/mortality feedbacks: Predator control or targeted culls could be included if relevant data exist.

Parameter review
- Topt_cots has been updated from the literature with narrow bounds (28–29 °C), which sharpens temperature control of larval performance. This supports retaining a Gaussian temperature modifier but does not, by itself, resolve outbreak ignition.
- Many other parameters remain initial estimates. Of note, h_spawn currently governs fertilization with a simple hyperbola; literature on broadcast spawners supports pair-encounter (quadratic) forms.

Chosen single improvement

Approach: Strengthen the Allee effect in fertilization by using a quadratic (pair-encounter) saturating function:
- Rationale: Broadcast spawning fertilization success scales with encounter probability of gametes, which often behaves like a pair interaction. A quadratic saturation C^2/(h_spawn^2 + C^2) creates a clearer threshold: at low adult densities, effective recruitment is strongly suppressed; once past the threshold, recruitment accelerates, enabling realistic outbreak ignition and boom–bust cycles without adding new state variables.
- Mathematical change (Section 3 in code): Replace
  phi_spawn = C / (h_spawn + C)
  with
  phi_spawn = C^2 / (h_spawn^2 + C^2)
- Consequences:
  - Low-density suppression is stronger, improving outbreak timing/magnitude (ignition requires surpassing a density threshold).
  - Uses the existing h_spawn parameter; its ecological interpretation becomes the half-saturation density under quadratic mating. Units remain individuals m^-2; no re-scaling of fec is required because phi remains in [0,1], but estimates may shift during fitting.
  - No data leakage is introduced; all calculations use predicted states from t.

Future potential extensions (not implemented here)
- Add a one- or two-year maturation delay (juvenile state) to sharpen timing of peaks and lags.
- Incorporate runoff/nutrient pulse modifiers to larval survival if data exist.
- Allow q (functional response exponent) or max_cons to vary with coral composition as a variable-efficiency term.

Implementation summary
- Updated model.cpp: switched fertilization success to quadratic saturation.
- Updated parameters.json: clarified the definition of h_spawn to reference the quadratic (pair-encounter) formulation. No numerical bounds changed.
