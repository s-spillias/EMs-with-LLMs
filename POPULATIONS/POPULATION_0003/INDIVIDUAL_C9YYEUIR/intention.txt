Assessment and rationale for ecological improvement (INDIVIDUAL_C9YYEUIR)

1) Model-data fit
- Residuals: A residuals file was referenced but not provided among the files shared here, so a formal residual analysis (bias, autocorrelation, variance structure by state variable) cannot be completed in this update.
- Likelihood structure is appropriate for the data types:
  - COTS: lognormal on strictly positive counts with a small epsilon to handle zeros.
  - Coral: logit-normal on proportions with stabilization to avoid 0/1 boundaries.
- Recommended residual diagnostics once available:
  - Check for lag-1 autocorrelation in COTS residuals (indicative of missing process feedbacks).
  - Inspect residuals during outbreak onsets/peaks; underprediction at peaks and overprediction during declines is typical if recruitment is not sufficiently resource-dependent.
  - Compare residual variance between low and high COTS phases; heteroskedasticity could signal missing state-dependent dynamics.

2) Alignment with PROJECT CONTEXT (episodic COTS outbreaks)
The current model captures key elements:
- Temperature-dependent larval performance (phi_T_COTS) and coral performance (phi_T_CORAL).
- Allee effect in fertilization (phi_spawn).
- Selective predation on fast vs slow corals with flexible functional response (q, hA, hS, max_cons, prefA).
- Food limitation on adult survival (phi_food) and crowding (Bevertonâ€“Holt).

Potential gaps for outbreak dynamics:
- Recruitment does not depend on prey availability, yet reproductive condition and early post-settlement success are tightly linked to food (live coral). This can dampen booms or mis-time peaks.
- No explicit juvenile/cryptic stage or multi-year cohort storage, which is known to influence outbreak timing, but adds notable complexity.
- Coral thermal stress increases are represented via reduced growth but not via temperature- or heatwave-driven mortality pulses.
- External nutrient/runoff pulses are not represented explicitly (though cotsimm_dat may partially proxy external inputs).

3) Ecological process likely oversimplified
- The pathway from coral availability to COTS recruitment is missing. Adult fecundity and effective recruitment to the adult stage increase with food, while coral depletion feeds back to suppress recruitment, reinforcing boom-bust cycles.

Selected single improvement: Coral-dependent reproductive efficiency in recruitment
- Change: Modify recruitment to include phi_food^gamma_rec_food.
  recruits = fec * C_t * phi_spawn(t) * phi_T_COTS(t) * phi_food(t)^{gamma_rec_food}
- New parameter: gamma_rec_food (dimensionless, >=0), initial 1.0, bounds [0, 4].
- Justification:
  - Empirical studies show COTS gonad index and fecundity scale with nutritional condition from feeding on live coral.
  - Early-stage survival toward adulthood is higher when food is abundant, especially during and immediately prior to outbreaks.
  - This mechanism provides a realistic positive feedback necessary to generate sharp booms when coral is plentiful and a self-limiting effect that accelerates busts as coral is depleted.
  - It preserves the role of temperature and Allee effects while adding a biologically grounded resource limitation on reproduction.

Notes on other considered changes (not implemented here)
- Adding a juvenile/cryptic stage or explicit time delays would likely improve outbreak timing but increases state dimension and identifiability challenges without additional data.
- Introducing temperature-driven coral mortality (e.g., bleaching) could improve coral dynamics during heatwaves; may revisit if residuals show systematic coral errors at high SST.
- Modulating immigration by environment could be explored if external drivers are provided.

Data-leakage safeguard
- Only lagged predicted states (C_t, A_t, S_t) and contemporaneous exogenous drivers (sst_dat(t), cotsimm_dat(t)) are used in process equations; no use of *_dat beyond initialization at t=0.

Action items requested
- Please provide the residuals file to refine diagnostics and, if needed, adjust gamma_rec_food bounds or consider additional structure (e.g., juvenile stage or heat-stress mortality).
