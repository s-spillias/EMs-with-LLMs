Assessment and rationale

1) Fit to data (residuals)
- No residuals file was available in this chat context, so I cannot quantify fit. Based on similar systems and this model structure, common residual patterns are:
  - Underestimation of outbreak peaks (predicted peaks are too low and/or too narrow).
  - Phase lag errors (model peaks arrive earlier/later than observed).
  - Overestimation of inter-outbreak baseline adults (too slow to return to low densities).
These issues typically arise when recruitment to the adult stage reacts too immediately to adult density and environmental modifiers, with insufficient time delays or stock buffering.

2) Alignment with PROJECT CONTEXT
- The model already includes:
  - Positive density dependence in fertilization (Allee-like), temperature modifiers for larvae and coral, food limitation on adult survival, selective predation on coral with preference and flexible (Type II/III) functional forms, and Beverton–Holt crowding for adults.
- This can produce boom–bust dynamics, but it lacks a key ecological pathway for episodic outbreaks: the cryptic juvenile stage and its delayed transition to adults, regulated by coral availability. This stage is widely recognized as critical for COTS outbreaks, where juvenile cohorts can persist at low detection levels and then rapidly mature to adults when food increases.

3) Missing/oversimplified processes
- Missing explicit juvenile stage: Larvae settle into juveniles that survive and grow cryptically; maturation to adults accelerates with high coral availability. Without this, recruitment immediately boosts adult numbers, limiting the model’s ability to reproduce outbreak lags and multi-year pulses.
- No explicit juvenile mortality: Mortality at this stage affects the size of the pool that can fuel future outbreaks.
- Environmental triggers beyond temperature (e.g., nutrients/runoff) are not represented. While important, adding them requires additional data; thus, I prioritize the juvenile-stage delay because it is impactful and data-independent.

Chosen improvement: Add a juvenile (cryptic) stage with food-dependent maturation

Ecological reasoning
- Juveniles accumulate as a latent pool (J_t), created by larval production and reduced by juvenile mortality and maturation into adults.
- Maturation rate increases with coral (food) availability via a saturating function, introducing a realistic time delay and a strong, food-mediated feedback that can generate abrupt adult outbreaks when coral cover recovers.

Mathematical representation (annual step, index t)
- Recruitment to juveniles:
  R_t = fec * C_t * phi_spawn(C_t) * phi_T_COTS(t)

- Juvenile food modifier and maturation:
  phi_juv_food(t) = (A_t + S_t) / (kJ_food + A_t + S_t)
  gamma_t = gammaJ_max * phi_juv_food(t)          // realized annual maturation probability (0–gammaJ_max)

- Juvenile dynamics (mass balance):
  J_{t+1} = max( 0, (1 - mJ - gamma_t) * J_t + R_t )

- Adults with survival, immigration, and crowding:
  survival(t) = exp( -[ mC + mC_food * (1 - phi_food(t)) ] )
  C_raw_{t+1} = C_t * survival(t) + gamma_t * J_t + I(t)
  C_{t+1} = C_raw_{t+1} / (1 + beta_dd * C_raw_{t+1})   // Beverton–Holt

- Coral and other components remain as implemented; no data leakage is introduced (states at t+1 depend only on states at t and exogenous drivers).

Expectations
- Improves timing and magnitude of outbreaks by allowing latent accumulation and food-triggered release to adults.
- Retains the existing crowding control and all observation models.
- Adds three interpretable parameters with biologically grounded ranges.

Parameter updates
- New parameters:
  - gammaJ_max (dimensionless yr^-1, 0–1): Maximum juvenile maturation probability per year.
  - kJ_food (% cover): Half-saturation for juvenile maturation vs. total coral cover.
  - mJ (dimensionless yr^-1, 0–1): Juvenile annual mortality rate.
- Initial values are set conservatively as placeholders; bounds reflect plausible biological limits. No literature updates were asserted here (updated_from_literature=false).

Implementation notes
- A new unobserved state J_pred(t) is added and reported.
- Initial J_pred(0) is initialized using the model’s own t=0 recruitment R_0 (consistent with the existing use of observed states at t=0 for initialization only; no leakage beyond t=0).
- Likelihood remains unchanged; only the process model is modified.

Next steps (after you provide residuals)
- Check whether peak underestimation and phase lag errors are reduced.
- If peaks are still too low, consider allowing temporary reduction of adult mortality at high food or adding stochastic anomalies to R_t.
- If lags are still off, consider adding an additional delay (e.g., a two-compartment juvenile pipeline) or allowing temperature or nutrients to modulate gammaJ_max.
