Assessment and rationale

1) Model fit
- Residuals: A residuals file was referenced but not provided here. In similar COTS models, typical mismatches are underestimation of outbreak peaks and overly smooth dynamics (peaks muted; timing off by 1–3 years). The current structure (temperature-modified recruitment, food-limited survival, BH crowding) tends to produce gradual responses, which can struggle to reproduce abrupt outbreak onsets and high-amplitude peaks.
- Without the residuals at hand, the most defensible improvement targets known outbreak drivers while preserving current strengths.

2) Alignment with PROJECT CONTEXT
- The project emphasizes timing, magnitude, and duration of boom–bust outbreaks. Key empirical insight: episodic larval survival pulses (often linked to runoff/nutrient events and favorable oceanography) trigger explosive recruitment. This is absent from the current deterministic recruitment formulation (recruits = fec * C * phi_spawn * phi_T_COTS).
- The model already captures:
  - Selective predation on coral groups (Acropora vs. slow corals) with a flexible functional response.
  - Adult survival limited by food (total live coral).
  - Coral regrowth limited by free space and temperature.
  - Beverton–Holt self-limitation.
- Missing or oversimplified processes for outbreaks:
  - Episodic environmental pulses driving larval survival/recruitment.
  - Potentially, settlement/survival dependence on reef structure (e.g., Acropora availability), and predator controls on COTS. These could be considered later if residuals indicate systematic bias.

3) Parameters review
- Topt_cots (28.5 °C, range 28–29 °C) has been updated from literature; this narrows the thermal window for larval survival. The Gaussian modifier remains appropriate given the narrow optimum; no structural change is required.
- Other parameters remain initial estimates (e.g., foodK=30%, beta_dd=0.2, prefA_logit=1.0, log_q_FR ~ -0.693 implying q=1.5). These are reasonable but may adjust once outbreak pulses are modeled.
- Observation SDs are floored smoothly to avoid singularities; this is appropriate.

Chosen single improvement

Environmental modifier of recruitment via stochastic pulses
- Ecological reasoning: Outbreaks are often precipitated by years with unusually high larval survival due to favorable environmental conditions (e.g., nutrient pulses, hydrodynamics). Representing this as a multiplicative annual factor on recruitment captures timing and magnitude of episodic outbreaks while letting food limitation and coral depletion drive the bust phase.
- Mathematical form: env_mult(t) = exp(sigma_env * z_rec(t) - 0.5 * sigma_env^2), with z_rec(t) ~ N(0,1) independent across years. This yields a lognormal multiplier with mean 1, avoiding bias to long-term growth while enabling rare large pulses.
- Implementation:
  - Introduced PARAMETER_VECTOR z_rec (length T-1) and PARAMETER log_sigma_env.
  - Modified recruits(t): fec * C_t * phi_spawn(t) * phi_T_COTS(t) * env_mult(t).
  - Added a weak penalty on sigma_env (0.01–2.0) to keep pulses within plausible ranges and retain identifiability.
  - No data leakage: Only previous time step states (C_t, A_t, S_t) and exogenous covariates (sst, cotsimm) are used.

Expected impact
- Timing: Allows single-year pulses to trigger rapid adult increases after a 1-year lag, improving timing of peaks relative to observations.
- Magnitude: Heavy-tailed recruitment events can match observed high outbreak peaks better than smooth dynamics.
- Duration: As coral cover declines during peaks, adult survival decreases (via phi_food), and recruitment falls (fec * phi_spawn is density dependent), generating realistic busts.

Future extensions (if residuals warrant)
- Add settlement success dependence on fast coral (Acropora) to couple structure to recruitment.
- Include predator control or removal pulses if data support.
- Consider spatial coupling in immigration if multiple reefs are modeled jointly.

Parameter metadata updates
- Added log_sigma_env to parameters.json:
  - Units: dimensionless (SD on log scale).
  - Description: SD of lognormal recruitment multiplier.
  - Initial value: log(0.1) = -2.302585093 (moderate variability).
  - Bounds guidance: sigma_env ~ 0.01–2.0 (implemented as a soft penalty in model.cpp). Leave JSON bounds as null, consistent with other log-scale SDs.

Note on residuals
- Please share the residuals file to verify whether pulses reduce peak underprediction and correct timing biases. We can refine sigma_env and consider additional mechanisms if systematic discrepancies remain.
