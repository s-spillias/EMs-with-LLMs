Assessment and rationale for model update

1) Model fit to data
- I do not have the residuals file in the chat. Please supply it so I can quantitatively assess fit (bias, autocorrelation, phase errors, and variance by state).
- Based on model structure alone, common symptoms in COTS outbreak models without an explicit pre-adult stage are:
  - Phase errors: adult peaks can occur too soon after favorable conditions because recruitment is routed directly to adults within the same annual step.
  - Overly sharp boom onset and short duration: immediate recruitment to adults can create spikes that decay too quickly, missing observed multi-year elevated abundances.
  - Autocorrelated residuals in adults: missing time-lag processes often show up as positive residual autocorrelation.

2) Alignment with the project context
- Strengths:
  - Broadcast spawning Allee effect is represented (Hill-type fertilization success).
  - Temperature modifiers for larval survival and coral growth are included.
  - Food limitation on adult survival and Beverton–Holt crowding for adults provide negative feedbacks.
  - Selective, saturating coral consumption (with preference and Type II/III shape) captures differential pressure on fast vs slow corals.
- Gaps related to episodic outbreaks:
  - No explicit pre-adult (juvenile/subadult) stage or maturation delay. Outbreak timing and duration are strongly influenced by time-lag between spawning and detectable adults (often 1–3 years to reach sizes counted as adults).
  - External larval supply is treated as an instantaneous contribution to adults rather than entering a pre-adult pool, reducing persistence of outbreak cohorts and smoothing expected from multi-year recruitment waves.
  - Nutrient/runoff pulses (important for larval survival) are not modeled beyond SST; however, new environmental inputs are not available in the current data specification.

3) Key ecological processes likely missing or oversimplified
- Pre-adult stage dynamics (juvenile survival and maturation) are missing. This is a critical mechanism for triggering and sustaining multi-year outbreak trajectories and for shaping boom-bust timing.
- Immigration routed directly to adults rather than to a juvenile pool likely shortens and sharpens outbreaks and can misalign outbreak peaks with forcing.

Chosen improvement: Add an explicit juvenile stage with maturation delay
- Ecological reasoning:
  - COTS typically require 1–2+ years to reach adult sizes; juveniles experience different mortality and food dependence than adults.
  - Adding a juvenile state introduces a natural time-lag and cohort persistence, improving the model’s ability to reproduce observed boom-bust timing, peak magnitude, and outbreak duration without forcing unrealistically high fecundity or immigration pulses.
  - Routing external larval supply into juveniles (instead of adults) better reflects biology and sustains cohorts across years.
- Mathematical changes:
  - New state J_t (juveniles). Within-year juvenile survival: survJ = exp(-(mJ + mJ_food*(1 - φ_food))).
  - Maturation: a fraction γ_J of the survived juveniles at year-end mature to adults.
  - Flows:
    - Juvenile recruitment: J_new = fec * C_t * φ_spawn * φ_T_COTS (fec now produces juveniles, not adults).
    - Immigration to juvenile pool: I_J = α_imm * cotsimm_dat(t) / (k_imm + cotsimm_dat(t)).
    - Juveniles update: J_{t+1} = (1 - γ_J) * (J_t * survJ) + J_new + I_J.
    - Adult update: C_{t+1,raw} = C_t * exp(-(mC + mC_food*(1 - φ_food))) + γ_J * (J_t * survJ).
    - Beverton–Holt self-limitation on adults maintained as C_{t+1} = C_{t+1,raw} / (1 + β_dd * C_{t+1,raw}).
  - A new initial condition parameter J0 estimates the initial juvenile pool (no data leakage).
- Expected effects:
  - Introduces realistic lag between favorable spawning conditions and adult outbreaks.
  - Increases outbreak persistence by carrying juvenile cohorts forward, potentially reducing the need for extreme parameter values.
  - Should reduce residual autocorrelation and phase bias if those are present.

Notes on parameters and structure updates
- fec: reinterpreted to produce juveniles (previously “effective to adults”); adult contribution is now via γ_J after juvenile survival.
- α_imm and k_imm: now explicitly govern larval/juvenile immigration to the juvenile pool (not adults).
- New parameters:
  - mJ (juvenile baseline mortality), mJ_food (additional juvenile mortality with food scarcity), γ_J (annual maturation fraction), J0 (initial juvenile density).
  - Bounds reflect plausible ranges; can be tuned with data.
- No response-variable data at time t are used in prediction updates (no data leakage). Only t=0 initial adult coral states still use the observed t=0 values (as before). The juvenile initial state is estimated via J0.

Please provide the residuals file for a quantitative post-update assessment (fit diagnostics and whether additional mechanisms such as nutrient/runoff modifiers are warranted).
