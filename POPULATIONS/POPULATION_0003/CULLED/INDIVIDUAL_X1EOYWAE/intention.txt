Assessment and rationale for modification

Summary of current structure
- The model includes: temperature-modified coral growth and larval performance (phi_T_CORAL, phi_T_COTS), saturating fertilization success (phi_spawn), food-limited adult survival, selective predation (Type II/III with Acropora preference), logistic coral growth with space limitation, exogenous saturating immigration, and Beverton–Holt crowding of adults.
- Initial conditions use t=0 observations only; subsequent dynamics rely on predicted states and exogenous drivers, preventing data leakage.

Fit to data (residuals not provided)
- Residuals file was referenced but not included here. Without it, a quantitative fit assessment is not possible in this context.
- Typical misfit patterns for outbreaking species with no maturation delay include: (a) peaks that are too smooth or occur too early, (b) underpredicted outbreak magnitude, (c) overly rapid damping after peaks. These arise because immediate stock–recruit feedback tends to smooth oscillations and misalign timing.

Alignment with PROJECT CONTEXT
- Objective: episodic boom–bust dynamics in Crown-of-Thorns starfish (COTS) that rapidly increase to outbreak levels then decline, with selective predation on coral groups and attention to outbreak triggers.
- Strengths already present:
  - Temperature effects on larvae and corals.
  - Food-limited adult survival and strong selective predation.
  - Immigration to emulate connectivity-driven pulses.
  - Smooth numerical treatments to avoid instabilities.
- Gaps relative to context:
  - No explicit maturation delay from reproduction to adult stage (~2–3 years in COTS), which is a key mechanism underlying outbreak periodicity via delayed density dependence.
  - No nutrient/river runoff driver for larval survival (often implicated in outbreak initiation), though this would require additional data not available here.
  - No explicit stage structure; current model aggregates all adult dynamics.

Parameter review
- Parameter values are plausible and within biologically sensible bounds:
  - rA (0.6 yr^-1), rS (0.3 yr^-1), max_cons (20% cover per starfish per year), Topt values, and sigmaT values are reasonable.
  - Some parameters are clearly placeholders (“initial estimate”), but without new literature updates included here, changes are not made now.
- Structural implications:
  - fec is defined as effective annual recruitment to adult stage per adult. With a maturation delay, fec naturally becomes “adult-equivalent production at spawning time that will be realized L years later.” This retains ecological meaning without changing bounds.

Chosen single improvement: maturation delay in recruitment (delayed density dependence)
- Rationale:
  - COTS require ~2–3 years to reach reproductive maturity. Incorporating a fixed 2-year delay in recruitment to the adult stage introduces a biologically realistic time lag that is known to generate oscillations and sharpen outbreak cycles.
  - This addresses mis-timed and over-smoothed peaks common in models with instantaneous recruitment, better matching the boom–bust character described in the project context.
  - Keeps model parsimony: no new parameters and no additional data requirements; uses only predicted states and exogenous drivers, avoiding data leakage.
- Mathematical form:
  - Define larval production at time t as:
      larval_prod(t) = fec * C_t * phi_spawn(t) * phi_T_COTS(t)
  - Recruits between t and t+1 are the production realized after L=2 years:
      recruits(t) = larval_prod(t + 1 - L) for t + 1 - L >= 0; else 0
  - Adult update becomes:
      C_raw_{t+1} = C_t * survival(t) + recruits(t) + I(t)
      C_{t+1} = C_raw_{t+1} / (1 + beta_dd * C_raw_{t+1})
- Implementation details:
  - Added larval_prod as a tracked vector.
  - Replaced immediate recruitment with lagged recruitment using a fixed L=2.
  - No current-time observed data are used in process equations; only predicted states and exogenous inputs.
  - Updated code comments and equation summary.

Expected effects on dynamics and fit
- Introduces delayed density dependence, promoting cyclic/episodic behavior and improving timing of outbreaks.
- Can increase outbreak magnitude (more accumulation before recruitment manifests) and lengthen decay tails (through lagged feedback), aligning with observed boom–bust sequences.
- Retains identifiability of key parameters and existing observation models.

Future directions (optional, not implemented)
- If residuals show systematic underprediction of outbreak initiation, consider adding an environmental modifier for larval survival (e.g., runoff/nutrient/chl-a) when such data are available.
- If stage structure is needed, extend to juvenile and subadult classes with explicit transitions and temperature/food dependencies.
- Consider temperature-driven coral mortality pulses (bleaching) if high-SST residuals suggest timing mismatches linked to coral cover shocks.

Notes
- Residuals file was not included here. Please provide it if you want a targeted diagnostics write-up (autocorrelation, peak timing errors, amplitude bias, etc.) and to evaluate whether L=1–3 is optimal.
