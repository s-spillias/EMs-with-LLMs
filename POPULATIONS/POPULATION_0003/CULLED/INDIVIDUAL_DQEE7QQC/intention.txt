Assessment and update plan for COTS outbreak model (INDIVIDUAL_DQEE7QQC)

A) Model fit evaluation
- Note: A residuals file was referenced but was not included among the provided files. Please share it (or summary metrics: RMSE, bias, autocorrelation of residuals) to enable a quantitative fit assessment.
- Qualitative expectations from current structure:
  - COTS: Beverton–Holt (BH) density dependence and saturating survival vs. food typically produce smooth convergence and may under-represent rapid bust phases or oscillations without strong exogenous pulses (immigration or SST). Outbreak timing may be late or muted if recruitment is immediate and fully determined by same-year adults.
  - Corals: Logistic growth with shared free space and selective predation should capture directional declines during outbreaks and recovery afterward; however, recovery rates may be too optimistic without additional bottlenecks (algae competition, disturbance legacies).

B) Alignment with project context (episodic outbreaks)
- Strengths:
  - Selective predation with Type II/III response and prey preference (Acropora vs. slow coral) is appropriate.
  - Temperature modifiers for coral performance and larval survival are present.
  - Food-limitation of adult survival is ecologically reasonable.
  - Immigration forcing allows exogenous influxes.
- Limitations relative to boom–bust dynamics:
  - Immediate recruitment (t → t+1 from same-year adults) can compress the real cohort dynamics. COTS typically have larval tenure and juvenile phases; adult outbreaks are often delayed relative to spawning pulses by about a year (at annual resolution).
  - BH crowding on adults tends to damp cycles; without delayed feedback, endogenous boom–bust behavior may be weak unless immigration or SST drives sharp pulses.
  - No explicit modifier for nutrient/runoff pulses that elevate larval survival (a known trigger), though such data may not be available.

C) Potentially missing or oversimplified processes
- Stage/maturation delay (larvae/juveniles to adult): Missing; recruitment is instantaneous. This is critical for capturing timing of outbreaks.
- Nutrient/runoff effects on larval survival: Missing; could be an environmental multiplier when data are available.
- Post-disturbance coral recovery bottlenecks (e.g., macroalgal competition/phase shifts): Not modeled; may cause slower recovery than logistic predicts.
- Additional density dependence (overcompensatory/Ricker-type) in adults: Could enhance busts but risks instability without strong justification.

D) Parameters review
- fec is currently “recruits per adult per year reaching adulthood.” With immediate recruitment, fec blends larval production and maturation in the same annual step, which can obscure the natural delay.
- Other parameters are plausible and have biologically sensible bounds:
  - Temperature response centers (Topt_cots ~28.5°C, Topt_coral ~27°C) and widths are reasonable.
  - Predation parameters (max_cons, hA, hS, q via log_q_FR) allow flexible functional response.
  - Food limitation (foodK) affects adult survival but not recruitment/fecundity.
- No explicit literature-updated values in the JSON indicate structural mis-scaling; however, introducing a maturation delay clarifies the ecological interpretation of fec without requiring new parameter estimates.

Chosen single improvement: Introduce a one-year maturation delay for recruitment
- Rationale:
  - Outbreaks are driven by strong recruitment cohorts after favorable spawning/larval years; adults peak after larvae/juveniles mature. A one-year lag (at annual resolution) is a minimal but ecologically meaningful structure that shifts and sharpens outbreak timing.
  - This provides endogenous delayed feedback that can produce more realistic boom–bust dynamics even without adding new data or parameters.
  - Keeps parameterization simple: fec remains interpretable as “number reaching adulthood one year later,” but we explicitly model the 1-year lag pipeline.
- Mathematical change:
  - Replace immediate recruits(t) with recruits(t) = L_prev, where L_prev stores fecundity from the previous time step.
  - Update the previous larval cohort each step with L_prod(t) = fec * C_t * phi_spawn(t) * phi_T_COTS(t).
  - Initialize the prior cohort at t=0 using the t=0 state to avoid an artificial zero-recruit artifact in the first transition.

Implementation details
- Added an internal cohort buffer L_prev:
  - At t=0, initialize L_prev = fec * C0 * phi_spawn0 * phi_T_COTS0 using the model’s initial state (no data leakage beyond the standard t=0 initialization already in place).
  - In each step:
    - recruits = L_prev;
    - L_prod = fec * C * phi_spawn * phi_T_COTS;
    - L_prev = L_prod for the next year.
- No new parameters added; parameter file unchanged.
- All other mechanisms (food-limited adult survival, predation, coral growth, immigration, BH crowding) remain as-is.

Expected effects and diagnostics
- Expected improvements:
  - More realistic timing: outbreak peaks will lag favorable spawning/temperature years by one annual step.
  - Clearer boom–bust transitions due to delayed feedback and subsequent crowding/survival limits.
- Diagnostics to review (once residuals are provided):
  - Autocorrelation in COTS residuals should reduce if prior model systematically led/lagged observed peaks.
  - Peak amplitude and duration fit should improve if outbreaks were previously too smeared.
  - Check identifiability: fec should remain estimable; early-year (t=1) residuals may shift due to the initialization choice.
- Future optional extensions (not implemented here, to preserve single-change scope):
  - Add a nutrient/runoff larval survival modifier if data exist.
  - Make fecundity condition-dependent on coral cover (resource-linked reproduction).
  - Consider overcompensatory adult density dependence only if justified by residual patterns.

Action summary
- model.cpp: Implement one-year maturation delay via cohort buffer (L_prev) feeding adult recruitment.
- parameters.json: No changes required.
- This change is consistent with project goals and maintains ecological realism without added complexity.
