Assessment and rationale

1) Fit to data (based on code structure; residuals file not available in this context)
- The current model uses:
  - Immediate (same-year) recruitment from adult COTS to adults, modulated by temperature and Acropora cover.
  - Beverton–Holt crowding on adults to prevent divergence.
  - Selective, saturating coral consumption with a flexible Type II–III functional response.
  - Temperature-modified logistic coral growth with space limitation and background mortality.

Qualitative expectations for residuals under this structure:
- Timing: Without a maturation delay, predicted adult peaks may occur too soon after increases in adult density. Real COTS exhibit multi-year lags from spawning to adult outbreaks. This can lead to phase shifts where predicted peaks lead observed peaks (positive residuals just before observed peaks, negative at the peaks).
- Magnitude: Beverton–Holt crowding at the adult stage can dampen peak magnitude if most growth occurs via same-year feedback from adults, producing underestimation of outbreak magnitude in highly favorable recruitment years.
- Duration: Immediate feedback may lengthen predicted high-abundance periods (adults replenish themselves same year) versus observed sharper boom-busts.

2) Alignment with the project context (episodic outbreaks, timing, magnitude, duration)
- Strengths:
  - Selective predation and temperature modifiers are represented.
  - Food limitation on survival and Type III predation can reproduce non-linear prey–predator interactions.
  - Immigration is included via a saturating term.
- Gaps impacting outbreak dynamics:
  - No explicit developmental delay from larval/juvenile stages to adults. This is central to episodic recruitment pulses and the observed timing of outbreaks.
  - Larval survival is only modulated by SST; other known drivers (e.g., nutrient/runoff pulses) are not represented (data-dependent).
  - Recruitment currently feeds directly into the adult pool, likely smearing timing and dampening peak amplitude or shifting peaks.

3) Ecological processes missing or oversimplified
- Juvenile stage dynamics and the associated time delay (key for boom-bust timing) are oversimplified into an instantaneous adult recruitment term.
- Environmental recruitment pulses beyond temperature (e.g., nutrient runoff) are not modeled (may be added if/when a covariate becomes available).
- Adult crowding is included; juvenile bottleneck survival to adulthood is not explicitly parameterized.

Chosen improvement

Approach: Introduce an explicit one-year maturation delay via a juvenile pool with a transition to adulthood.
- Adds a single intermediate state J(t) representing the pool of settlers/juveniles produced at t−1 that can mature to adults at t.
- Production of juveniles at time t depends on adult density (density-dependent fertilization), and larval performance via SST (as currently coded).
- Transition from the juvenile pool to adults depends on:
  - A saturating Acropora-mediated term (existing phi_juv(A) already defined), representing habitat/food dependence.
  - A new parameter sJ representing baseline juvenile survival/transition efficiency (0–1).
- Adults update via survivorship, matured juveniles from the previous time step, and immigration, then Beverton–Holt crowding.

Why this helps:
- Reflects known life-history timing: reproduction → larvae/settlers → juveniles → adults (with a lag).
- Introduces delayed density dependence, a classic mechanism that produces boom-bust oscillations and improves timing of outbreaks.
- Preserves existing environmental modifiers (SST) and trophic interactions while avoiding data leakage (uses only predicted states).
- Keeps complexity modest (two new parameters, one new state variable).

Structural changes implemented
- New state: juv_pred(t), initialized with parameter J0 (juvenile pool at t=0).
- Recruitment is split into:
  1) Juvenile production at t: J_next = fec * C_t * phi_spawn(t) * phi_T_COTS(t)
  2) Maturation at t: matured = sJ * J_t * phi_juv(A_t)
- Adult update: C_{t+1} = [C_surv(t) + matured + immigration] / [1 + beta_dd * (C_surv + matured + immigration)]
- Reinterpreted parameter fec as the rate of production into the juvenile pool (not direct-to-adult recruitment).
- Added parameters:
  - sJ (0–1): baseline juvenile survival/transition to adulthood.
  - J0 (>=0): initial juvenile pool at t=0.

Notes
- No current-time-step observed variables (_dat) are used in process calculations beyond initialization at t=0 (which was already present for adult and coral states). J0 avoids using cots_dat(0) to initialize the juvenile pool.
- If/when residuals show systematic phase errors (peaks predicted too early) or damped peaks, this delay is expected to reduce those issues.
- Future extensions (data permitting) could include nutrient/runoff modifiers on J_next and/or multi-year juvenile stages.

Expected effects
- Sharper, better-timed adult outbreaks (peaks lagging reproductive pulses).
- Potentially higher peak amplitudes (juvenile accumulation then release) without destabilizing dynamics.
- Improved fit in years where observed outbreaks lag modest increases in adult density and favorable SST conditions.

