Assessment and rationale (COTS boom–bust dynamics)

1) Fit to data
- The residuals file was not provided in this chat, so I cannot directly quantify fit quality. Based on typical patterns in COTS datasets, models without an explicit juvenile (cryptic) stage often:
  - Overcouple adult abundance to same-year recruitment drivers, producing peaks that are too tightly timed to environmental signals.
  - Underestimate outbreak duration or mis-time peaks because real systems have multi-year juvenile lags before adults emerge.
- The current structure converts food consumption immediately into next-year adults (via sJ), which likely produces too-fast responses and insufficient outbreak persistence.

2) Alignment with the project context
- Strengths of current model:
  - Selective, saturating predation on fast/slow corals.
  - Environmental modifiers via temperature for recruitment and bleaching effects on coral.
  - Immigration term to allow exogenous pulses.
  - Bounded adult dynamics via Beverton–Holt.
- Gaps relative to project context:
  - Outbreaks are episodic and often involve a cryptic juvenile phase lasting multiple years before sudden adult emergence. This delayed density dependence (cohort “release”) is a key mechanism for boom–bust timing and duration that is not explicitly represented.
  - Beverton–Holt alone is compensatory; without a time-lagged demographic pathway, the system can struggle to reproduce observed boom persistence and lagged busts.

3) Missing or oversimplified ecological processes
- Juvenile cryptic stage with delayed maturation to adults (missing).
- Possible nutrient-driven larval survival (not available in provided inputs), so immediate changes cannot incorporate a nutrient proxy.
- Potential coral-mediated effects on juvenile survival or maturation (not modeled).
- Current sJ rolls multiple processes (settlement, survival, maturation) into a single one-step adult entry.

Chosen improvement: Add an explicit juvenile (cryptic) stage with delayed maturation

Ecological reasoning
- Evidence shows COTS can remain cryptic for 1–3+ years before recruiting to the visible adult population. A separate juvenile state introduces delayed density dependence and cohort accumulation—mechanisms known to produce realistic boom–bust cycles (build-up in juveniles, abrupt emergence, and sustained outbreaks before density dependence and food limitation drive declines).
- This change preserves current forcings (SST, immigration) and the food-fueled reproduction proxy while decoupling recruitment production from immediate adult abundance.

Mathematical changes
- Introduce a juvenile pool J_t that receives recruitment R_t, experiences baseline juvenile mortality mJ0, and matures to adults at rate gJ.
- Updated recruitment pipeline (t indexes Year, states use t–1):
  R_t      = thermal_t * epsilon_repro * (predF_t + predS_t) * A_t + alpha_imm * IMM_t
  J_surv   = (1 - mJ0) * J_t
  Adults from juveniles: A_enter = gJ * J_surv
  Juveniles carried forward: J_carry = (1 - gJ) * J_surv
  J_{t+1}  = softplus(J_carry + sJ * R_t)
  Num_t    = (1 - mC0) * C_t + A_enter
  C_{t+1}  = Num_t_pos / (1 + bC * Num_t_pos)
- Notes:
  - sJ now represents settlement efficiency from recruits into the juvenile pool (0–1).
  - gJ is the annual maturation fraction of surviving juveniles.
  - mJ0 is a baseline juvenile mortality fraction.
  - J0 initializes the juvenile pool at t=0.
  - All transitions only use states from the previous step and forcings from [t–1, t) to avoid data leakage.
  - Beverton–Holt is retained for adult crowding stability; delayed maturation provides the key dynamical lag for outbreak timing and duration.

Expected benefits
- Improved timing: adult peaks can occur after favorable recruitment years due to cohort accumulation and release.
- Increased persistence of outbreaks: juvenile buffering sustains adult numbers before crowding and food limitation drive the bust.
- Better separation of processes (settlement vs. maturation), improving interpretability and calibration.

Parameter updates
- sJ reinterpreted: settlement efficiency into juvenile pool (0–1).
- New parameters:
  - gJ (0–1): annual maturation rate juvenile→adult.
  - mJ0 (0–1): juvenile baseline mortality.
  - J0 (≥0): initial juvenile density at t=0.
- Suggested initial values and bounds are provided in parameters.json with biological justification.

Next steps
- Once residuals are available, evaluate improvements in timing and magnitude of peaks, outbreak duration, and lag structure (ACF/PACF of residuals). If under- or over-persistence remains, adjust gJ and mJ0 and consider making gJ coral- or food-dependent in a later iteration.
