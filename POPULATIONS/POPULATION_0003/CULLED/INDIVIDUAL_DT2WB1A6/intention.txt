Purpose: Predict episodic boom–bust outbreaks of Crown-of-Thorns starfish (COTS) on the Great Barrier Reef and their impacts on coral community composition (fast-growing Acropora vs. slower Faviidae/Porites), with emphasis on timing, magnitude, and duration of outbreaks.

Core processes:
- COTS population dynamics: Adult survival with food limitation; recruitment proportional to adult abundance (fertilization success saturating with adult density), modulated by sea-surface temperature (SST) via a bell-shaped larval survival response; and external larval immigration with saturating contribution. Density dependence (Beverton–Holt) prevents runaway growth at extreme densities.
- Selective predation: COTS consume corals via a preference-weighted Holling functional response (Type II/III), with higher preference for Acropora. Consumption is capped smoothly by available coral tissue.
- Coral dynamics and space limitation: Acropora (fast) and Faviidae/Porites (slow) grow logistically limited by free space and modified by SST (bell-shaped thermal performance). Coral background mortality acts continuously. The two coral groups share a common space budget (sum constrained to ≤ 100% cover).
- Feedbacks and outbreak mechanism: High coral cover (food) and favorable SST increase COTS recruitment and survival, triggering rapid increases. Predation then reduces coral cover, which lowers future COTS recruitment/survival and ends outbreaks (bust). Immigration pulses can initiate or reinforce outbreaks.

Data handling and predictions:
- Forcing data: Annual SST (sst_dat) and larval immigration (cotsimm_dat) drive recruitment and survival modifiers.
- Responses: Observations include adult COTS density (cots_dat) and coral cover for fast (fast_dat, Acropora) and slow (slow_dat, Faviidae/Porites).
- Initialization: Predictions start at observed initial values to anchor the state (no data leakage).
- Likelihoods: COTS uses lognormal error; coral covers use logit-normal error on proportion scale; minimum SD floors avoid numerical issues.

Numerical safeguards:
- Smooth functions (softplus/smoothmax) avoid hard cutoffs and division by zero.
- Parameter bounds enforced via smooth penalties (not hard constraints).
- All predictions and modifiers remain in valid domains (nonnegative densities, coral cover in [0,100]%).

Outcome:
- The model reproduces characteristic boom–bust COTS cycles with realistic timing, magnitude, and duration, while capturing selective coral predation and space-limited coral recovery under environmental modulation.
