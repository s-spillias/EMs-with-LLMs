Assessment of current model and rationale for improvement

1) Model fit to data
- Residuals: A residuals file was referenced but not provided in the current context. Please share it for a data-driven diagnostic (e.g., timing/magnitude/duration misfit patterns). The assessment below is based on the mechanistic structure and common misfit patterns for COTS outbreak models.
- Likely fit characteristics from structure:
  - Peaks (outbreak onsets) are primarily driven by the immigration pulse series (cotsimm_dat) filtered through a short 0–2 year lag kernel. If observed peaks occur with longer or more variable lags, early/late timing residuals can appear.
  - Declines (busts) are governed by: (a) prey depletion that lowers K_A via coral loss, and (b) fixed adult mortality mA. In many systems this combination alone can yield overly slow declines or elevated post-peak plateaus (persistence bias) relative to observed rapid crash phases.
  - Adult net recruitment includes a fecundity boost from per-capita feeding, which can sustain high densities if coral remains, potentially prolonging peaks in the absence of a countervailing density-dependent loss.

2) Alignment with the project context
- Strengths:
  - Boom mechanism: immigration pulses, Allee effect, prey-mediated carrying capacity (K_A), and fecundity boosted by feeding provide plausible triggers for outbreak escalation.
  - Bust contributors: prey depletion (through predation and bleaching) feeds back to reduce K_A; SST stress on coral increases coral mortality and suppresses coral growth.
  - Selective predation: a two-guild (fast/slow) multi-prey functional response with preference captures differential pressure on Acropora vs Faviidae/Porites.
- Gaps relative to context:
  - Outbreak termination and crash dynamics frequently involve density-dependent mortality (e.g., disease, predators, culling). A purely linear adult mortality rate can under-represent the speed and magnitude of observed busts.
  - Settlement bottlenecks mediated by coral habitat quality and nutrient-driven larval survival pulses are not explicitly modeled beyond the immigration proxy and the K_A link to coral cover.
  - The immigration lag kernel is short (0–2 years) and fixed in shape; if empirical outbreaks exhibit broader cohort delays, timing mismatches can arise.

3) Processes potentially missing or oversimplified
- High-density loss processes: Empirical literature often reports outbreak collapses via disease and predation that intensify with COTS density. This is not currently represented beyond the fixed mA · A term.
- Recruitment substrate/nutrient effects: Settlement suitability and nutrient-enhanced larval survival could be modeled, but no external covariates (e.g., runoff/chl-a) are available in the current data inputs.
- Variable immigration efficiency: gamma_I is constant; in reality it may vary with environment and/or prey state.

Chosen improvement: Add high-density adult mortality (disease/predation/culling) via a smooth saturating term
- Ecological reasoning:
  - To capture rapid post-peak declines typical of boom-bust outbreaks, add a density-dependent adult mortality component that activates at high COTS densities, representing multiple mechanisms (disease transmission, predator aggregation, targeted control).
  - This increases realism of the “bust” phase without requiring additional exogenous inputs, and keeps the state recursion data-leak-free.

- Mathematical form:
  - Extra mortality rate (yr^-1): mA_dd(A) = mA_dd_max · A^2 / (A_half_dd^2 + A^2)
  - Extra adult loss: mortA_dd = mA_dd(A_prev) · A_prev
  - Notes:
    - Hill-type saturation (exponent fixed at 2) gives negligible added mortality at low A, ramping up smoothly, and plateauing at mA_dd_max at very high A.
    - A_half_dd is the density at which half the maximum extra mortality rate is realized.
    - This form is smooth and stable for AD; it preserves the existing Beverton–Holt-like recruitment and does not use any current-time observations.

- Expected impact on fit:
  - Sharper and earlier downturns after peaks, mitigating persistence bias and better matching observed rapid declines.
  - Minimal effect on low-density phases (so triggers of outbreaks remain governed by immigration and Allee effects).

- Why this over other options here:
  - Recruitment substrate and nutrient modifiers require additional inputs or introduce stronger confounding with K_A and gamma_I.
  - Extending lag structure adds parameters primarily affecting timing, while field evidence strongly supports high-density losses during busts.

Parameter updates
- Add two parameters:
  1) mA_dd_max (yr^-1): maximum extra density-dependent adult mortality rate
     - Justification: captures disease/predation/culling intensity at high densities
     - Suggested bounds: [0.0, 3.0] yr^-1 (comparable to or modestly above rA upper range)
  2) A_half_dd (ind m^-2): half-saturation density for extra mortality activation
     - Justification: controls the density at which crash processes start to dominate
     - Suggested bounds: [0.05, 2.0] ind m^-2 (span sub-outbreak to outbreak densities)

Implementation notes
- The new term is added to the adult update:
    A_next = clip(A_prev + recruit + immig_eff - mortA - mortA_dd, tiny, +∞)
- Uses the same softclip helpers for smoothness (no kinks).
- No current-time observations are used in the process model, preserving proper state-space conditioning.
- Penalty-based soft bounds are added consistent with existing practice in the model.

Please provide the residuals file when available to validate whether the added high-density mortality resolves the primary misfit mode (post-peak persistence) or whether a complementary change (e.g., broader immigration lag kernel or settlement suitability factor) should be considered next.
