Assessment and rationale

Fit and context:
- Residuals file was not provided here, so the assessment is based on model structure and expected behavior.
- The existing model captures key dynamics: stage-structured COTS (juveniles/adults), prey preference across fast/slow corals, logistic coral growth, Holling II predation, temperature-modified larval processes, and exogenous immigration.
- For the project’s goal (episodic boom-bust outbreaks), a known mechanism for the bust phase—food-limited adult mortality—is missing. Constant adult mortality (mu_A) tends to prolong high COTS densities even after coral has collapsed.

Potential oversimplifications:
- Adult mortality is constant and independent of prey, despite strong empirical evidence for starvation during/after outbreaks when coral cover drops.
- Bleaching threshold parameter T_bleach in parameters.json is ~1 °C with near-zero range, suggesting the intention is to model anomaly above a baseline, yet the model used it as an absolute SST. This likely mis-scaled bleaching penalties.

Chosen improvement (one change):
- Add prey-dependent adult mortality (starvation) and reinterpret T_bleach as an anomaly threshold.
  - Starvation mortality: As preference-weighted prey P decreases below a threshold theta_food, the effective adult mortality increases smoothly by up to mu_A_starve.
  - This strengthens the bust mechanism, better matching the observed rapid crash and duration of low abundance following outbreaks.
  - The change is simple, mechanistically justified, and directly targets the project goal without excessive parameter proliferation.

Mathematical changes implemented

Definitions:
- Prey availability (unchanged): P_t = pref_fast * (F_t/100) + (1 - pref_fast) * (S_t/100)
- Normalized prey shortfall: deficit(P) = softplus(theta_food - P, k_starve) / (softplus(theta_food, k_starve) + eps)
- Effective adult mortality: mu_A_eff = mu_A + mu_A_starve * deficit(P), capped at < 1 to retain positive survival
- Adult update: A_{t+1} = (1 - mu_A_eff) * A_t + m_mat * J_t / (1 + kA_dd * A_t)
- Bleaching penalty (reinterpreted threshold): heat_excess_t = sst_{t} - (mean_sst + T_bleach)
  g_T_coral_t = exp(-beta_bleach * softplus(heat_excess_t, k_bleach))

Implementation notes:
- k_starve = 10 (fixed) controls the smoothness of the starvation threshold.
- New parameters added: mu_A_starve (0–0.9 yr^-1), theta_food (0–0.6 proportion). Both have soft penalties to keep within biologically plausible ranges.
- T_bleach is now explicitly treated as degrees Celsius above the long-term mean SST (an anomaly). Bounds widened to 0–3 °C to reflect plausible bleaching thresholds.

Why this helps outbreak dynamics:
- During booms, P is high, deficit(P) ≈ 0, so adult mortality ≈ mu_A; COTS can build up.
- As corals decline due to predation and stress, P drops below theta_food, increasing mu_A_eff, which accelerates adult decline and shortens outbreak duration—consistent with observed rapid post-peak crashes.
- This adds minimal complexity while creating a strong, ecologically grounded negative feedback necessary for realistic boom-bust cycles.

Data usage and leakage:
- Only previous time-step states and forcings are used to compute t+1 predictions. The bleaching anomaly uses the mean of the exogenous SST forcing, which does not introduce leakage from response variables.

Next steps if residuals become available:
- Inspect serial correlation and peak timing in COTS residuals; if early growth is still too slow/fast, consider adding a low-density Allee effect to reproduction.
- If coral bleaching misfit persists, consider replacing mean SST with a site-specific climatology or an externally provided anomaly series (e.g., DHW).
