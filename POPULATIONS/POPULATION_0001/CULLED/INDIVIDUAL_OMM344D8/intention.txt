Assessment of current model and fit

- Fit evaluation:
  - The residuals file was not included in the provided files, so a direct residual inspection is not possible here. Please share it to enable a quantitative assessment (e.g., checking temporal autocorrelation, phase-specific bias during booms vs. busts, and coverage).
  - Based on the structure, likely misfits in boom-bust systems include:
    - Peaks too prolonged when edible coral remains high, or busts that occur at the wrong time because additional mortality is only tied to high density, not resource depletion.
    - Over- or under-shooting of outbreak peak magnitude if immigration conversion is too linear (currently thresholded but not saturating) and if outbreak mortality lacks resource dependence.
    - Potential bias in coral cover residuals when consumption pressure remains high even when edible coral is scarce.

- Alignment with the project context (COTS boom-bust dynamics with selective predation on corals):
  - Strengths:
    - Immigration-triggered outbreaks via a smooth threshold.
    - Food limitation and a separate food threshold for COTS growth.
    - Type III functional response for coral consumption with diet preference for fast coral.
    - Thermal modifiers for COTS and both coral groups.
    - Outbreak-associated mortality that increases with adult density.
  - Gaps vis-à-vis the context:
    - Busts are often caused by combined high density and coral depletion (starvation/disease). Current extra mortality depends only on adult density, potentially failing to time the bust with resource depletion.
    - No explicit low-density Allee effect on reproduction. This may be important for local reproduction-driven outbreaks, but with exogenous larval immigration available, the starvation-driven bust is a higher-priority mechanism for realism and parsimony in this version.

- Key ecological processes that may be missing or oversimplified:
  1) Resource-coupled outbreak mortality: Additional mortality (disease/starvation) rises with both high density and low edible coral. Currently only density-dependent.
  2) Recruitment saturation at very high immigration (R_imm is linear in immigration, though thresholded). This may eventually need saturation but is not changed here to keep to one meaningful improvement.
  3) Potential Allee effects at very low adult densities. Deferred to avoid adding complexity without residual evidence here.
  4) Parameter magnitudes:
     - log_Kcots1 = 0 ⇒ Kcots1 ≈ 1 ind m^-2 per unit edible coral (0–1). This baseline may be low relative to reported outbreak densities (>10 ind m^-2), but the parameter is estimable and not structurally limiting.
     - log_sst_sd_fast = 0.896 ⇒ SD ≈ 2.45 °C (reasonable), while log_sst_sd_slow = -1.497866 ⇒ SD ≈ 0.224 °C (very narrow). This could cause strong temperature sensitivity for slow coral; keep an eye on identifiability and fit once residuals are inspected.
     - Updated-from-literature growth/mortality parameters for corals appear consistent with the current logistic competition form.

Chosen single ecological improvement

- Approach: Environmental modifier of process (resource-coupled outbreak mortality).
- Change: Additional outbreak-associated mortality is activated by BOTH high adult density and low edible coral (starvation/disease mechanism).
- Ecological rationale: COTS booms often collapse as edible coral is depleted. Tying extra mortality solely to high density can produce busts that are mistimed or insufficient when coral cover is low. Modulating the extra mortality by low edible coral couples predation-driven depletion to the bust phase, improving timing and magnitude of declines.

Mathematical representation

- Let E = p_fast * F + (1 - p_fast) * S be the edible coral index at t-1.
- High-density activation (existing):
  f_burst_N = inv_logit(k_burst * (N_{t-1} - N_burst_thr)).
- New starvation activation:
  f_starve_E = inv_logit(k_burst_E * (E_burst_thr - E_{t-1})).
- Effective adult mortality:
  m_eff = m_cots + m_disease * f_burst_N * f_starve_E.
  This increases additional mortality when density is high AND edible coral is low, matching ecological expectations of disease/starvation during resource scarcity.

Parameter updates

- Add E_burst_thr (proportion 0–1): Edible coral threshold below which starvation/disease mortality rises.
  - Initial value: 0.2 (typical depletion threshold where starvation risk may increase).
  - Suggested bounds: [0.0, 0.6].
- Add k_burst_E (dimensionless): Steepness of starvation activation around E_burst_thr.
  - Initial value: 10.0 (similar to existing k parameters for smooth thresholds).
  - Suggested bounds: [0.1, 50.0].

Implementation notes

- No current-time-step observations are used in process updates; all modifiers use t-1 states/forcings.
- Added a diagnostic series for the starvation activation modifier to aid residual diagnosis and posterior predictive checks.
- Weak priors centered near plausible values were added for E_burst_thr and k_burst_E to stabilize estimation.

Next steps once residuals are available

- Examine temporal structure of residuals during outbreak onset vs. collapse; ensure bust timing improves.
- If peaks remain too large under extreme immigration pulses, consider replacing linear recruitment conversion with a saturating function (e.g., Beverton–Holt in immigration) while keeping the current threshold.
- If early growth is overpredicted at very low adult densities, evaluate adding a low-density Allee modifier on local growth/recruitment.
