Assessment of current model (before change):
- Fit to data: The provided files did not include a residuals file, so a quantitative residual analysis could not be performed here. Common misfit modes for COTS outbreak models include: (a) predicted adult peaks occurring too early relative to immigration pulses; (b) incorrect peak magnitude due to immediate conversion of larval immigration to adults; and (c) overly rapid post-peak declines if density dependence acts too strongly without demographic memory.
- Alignment with project context: The model already captures key mechanisms: larval immigration as an outbreak trigger (smooth threshold), food limitation via edible coral, Allee effects, logistic crowding, thermal performance, and selective predation on coral groups with a Type III response and diet preference. These are appropriate for reproducing boom–bust cycles and coral community impacts.
- Potentially missing or oversimplified processes:
  1) Juvenile stage and time delay: In reality, COTS spend 2–3 years in cryptic juvenile stages before becoming detectable adults. The current structure sends immigration directly to adults within the same year, likely making predicted peaks too synchronous with immigration pulses and missing realistic lags.
  2) Variable early-life survival: Early stages can be temperature sensitive; the current model partially accounts for this by applying the thermal modifier to immigration, but maturation delay is absent.
  3) Additional processes (not changed here): predator control, water quality effects on larval survival, or spatial spread. These are relevant but beyond the scope of a single targeted change.

Parameter review notes:
- Several parameters were updated from literature (e.g., log_r_fast, log_r_slow, log_m_slow, sst_opt_fast), which remain structurally consistent with the current equations.
- The very small thermal breadth for slow coral (exp(log_sst_sd_slow) is small) implies strong temperature sensitivity; this is biologically plausible for stress-sensitive taxa and is kept as-is. The code already stabilizes the transform.
- The previous definition of log_alpha_imm (immigration directly to adults) is inconsistent with known life history. This motivated the structural update below.

Chosen ecological improvement:
- Add a juvenile stage to introduce a maturation delay between larval immigration and adult outbreaks.
  Ecological rationale: COTS juveniles are cryptic and remain in reef substrate for 1–3 years. Outbreaks typically lag larval settlement pulses by multiple years. A juvenile pool with maturation captures demographic memory and better reproduces the timing, magnitude, and duration of adult peaks.
  Mathematical form:
    • Immigration routing: R_juv(t−1) = alpha_imm · Imm(t−1) · f_imm(t−1) · f_T,COTS(t−1).
    • Juveniles: J(t) = pos( J(t−1) + R_juv(t−1) − (gamma_juv + m_juv) · J(t−1) ).
    • Maturation flux to adults: R_adult(t−1) = gamma_juv · J(t−1) · f_T,COTS(t−1).
    • Adults: N(t) = pos( N(t−1) + N(t−1) · [ r_max · f_food · f_T,COTS · f_allee · (1 − N/K_COTS ) − m_COTS ] + R_adult(t−1) ).
  Implementation details:
    • New parameters: logit_gamma_juv (maturation fraction, 0–1) and log_m_juv (juvenile mortality).
    • log_alpha_imm now maps immigration to juveniles rather than adults; units and descriptions updated accordingly.
    • The juvenile state J is latent, initialized at zero, and reported as juv_pred for diagnostics.
    • All prediction steps use only t−1 states/forcings; no data leakage.

Why this change (and not more complexity)?
- This single addition addresses a central mechanism controlling outbreak timing while preserving parsimony. It adds only two new parameters and reinterprets alpha_imm, yet introduces the critical time delay needed for realistic boom–bust cycles. Higher-order terms or more complex resource feedbacks could be added later if residual diagnostics still indicate systematic misfit.

Parameter additions and guidance:
- logit_gamma_juv: prior bounds [-6, 6] on logit scale (covers ~0.002–0.998 per year). Centered weakly around logit(1/3) ≈ −0.693 to reflect a 2–3 year maturation.
- log_m_juv: bounds [ln(0.01), ln(4)] ≈ [−4.605, 1.386], weakly centered on ln(0.5) for plausible annual juvenile losses.

Next steps:
- Refit with the new structure. Examine residuals, particularly the phase (peak timing) of adult COTS relative to immigration pulses, and the duration of high-density periods. If peaks still occur too early, consider allowing temperature or food availability to modulate maturation (gamma_juv) or early survival (m_juv) more strongly. If coral loss is underpredicted at outbreak peaks, reassess attack_max and diet preference parameters.
