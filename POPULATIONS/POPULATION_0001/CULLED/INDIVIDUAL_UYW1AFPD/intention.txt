Assessment of the current model and rationale for improvement

1) Fit to data
- A residuals file was referenced but not provided in this context, so I could not quantitatively assess goodness-of-fit or systematic deviations. Qualitatively, the current structure can reproduce smooth boom–bust dynamics via density dependence, an Allee effect, SST modulation, and an additive larval-immigration term. However, the additive immigration term alone often yields step-like increases that may not properly synchronize the timing and magnitude of outbreaks with observed episodic recruitment pulses.

2) Alignment with PROJECT CONTEXT
- Strengths: The model captures selective predation on fast vs slow corals, bleaching impacts on corals through SST, coral-dependent carrying capacity for COTS, and an Allee effect on COTS reproduction. These components support boom–bust dynamics.
- Gap: A key driver of Crown-of-Thorns Starfish (COTS) outbreaks on the GBR is episodic, environmentally driven variation in larval survival and supply (e.g., nutrient/runoff pulses, plankton blooms). The current model represents external larval supply additively (gamma_I * cotsimm), but does not allow larval supply to modulate the per-capita recruitment from local adults. This limits the model’s ability to capture the timing, magnitude, and duration of outbreak waves strongly tied to episodic larval survival boosts.

3) Potentially missing or oversimplified processes
- Episodic larval survival/supply: Missing as a multiplicative effect on recruitment; present only as an additive immigration term.
- Additional high-density losses (crowding disease/cannibalism): Not explicitly modeled; density dependence is primarily via logistic recruitment and mortality mA.
- Stage structure/size-specific processes: Not included (kept out for tractability).
- Predator control on juveniles: Not included.
- Environmental covariates beyond SST (e.g., runoff/nutrients): Not included.

4) Parameter review and consistency with literature updates
- q_fr (functional-response shape) is updated_from_literature = true with value 1.0 and a very tight upper bound (1.000000001), indicating a Type II response. The code’s soft penalty previously allowed q_fr up to 3.0. I tightened the code’s penalty window to match the updated literature constraint, preserving consistency.
- sst_ref is updated_from_literature with a narrow 28–29 °C prior range. I tightened the code penalty window accordingly.
- sst_bleach upper bound updated to 34.5 °C in parameters.json. I aligned the code’s penalty upper bound with this.

Chosen improvement

Approach: Environmental modifier of recruitment via episodic larval supply
- Motivation: Outbreaks on the GBR are often initiated/ amplified by episodic increases in larval survival and supply tied to environmental pulses (e.g., flood-driven nutrient inputs and plankton blooms). To capture timing and magnitude without data leakage, we use the existing cotsimm_dat covariate at t-1 to modulate per-capita recruitment multiplicatively, in addition to keeping the original additive immigration pathway.
- Mathematical change:
  - Original COTS recruitment:
    recruit = rA * f_SST_A * Phi_A * A_prev / (1 + A_prev / K_A_prev)
  - Modified COTS recruitment with saturating larval-supply multiplier:
    rec_mult_I = 1 + beta_recruit_I * (I_prev / (I_prev + I_half))
    recruit = rA * f_SST_A * Phi_A * rec_mult_I * A_prev / (1 + A_prev / K_A_prev)
    where I_prev = cotsimm_dat(t-1).
  - We retain the additive immigration term: immig = gamma_I * I_prev.
- Ecological rationale: This form allows cotsimm_dat to scale local reproductive success (settlement/survival), producing realistic, saturating amplification of recruitment during strong larval-supply events without unrealistically unbounded responses. It supports sharper, timed outbreak onsets while preserving boom–bust regulation through density dependence and carrying capacity.
- Identification and parsimony: Only two new parameters control the additional pathway:
  - beta_recruit_I (dimensionless amplitude) controls the strength of recruitment amplification.
  - I_half (same unit as cotsimm_dat) sets the scale at which the amplification is half-maximal. A saturating form mitigates overfitting to extreme values of cotsimm_dat.
- Data integrity: Only previous time step covariates are used (no data leakage). The structure remains compatible with AD and smooth penalties.

Code and parameter changes

- parameters.json:
  - Added beta_recruit_I (dimensionless) with bounds [0, 3] as a conservative but flexible range.
  - Added I_half (ind m^-2 yr^-1 proxy) with bounds [0, 10], acknowledging the index’s scale; adjust as needed once data ranges are confirmed.
  - Kept existing parameters unchanged except for consistent documentation.

- model.cpp:
  - Added PARAMETER(beta_recruit_I) and PARAMETER(I_half).
  - Implemented rec_mult_I = 1 + beta_recruit_I * I_prev / (I_prev + I_half) (numerically safe).
  - Multiplied the existing recruitment term by rec_mult_I.
  - Retained additive immigration (gamma_I * I_prev).
  - Added a reported vector recruit_mult_I for diagnostics (time series of rec_mult_I).
  - Tightened soft penalties to align with literature-updated ranges: q_fr upper bound ~1.000000001, sst_ref [28, 29], sst_bleach upper bound 34.5.

Expected effect on dynamics

- In years with elevated cotsimm_dat, local recruitment is amplified in a saturating manner, allowing sharper and better-timed outbreak onsets consistent with episodic recruitment pulses.
- The saturation prevents runaway growth from extreme index values and maintains ecological realism.
- Retaining the additive immigration pathway preserves the original interpretation of cotsimm_dat as both external input and a proxy for broader larval-supply conditions.

Notes

- Once residuals are available, examine:
  - Temporal alignment of outbreak peaks (does rec_mult_I correct lags?).
  - Magnitude/duration biases during outbreak and bust phases.
  - Identifiability between gamma_I and beta_recruit_I (consider priors/penalties or fixing one if necessary).
