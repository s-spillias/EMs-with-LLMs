Assessment and rationale

1) Model fit to data
- The residuals file was not provided here, so I could not directly evaluate residual structure (timing, magnitude, or bias). Please share it to allow targeted diagnostics (e.g., lag structure after larval pulses, outbreak peak overshoot/undershoot, and post-outbreak decay rates).
- Qualitatively, the current structure should produce boom–bust dynamics because:
  - Adult recruitment saturates with density (stock-recruit-like), shaped by an Allee term.
  - Feeding constraints and starvation mortality increase after coral depletion.
  - Coral loss feeds back on COTS carrying capacity.

2) Alignment to PROJECT CONTEXT
- The model targets episodic Crown-of-Thorns starfish (COTS) outbreaks on the GBR and their selective predation on corals (fast vs slow).
- Mechanisms represented:
  - Multi-prey functional response distinguishing fast (Acropora) and slow (Faviidae/Porites) corals with prey preferences and handling limits.
  - Coral growth, space limitation, and SST-driven bleaching mortality.
  - COTS net growth modified by a hump-shaped SST effect near an optimal temperature.
  - An Allee effect at low COTS density.
  - Critically, a 2-year juvenile pipeline converting larval supply to adults with delay and survival filtering—consistent with empirical cryptic juvenile duration and outbreak timing.
  - Starvation mortality that increases when per-capita feeding is low, producing realistic post-outbreak crashes.

3) Potentially missing/oversimplified processes
- External controls: predators/diseases on COTS, water quality (nutrients) impacts on larval success, and fishing/removal are not explicitly modeled; these may matter for outbreak initiation/spread.
- Spatial connectivity is collapsed to a single larval-supply proxy; explicit metapopulation dynamics could improve outbreak propagation realism.
- Coral recruitment and recovery processes are simplified to logistic-like growth with SST suppression; larval supply and substrate quality are not explicit.
- Fecundity-energy linkage is linear via eta_fec; in reality, reproductive output can saturate with feeding or condition.

Chosen improvement implemented
- Juvenile delay (two-stage pipeline) for larval immigration:
  - J1_t = k_settle * cotsimm_{t-1}
  - J2_t = phi_J * J1_{t-1}
  - Adult influx = phi_J * J2_{t-1}
- Ecological justification: COTS juveniles are cryptic for ~1–2 years before visible recruitment to the adult population. This delays and sharpens outbreaks following larval pulses, better aligning with observed boom timing and duration.
- Additional supportive mechanism: starvation mortality increasing when per-capita feeding is low, to capture crash dynamics after coral depletion, and a fecundity boost tied to per-capita feeding to link food to reproduction.

Parameter review notes
- Placeholders requiring calibration/literature refinement:
  - k_settle (0.3): settlement conversion from larval proxy to juveniles. Suggest bounds 0–3 in the optimizer (already enforced).
  - phi_J (0.5): juvenile survival across cryptic stages (0–1). Literature commonly indicates high early mortality; values 0.1–0.6 are plausible.
  - eta_fec (0.2): linear fecundity boost per unit per-capita feeding; consider testing saturation if residuals show over-sensitivity at high feeding.
  - kK_perc, kK0 (0.03, 0.2): determine adult carrying capacity scale; check against observed peak densities and coral cover.
- Adult mortality mA (0.565 yr^-1) is within literature (0.39–0.74 yr^-1); keep bounds as specified.
- Functional response parameters (aF, aS, hF, hS, preferences) should be cross-checked with consumption studies; current values are plausible but likely need estimation with data.

Equation structure considerations for future refinement (if residuals indicate)
- If adult peaks lag observed by more/less than ~2 years, adjust the number of juvenile stages (1–3) or phi_J magnitude.
- If reproduction appears overly sensitive to feeding, replace the linear fecundity boost with a saturating form:
    fecundity_boost = 1 + (eta_fec * percap_cons) / (1 + percap_cons / c50_fec)
  adding parameter c50_fec with bounds [0, ∞).
- If outbreak peaks still too abrupt, consider mild density-dependence on settlement via coral cover (e.g., J1_t ∝ coral cover) or a cap on juvenile carrying capacity.

Implementation notes
- Fixed errors: completed model.cpp (was truncated mid-statement), ensuring all time-recursions use only previous time-step states and exogenous inputs (no data leakage from *_dat).
- Added soft clips and numerical safeguards throughout for stability.
- Observation model uses log-normal (COTS) and logit-normal (corals) likelihoods with minimum SD floors.

Next steps requested
- Provide the residuals or observed vs predicted series to diagnose lag structure, outbreak amplitude, and decay rates. I will then tune parameter bounds or propose the next structural adjustment accordingly.
