Assessment, gaps, and chosen improvement

1) Fit assessment
- Requested residuals file was not provided in this context, so I cannot quantify misfit patterns (bias, autocorrelation, heteroskedasticity) directly. Please share it to refine diagnostics.
- Structural expectations: with only exogenous immigration driving recruitment, the model may under-predict rapid outbreak ascent or persistence when adult densities become high. Conversely, logistic crowding and background mortality may force overly symmetric, damped dynamics after peaks.

2) Alignment with the PROJECT CONTEXT
- Strengths: The model includes (a) thermal modifiers for COTS and corals, (b) food limitation with a smooth threshold on edible coral, (c) a Holling type III predation functional response with diet preference, (d) resource-modified carrying capacity, and (e) observation models suitable for COTS (lognormal) and coral proportions (Beta). These features are consistent with boom–bust dynamics mediated by food, temperature, and predation.
- Primary gap for outbreaks: The onset and maintenance of outbreaks are often reinforced by auto-catalytic recruitment—adults generate larvae that elevate local recruitment (subject to mate limitation, food, and environmental conditions). The current structure assumes recruitment only from exogenous immigration, limiting outbreak self-sustainment and potentially mismatching observed timing/magnitude.

3) Potentially missing/oversimplified processes
- No explicit adult-driven (self) recruitment feedback.
- No explicit bleaching-driven mortality pulses for corals (temperature elevates growth around an optimum but does not add asymmetric thermal mortality).
- No juvenile/age structure; all recruitment is aggregated directly into the adult pool annually.
- No explicit nutrient/river-plume signal modulating larval survival (commonly implicated in GBR outbreaks); immigration is a supplied driver, but local amplification is absent.

4) Parameter updates and structure
- Multiple coral thermal and vital-rate parameters have been updated from literature; the general functional forms remain appropriate (Gaussian thermal modifiers on growth, Beta observation). No immediate rescaling changes are required from those updates.
- The largest structural limitation is recruitment dependence solely on cotsimm_dat. To better capture outbreak triggers and sustainment, I introduce a biologically motivated self-recruitment term that is (i) Allee-limited, (ii) food-limited, and (iii) temperature-modulated.

Chosen improvement: add adult-driven self-recruitment feedback
Ecological motivation:
- Adult COTS produce pelagic larvae; when adult density is high and conditions are favorable (sufficient edible coral, appropriate temperatures, and limited mate limitation), local larval production and retention can substantially increase subsequent recruitment—reinforcing outbreaks.
- This positive feedback is a well-recognized mechanism underlying boom phases. Including it helps match rapid ascents and the persistence of high densities before resource depletion drives the bust.

Mathematical representation (annual, uses only t−1 states/forcings; avoids data leakage):
- Existing immigration recruitment:
  R_imm(t−1) = α_imm · Imm(t−1) · f_imm(t−1) · f_T,COTS(t−1)

- New self-recruitment feedback:
  R_self(t−1) = α_self · N(t−1) · f_allee(t−1) · fsat(E(t−1)) · f_T,COTS(t−1)

  where:
  • f_allee(t−1) = N(t−1) / (N(t−1) + A_cots) captures mate limitation.
  • fsat(E) = E / (E + Hh_food) captures food-dependent fecundity/settlement success.
  • f_T,COTS is the Gaussian thermal modifier.

- COTS update becomes:
  N(t) = pos( N(t−1) + N(t−1) · [ r_max · f_food · f_T,COTS · f_allee · (1 − N(t−1)/K_COTS) − m_COTS ] + R_imm(t−1) + R_self(t−1) )

Expected effects on dynamics and fit:
- Enables rapid build-up and sustained high densities during favorable conditions (boom), improving timing/magnitude of peaks.
- Maintains biologically realistic suppression at low adult densities via Allee limitation and at low edible coral via fsat.
- Busts are still governed by declining E (food), crowding vs. K_COTS, and background mortality, preserving the observed boom–bust character.

Implementation summary
- Added parameter log_alpha_self with weakly-informative prior (LogNormal centered at 0.1 yr⁻¹).
- Implemented R_self as above using only previous time-step states/forcings.
- Kept all other mechanisms unchanged to isolate the effect of this improvement.

Next steps once residuals are available
- Examine autocorrelation and lag patterns in COTS residuals to verify improved outbreak ascent timing.
- Check coral residuals for asymmetric thermal mortality signals; if present, consider adding a smooth heat-stress mortality term for corals as a subsequent enhancement.
- Assess identifiability and confounding between α_self and α_imm using profile likelihoods or posteriors; if needed, constrain with informative priors or external data.

Note on data usage:
- The implementation avoids leakage by using only t−1 states (N, F, S) and forcings (SST, immigration) to compute t updates.
