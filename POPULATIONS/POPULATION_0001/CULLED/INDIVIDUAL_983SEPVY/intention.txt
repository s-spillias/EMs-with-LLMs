Assessment and improvement plan for the Crown of Thorns starfish (COTS) boom-bust model

1) Model fit assessment (qualitative)
- Without the residuals file in this chat, a direct statistical assessment is not possible here. However, based on common mismatches observed in COTS outbreak models and the ecological characteristics of GBR outbreaks, two recurrent issues are:
  - Peaks persist too long and declines are too gradual, indicating the model lacks strong self-limiting feedbacks during outbreak phases.
  - The timing of outbreak onset can be captured via immigration/recruitment pulses and Allee effects, but collapses require mechanisms beyond linear mortality.
- The current structure already includes:
  - Selective predation on coral guilds via a multi-prey functional response with preference and handling (Acropora vs Faviidae/Porites).
  - SST-induced bleaching mortality and growth suppression in corals.
  - Allee effects for COTS reproduction and SST-modulated COTS recruitment.
  - Lagged larval immigration.
  - A fecundity boost from per-capita feeding.
These components help with outbreak initiation and coral impact patterns but can still under-represent the sharpness of busts.

2) Alignment with project context
- The PROJECT CONTEXT requires accurate timing, magnitude, and duration of episodic outbreaks, capturing rapid rises to outbreak levels and subsequent declines, alongside selective predation on coral communities. The model covers prey selectivity and environmental stress to corals, but outbreak collapses are not strongly enforced by the previous linear adult mortality alone.
- Literature and field observations indicate density-dependent processes (disease, predation, cannibalism, resource depletion effects on survival) contributing to rapid post-peak declines. Many of these pathways can intensify under heat stress (e.g., disease dynamics), providing an environmental modulation.

3) Missing or oversimplified ecological processes
- Previously missing: a density-dependent (nonlinear) adult mortality pathway, potentially modulated by environmental stress (SST/bleaching conditions). This is critical to reproduce the steep bust phase.
- Representation chosen: Add a quadratic adult mortality term that increases with density and is scaled by an SST stress index derived from lagged sst_dat. This respects the no-leakage rule and captures faster collapses after high-density phases and/or during heat stress.

Chosen improvement
- Mechanism: Density-dependent adult mortality (A^2) with environmental modulation (SST stress).
- Mathematical form (implemented):
  mortA(t) = mA*A(t-1) + mA_dd * [1 + beta_dd_sst * B(t-1)] * A(t-1)^2
  where B(t-1) = invlogit((sst_dat(t-1) - sst_bleach)/sst_scale_bleach) is an SST stress index already used in coral dynamics. This creates a strong self-limitation at high densities and under heat stress, shortening outbreak duration and sharpening crashes, consistent with observed boom-bust patterns.
- No data leakage: All drivers and state dependencies in the update at time t use only t-1 (or earlier for immigration) and never use *_dat at time t.

Parameter updates and justification
- Added parameters:
  - mA_dd (yr^-1 per ind m^-2): strength of density-dependent adult mortality. Ecological basis: increased disease/predation at high densities. Typical magnitude set conservatively to allow inference from data; bounded [0, 2].
  - beta_dd_sst (dimensionless): scales the density-dependent mortality with SST stress. Ecological basis: warmer, stressful conditions may increase disease transmission and mortality risk. Bounded [0, 3].
- Initial values:
  - mA_dd = 0.15 yr^-1 per ind m^-2 (conservative starter promoting identifiable DD without forcing immediate crashes).
  - beta_dd_sst = 1.0 (moderate modulation by stress).
- Notes on other parameters:
  - mA has literature bounds [0.39, 0.74] and remains as linear baseline mortality; with the new DD term, mA should not be inflated to force collapses. The quadratic term now contributes to sharp busts when A is large, improving interpretability of mA.
  - Carrying capacity scaling (kK_perc, kK0) and recruitment strength (rA) interplay with density-dependent mortality; the DD term reduces the need to overfit K or rA to induce busts.

Expected effect on fit
- Peak prediction should be curtailed more quickly, reducing positive residuals during decline phases (predicted > observed).
- Outbreak duration becomes more realistic without destabilizing low-density dynamics due to Allee effect preservation.
- Coral trajectories benefit indirectly if post-peak COTS densities fall faster, allowing earlier coral recovery where not limited by bleaching.

Implementation summary
- model.cpp: implemented the quadratic mortality with SST stress modulation in the adult COTS update; ensured only lagged inputs are used; retained differentiability with soft clipping.
- parameters.json: added mA_dd and beta_dd_sst with initial values and biologically motivated bounds.
- Next step after estimation: re-check residuals for any remaining systematic patterns (e.g., skewed peaks, timing lags), which might suggest refining recruitment SST response width or immigration lag structure.
