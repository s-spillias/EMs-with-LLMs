Assessment and targeted improvement for modeling COTS outbreak dynamics (boom–bust cycles)

1) Model fit to data (limitations due to missing residuals)
- I do not currently have the referenced residuals file. Without residuals and raw series, a quantitative fit assessment is not possible here.
- Request: please provide the residuals file to verify timing, magnitude, and duration errors in the current predictions for adults and both coral guilds.

2) Alignment with PROJECT CONTEXT
- Strengths already present:
  - Adult Allee effect (A_crit, k_allee) promotes outbreak thresholds.
  - Carrying capacity tied to coral cover (K_A = kK0 + kK_perc * weighted coral) allows feedback between prey availability and COTS.
  - Selective predation via multi-prey functional response with preferences and handling (q_fr, aF, aS, hF, hS, pref_F, pref_S).
  - SST modifiers on COTS net growth and coral bleaching/growth suppression.
  - External pulses through cotsimm_dat (immigration proxy).
- Gaps relative to outbreak dynamics:
  - Outbreak timing in COTS is strongly influenced by a recruitment lag (juveniles require ~1–3 years to reach detectable adult densities). The single-stage adult model adds recruits directly to adults; this tends to respond too quickly to forcing and under-represent the sharp onset and decay of outbreaks.
  - Nutrient/runoff-driven larval survival pulses (phytoplankton blooms) are not explicitly modeled (cotsimm_dat partially covers exogenous pulses but without a maturation delay).
  - No explicit predators/biocontrol or cannibalism; acceptable for now, but could matter for collapse phases.
  - Potential inconsistency in the SST growth response reference: parameter file fixes sst_ref ≈ 2 °C (anomaly), but code previously penalized it as if it were absolute SST (20–32 °C). This could distort the SST effect if anomalies are used.

3) Parameter review and structural implications
- sst_ref:
  - parameters.json indicates 2.0 with a tight range, which is appropriate for an anomaly, not absolute SST.
  - The code has been updated to treat sst_ref with soft bounds [0, 4] (anomaly scale), avoiding spurious penalties and preserving the literature-updated interpretation.
- Other parameters appear ecologically plausible and are already bounded by soft penalties in code. No additional structural changes follow from the updated coral parameters at this stage.

4) Chosen ecological improvement: add a juvenile stage (delayed density dependence)
Rationale:
- COTS outbreaks are characterized by strong recruitment pulses followed by a lag to adult abundance. A stage-structured representation with juveniles J and adults A provides a minimal, ecologically grounded mechanism to create delayed density dependence, sharpening outbreak timing and enabling boom–bust cycles without relying on current observations (no leakage).

Structural changes:
- Recruitment is produced by adults but now enters the juvenile pool:
  recruitJ_{t-1} = rA * f_SST_A_{t-1} * Phi_A_{t-1} * FEC_FEED_{t-1} * A_{t-1} / (1 + A_{t-1}/K_A_{t-1})
- Juveniles experience mortality and mature to adults:
  J_t = J_{t-1} + recruitJ_{t-1} - (gJ + mJ) * J_{t-1}
- Adults gain from juvenile maturation and immigration, and lose to adult mortality:
  A_t = A_{t-1} + gJ * J_{t-1} + gamma_I * cotsimm_{t-1} - mA * A_{t-1}
- All clips are smooth using softclip; no current time step data are used in process equations.

New parameters (added to parameters.json):
- mJ (yr^-1): juvenile mortality rate. Initial 0.6; bounds [0, 3].
- gJ (yr^-1): maturation rate to adults (mean delay ≈ 1/gJ years). Initial 0.5; bounds [0.05, 1.5].

Notes and future options:
- Immigration remains an adult addition (as in the original model). If cotsimm_dat is a larval supply proxy, a future refactor could redirect it to juveniles.
- If residuals reveal systematic early or late peaks in A, adjusting gJ (delay) and mJ (attenuation) should help.
- If residuals indicate mis-specified SST response magnitude or sign, consider tuning beta_sst_A or sst_scale_A now that sst_ref is treated as an anomaly.

5) Data integrity and leakage
- Only t-1 states and forcings are used to compute t predictions. Initial states use t=0 observations (standard practice to anchor the trajectory), and no current-step observations enter process equations.

6) What to check after refit (once residuals are available)
- Adult timing: Does the juvenile delay improve outbreak onset and decay alignment?
- Amplitude: Are peaks more realistic without requiring extreme rA or gamma_I?
- Coral trajectories: Are predation-driven declines temporally aligned with adult peaks?
- Parameter plausibility: Are inferred gJ and mJ within ecological expectations (gJ ~ 0.3–1.0 yr^-1; mJ moderate-to-high)?

Please provide the residuals file so I can comment quantitatively on fit improvement and remaining structure gaps.
