Purpose: Predict episodic boom–bust outbreaks of Crown-of-Thorns Starfish (COTS) on the Great Barrier Reef and their cascading impacts on coral communities, with explicit attention to outbreak timing, magnitude, and duration.

Core components and feedbacks:
- Adult COTS (individuals/m^2) interact dynamically with two coral guilds: fast-growing Acropora and slow-growing Faviidae/Porites (percent cover). COTS preferentially consume Acropora, but also consume slow-growing corals at lower rates.
- Coral dynamics follow logistic space-limited growth with background mortality and inter-guild competition for space (total cover capped by reef carrying capacity). COTS predation removes coral via a saturating functional response (generalized Holling II–III), converting predator pressure into fractional loss of coral cover.
- COTS population growth combines: (i) intrinsic adult growth with density dependence (Ricker form), (ii) positive food feedback via saturating dependence on coral cover (preference-weighted), and (iii) an outbreak gate that amplifies recruitment/survival during favorable environmental conditions.
- Outbreak trigger and sustainment: A smooth logistic “gate” integrates environmental suitability (Gaussian peak around an optimal SST) and external larval immigration pulses. This gate modulates the net growth of COTS and an additive recruitment term, allowing rapid takeoff when conditions align, then bust via density dependence, prey depletion, and reduced gate signal.
- Resource limitation and selectivity: Coral growth is space-limited; predation uses saturating/accelerating functional responses with handling time and exponent q (q=1 ⇒ type II; q>1 ⇒ type III). Conversion efficiency translates per-predator attack rates into realized fractional coral loss.
- Indirect effects: Preferential removal of Acropora reduces food feedback to COTS and releases space that can be occupied by slow-growing corals, altering subsequent predation pressure and outbreak persistence.

Numerical robustness:
- All divisions include small eps constants; all transitions are smooth (logistic gates, exponential saturations) without hard cutoffs.
- Parameters are kept within biologically meaningful ranges using smooth penalties rather than hard constraints.
- Observation models use lognormal (COTS) and logit-normal (corals) errors with minimum variance floors to avoid numerical issues.

Outputs:
- Predicted time series of adults and coral covers matched to observed series (cots_dat_pred, fast_dat_pred, slow_dat_pred), preserving chronological causality (each step uses only the previous state and exogenous covariates).
