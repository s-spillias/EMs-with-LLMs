MODEL ASSESSMENT AND IMPROVEMENT PLAN
=====================================

CURRENT MODEL EVALUATION:
-------------------------
The model includes age-structured COTS dynamics with juveniles and adults, coral refuge effects on juvenile survival, temperature and nutrient effects on recruitment, and Type II functional responses for feeding. However, analysis reveals several issues:

1. MISSING DATA: The nutrient_dat vector is defined but not being loaded with actual data, defaulting to 1.0 throughout. This disables the sophisticated nutrient outbreak mechanisms that were designed to trigger population explosions.

2. INCOMPLETE CORAL-COTS FEEDBACK: While coral affects COTS through refuge (juvenile mortality) and carrying capacity, there's a missing critical link: coral availability should directly affect adult fecundity. Well-fed adults on coral-rich reefs produce more viable offspring.

3. NO NUTRITIONAL QUALITY EFFECT: Fast-growing Acropora provides superior nutrition compared to slow-growing Porites/Faviidae, but this only affects consumption rates, not reproductive output.

ECOLOGICAL JUSTIFICATION FOR IMPROVEMENT:
-----------------------------------------
Crown-of-Thorns starfish are income breeders - their reproductive output is directly tied to current nutritional status. Studies show:

- Adult fecundity ranges from 12-24 million eggs depending on food availability
- Coral-fed adults have 2-3x higher gonadal indices than starved individuals  
- Fast-growing Acropora provides higher quality nutrition (protein, lipids) than massive Porites
- Outbreak initiation requires not just larval survival but high adult fecundity

The current model has reproduction (r_cots) as a fixed parameter, but ecologically it should be a STATE-DEPENDENT process that varies with coral availability and quality.

PROPOSED IMPROVEMENT: Coral-Dependent Fecundity Modifier
---------------------------------------------------------

Add a multiplicative modifier to adult reproduction that scales with:
1. Total coral availability (Michaelis-Menten saturation)
2. Coral quality (weighted by fast vs slow coral composition)

Mathematical form:
fecundity_modifier = fecundity_min + (1 - fecundity_min) * 
                     [(w_fast * fast + w_slow * slow) / (K_fecundity + w_fast * fast + w_slow * slow)]

Where:
- fecundity_min: minimum fecundity at zero coral (0.1-0.3, representing starvation reproduction)
- K_fecundity: half-saturation coral cover for fecundity (10-30%)
- w_fast: nutritional weight for fast coral (1.0, reference)
- w_slow: nutritional weight for slow coral (0.3-0.7, lower quality)

This creates:
- POSITIVE FEEDBACK during outbreak initiation: more coral → higher fecundity → more larvae → faster population growth
- NEGATIVE FEEDBACK during outbreak peak: depleted coral → reduced fecundity → population crash
- SELECTIVE PRESSURE: preferential consumption of high-quality Acropora reduces future fecundity more than consuming Porites

EXPECTED DYNAMICS:
------------------
1. Pre-outbreak: Low COTS, high coral → moderate fecundity, stable population
2. Outbreak initiation: Immigration pulse + high coral → maximum fecundity → exponential growth
3. Outbreak peak: High COTS rapidly consume Acropora → fecundity begins declining
4. Outbreak collapse: Depleted coral → minimum fecundity → population crash despite remaining adults
5. Recovery: Coral regrows → fecundity gradually increases → cycle can repeat

This mechanism provides a more realistic explanation for the characteristic boom-bust cycles and why outbreaks self-terminate even when adults remain present.

PARAMETERS ADDED:
-----------------
1. log_fecundity_min: Log minimum fecundity modifier at zero coral (dimensionless, 0.1-0.3)
2. log_K_fecundity: Log half-saturation coral cover for fecundity effect (%, 10-30)  
3. slow_coral_quality: Nutritional quality of slow coral relative to fast coral (dimensionless, 0.3-0.7)

These parameters are ecologically interpretable and have clear bounds based on empirical observations of COTS reproductive biology.
