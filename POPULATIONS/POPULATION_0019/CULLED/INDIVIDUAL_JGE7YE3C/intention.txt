NPZ Model: Nutrient-Phytoplankton-Zooplankton Dynamics in the Oceanic Mixed Layer

This model simulates the coupled dynamics of nutrients, phytoplankton, and zooplankton in a marine ecosystem. The ecological functioning is based on the following principles:

1. NUTRIENT UPTAKE: Phytoplankton take up dissolved nutrients (N) for growth using a Michaelis-Menten (Monod) saturating function, representing limitation at low nutrient concentrations and saturation at high concentrations.

2. PHYTOPLANKTON GROWTH: Phytoplankton (P) grow by converting nutrients into biomass with a maximum growth rate modified by nutrient availability. A fraction of this growth is lost to respiration and natural mortality.

3. GRAZING: Zooplankton (Z) consume phytoplankton using a Holling Type II functional response (saturating with prey density), representing handling time limitations at high phytoplankton densities.

4. ZOOPLANKTON DYNAMICS: Zooplankton grow through assimilation of consumed phytoplankton (with conversion efficiency less than 1 due to metabolic costs) and experience natural mortality.

5. NUTRIENT RECYCLING: Nutrients are recycled back into the system through phytoplankton mortality, zooplankton mortality, and zooplankton excretion (inefficient assimilation), creating a closed nutrient loop.

6. MASS BALANCE: The model conserves total nitrogen (N + P + Z remains approximately constant when accounting for all flows), representing a closed system in the mixed layer.

The model captures key ecological phenomena including:
- Bottom-up control (nutrient limitation of phytoplankton)
- Top-down control (grazing pressure on phytoplankton)
- Trophic cascades and feedback loops
- Potential for oscillatory dynamics and predator-prey cycles
- Nutrient regeneration maintaining ecosystem productivity
