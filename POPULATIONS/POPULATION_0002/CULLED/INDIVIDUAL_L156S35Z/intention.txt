Assessment and model fit:
- Residuals: A detailed residuals file was not provided here, so a quantitative residual analysis cannot be performed. Based on the current structure, the COTS component can produce smooth growth/decline but is likely to mis-time outbreak onset and peak magnitudes because recruitment from coral consumption is added as a constant term independent of adult stock size. This tends to:
  - Trigger or sustain outbreaks even when adult density is low (unrealistic, because larval production depends on adult spawners).
  - Under-represent boom-bust amplitude and timing sensitivity to food availability pulses.

- Coral submodel: Uses logistic regrowth, background and bleaching mortality, and predation linked to a Type-III response in COTS. This captures selective predation and thermal mortality reasonably. Soft penalties discourage >100% cover without hard truncation.

- COTS submodel (before change): Adult dynamics combined (i) a logistic-like per-capita growth term modulated by temperature and food and (ii) an additive recruitment-from-consumption term not scaled by adult stock. Immigration is added linearly. This can partially capture outbreaks but lacks a stock-recruitment mechanism known to be critical for episodic pulses.

Project-context alignment:
- Strengths: Includes selective predation on fast vs slow corals; thermal effects on corals and on COTS reproduction; Type-III predation response; food-limited carrying capacity for COTS.
- Gaps: Outbreak triggering and collapse are typically governed by (a) stock-dependent larval production/survival with strong nonlinearity and (b) compensatory density dependence in recruitment. The existing additive recruitment breaks the stock-recruitment link and can decouple outbreaks from adult abundance and transient food/temperature pulses.

Key oversimplifications:
- Recruitment lacked dependence on adult spawner biomass (C_prev), and had no compensatory density dependence (Beverton-Holt/Ricker).
- The food effect on recruitment was linear/saturating but not sufficiently nonlinear to produce outbreak pulses under favorable conditions.
- Immigration survival is present but may dominate dynamics when stock-recruitment is weak.

Chosen ecological improvement (one change):
- Introduce stock-dependent, environment-modulated recruitment with compensatory density dependence (Ricker form) and a nonlinear food effect.
  - Rationale: COTS outbreaks are driven by pulses in larval survival/settlement tied to adult spawner abundance, food availability, and environmental conditions. A Ricker stock-recruitment term produces unimodal recruitment vs. stock (boom-bust), while a food nonlinearity amplifies pulses when Acropora/massive coral cover is high.
  - Mathematical representation (implemented):
      R_food,pot,t = (gamma_A * pred_A,t + gamma_S * pred_S,t) * C_{t-1}
      R_food,t = R_food,pot,t * TPC_t * (Food_t + eps)^{theta_food} * exp(-beta_SR * C_{t-1})
    Recruits (R_food,t) are then added to the adult dynamic alongside immigration. This preserves the original adult logistic-like term (with Allee and carrying capacity) but corrects the recruitment mechanism to be stock-dependent and pulsed by environment and prey composition.

Parameters added:
- beta_SR (1/(indiv m^-2)): Strength of compensatory density dependence in stock-recruitment (Ricker). Suggest bounds [0, 10].
- theta_food (dimensionless): Exponent controlling nonlinearity of food effect on recruitment (>=0.5 to allow mild concavity; initial 2.0 to allow amplification). Suggest bounds [0.5, 5].

Updated parameter semantics:
- gamma_A and gamma_S now provide base conversion from consumption fractions to recruit potential and are scaled by adult stock (C_prev), temperature (TPC), food nonlinearity, and Ricker density dependence.

Ecological justification:
- Stock-recruitment is fundamental in broadcast-spawning echinoderms; larvae produced and surviving to settlement depend on spawner density and environmental conditions. The Ricker structure captures overcompensation and collapse at high densities (boom-bust).
- Food availability influences adult condition and fecundity; a nonlinear effect (theta_food > 1) reflects threshold-like increases in reproductive output/success when Acropora cover is abundant, consistent with observed outbreak pulses.
- Retaining the original adult density regulation and Allee effects preserves low-density limitations and upper-bounds via carrying capacity linked to prey.

Data usage safeguards:
- All prediction updates use only previous time step states (t-1) and exogenous drivers; no current-time observed values are used in process equations.

Next steps (if residuals available):
- Inspect residuals for outbreak timing mismatches or peak under/over-shoots. If peaks remain too muted, increase theta_food or reduce beta_SR; if peaks are too frequent or sustained, increase beta_SR or reduce gamma_A/gamma_S. Consider including external nutrient proxies in future versions for larval survival pulses if data permit.
