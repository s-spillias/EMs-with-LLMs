Assessment and rationale for change

1) Fit to data
- A quantitative residual analysis was requested, but a residuals file was not provided in this chat. Please add it so we can confirm specific misfit patterns (timing of outbreak onset, peak magnitude, and decay).
- Based on structure alone, the model should reproduce boom-bust cycles via (i) resource-limited recruitment, (ii) temperature-triggered recruitment (logistic), (iii) predation on corals feeding back to food availability, and (iv) density-dependent mortality that can end outbreaks. However, it likely overpredicts recruitment at very low adult densities, enabling outbreaks to start too easily from small populations.

2) Alignment with project context
- The project aims to capture episodic outbreaks with realistic timing, magnitude, and duration. A known mechanism in broadcast-spawning echinoderms (including COTS) is a mate-finding Allee effect on fertilization success at low adult densities. This mechanism delays or prevents outbreaks until a density threshold is exceeded, sharpening outbreak onset and improving realism for episodic dynamics.
- Current recruitment is proportional to adult density at low C (linear term), which conflicts with the expected sublinear/threshold behavior for fertilization at low density.

3) Potentially missing or oversimplified ecological processes
- Missing: Allee effect in local reproduction (fertilization success rises with adult density).
- Already included and adequate for now: temperature-modified larval survival (fTrec), resource limitation via edible coral (sR), density-dependent mortality (m_dd_max), feeding thermal performance (Topt_feed), and coral competition for space (free_space).

Parameter review
- Topt_feed is updated from literature and effectively fixed near 30°C. This does not require structural change; the Gaussian feeding response remains appropriate.
- No other parameters are flagged as updated-from-literature in a way that necessitates structural overhaul.
- Key addition needed to reflect biology: a fertilization success parameter that controls the strength of the Allee effect.

Chosen improvement: Allee effect in local recruitment
- Ecological justification: Broadcast spawning requires proximity for gamete encounter; fertilization success increases nonlinearly with adult density. This adds a natural threshold that delays outbreaks until enough adults are present, while still allowing explosive growth when temperature and immigration also align.
- Mathematical form: f_allee(C) = C / (C + C_Alee), 0–1, smooth and unit-consistent (ind/m^2). This makes local recruitment strongly sublinear at low C (approximately proportional to C^2/C_Alee near 0) but approaches 1 at high densities.
- Modified local recruitment:
  C_recruit_local = r_max * C * sR * fTrec / (1 + alpha_C * C) * f_allee(C)
  Total recruitment adds exogenous immigration: C_recruit = C_recruit_local + eta_I * I
- Data usage: Transition at time t uses only states and drivers from t-1 (no leakage). The implementation respects this constraint.

New parameter
- Name: C_Alee
- Units: ind/m^2
- Interpretation: Adult density at which fertilization success reaches 50% of its maximum (Allee half-saturation).
- Suggested bounds: [0.0, 5.0] ind/m^2. Rationale: Covers low to moderate densities typical of pre-outbreak to outbreak-onset ranges; wide enough for estimation while guarding against implausible extremes.
- Priority: 1 (critical for outbreak triggering).

Expected effects on dynamics
- Delays outbreak onset at low adult densities, improving timing.
- Requires alignment of favorable temperature, sufficient adults, and immigration pulses for large recruitment, improving realism for episodic outbreaks.
- Preserves bust dynamics via density-dependent mortality and food depletion.

Next steps once residuals are available
- Examine early-phase residuals for COTS density: systematic positive residuals would suggest outbreak onset too early without Allee effect (this change should reduce them).
- Check peak height and tail decay residuals; tune m_dd_max and C_Alee jointly if peaks are too high or decay is too slow/fast.
- Consider making eta_I interact multiplicatively with fTrec if residuals show recruitment pulses only under warm conditions (optional future extension).

Implementation summary
- parameters.json: added C_Alee with description, units, and bounds.
- model.cpp: added PARAMETER(C_Alee), penalty, multiplied local recruitment by f_allee in both the initialization diagnostics and the dynamic loop, updated equation documentation.
