Assessment and rationale

1) Fit to data (residuals)
- The residuals file was not provided in this context, so the assessment below focuses on structural adequacy and typical COTS dynamics. Please share residuals to verify specific misfits (timing of peaks, magnitude, duration, and decay rates).

2) Alignment with project context
- The previous model included: temperature-modulated larval survival, food-dependent reproduction (via coral cover and preference), adult food-limited mortality, and a single-year maturation from larvae to adults.
- COTS outbreaks are known to be episodic with 2–3 year times to maturity. A single-year maturation tends to produce too-rapid recruiting feedback and can smear peaks, limiting the model’s ability to create sharp outbreak onsets and lagged collapses after coral depletion.
- Predation on corals used a flexible Type-II/III functional response (q_pred), and coral growth/bleaching processes were already represented.

3) Potential missing or oversimplified processes
- Maturation delay/stage structure: Previously missing. Ecologically, COTS juveniles spend 1–3 years before contributing to adult outbreaks. Without this delay, the system can under-represent lagged amplification, a key ingredient for episodic booms.
- Runoff/nutrient pulses: Important for larval survival, but no exogenous data stream is available here beyond SST and immigration. We preserve a generic immigration term to absorb such effects statistically.
- Spatial source-sink dynamics: Not represented, but partially captured by the immigration forcing term.
- Coral rubble/recovery lags: Potentially important but would add significant state complexity; deferred.

4) Parameter review and implications for structure
- logit_mu_adult was previously interpreted as “fraction of larvae maturing to adults in one year”. With empirical maturity at ~2–3 years, the nominal value (logit -1.386 ≈ 0.2) is more consistent with an annual maturation rate out of a juvenile pool, not direct larva-to-adult recruitment.
- This suggests the equation structure should include an explicit juvenile state to maintain ecological realism and timing of outbreaks.

Chosen improvement: Explicit juvenile stage (J) with maturation delay

Ecological justification
- Adds a minimal stage structure necessary to generate lagged positive feedback from large adult cohorts to future adult numbers, helping produce sharp, episodic booms and subsequent busts via food limitation.
- Keeps the model parsimonious: one new state (juveniles) and one new parameter (baseline juvenile mortality).

Mathematical changes
- Define juvenile survival sJ = exp(-mJ), with mJ = exp(log_mJ).
- Reinterpret mu_adult as fraction of surviving juveniles that mature each year.
- Recruitment/transition equations:
    L_t = phi * C_t * Food_t * EnvLarv_t * exp(-beta * C_t) * A_gate_t + k_imm * cotsimm_dat(t)
    J_{t+1} = (1 - mu_adult) * sJ * J_t + L_t
    C_{t+1} = sA_t * C_t + mu_adult * sJ * J_t
  where sA_t = exp(-(mA + mA_food * (1 - Food_t))).
- Initialization: J_0 set from L_0 computed using t=0 predicted states and forcings (no inter-temporal data leakage).

Expected effects on dynamics
- Introduces a realistic lag (1–3 years) between reproductive pulses and adult outbreaks, enabling sharper outbreak onsets.
- After coral is depleted, adult numbers crash via higher food-driven mortality while juvenile inflow declines, lengthening the bust phase.
- Helps prevent unrealistically immediate rebounds.

Parameter updates
- Added parameter:
    - log_mJ (log(year^-1)): baseline juvenile mortality; new bounds suggested [0.05, 3.0] on mJ (soft-penalized).
- Updated parameter description:
    - logit_mu_adult now explicitly refers to the annual fraction of surviving juveniles that mature.

Notes on data usage and model integrity
- The prediction step never uses current-year observations of response variables (cots_dat, fast_dat, slow_dat) beyond initializing t=0 states; all dynamics use predicted states from previous steps and external forcings only.
- Observation models and sd floors unchanged; juvenile state is latent and not directly observed.
- Existing predation, coral growth, bleaching, and preference structures retained for stability and interpretability.

Next steps
- Please provide the residuals so we can evaluate improvements in timing/magnitude/duration fits, inspect systematic biases (e.g., early peak timing, decay tails), and consider additional targeted refinements (e.g., nutrient/runoff proxy, juvenile temperature sensitivity, or rubble/recovery lags) if warranted by residual patterns.
