Assessment and rationale for improvement

1) Model fit (requires residuals)
- The residuals file was not provided in this chat, so I cannot quantitatively evaluate the fit or identify temporal patterns (autocorrelation, bias around outbreaks, or misfit during busts).
- Please provide the residuals to complete the fit assessment. Specifically, I will check:
  - Whether COTS residuals show positive runs leading into outbreaks (under-prediction of surge) or negative runs during busts (over-prediction of persistence).
  - Whether coral residuals show lagged responses consistent with selective predation (Acropora leading declines, slow corals declining later and recovering slower).
  - Heteroskedasticity during outbreak years that might suggest process noise beyond observation error.

2) Alignment with project context
- The current structure includes:
  - Temperature-triggered enhancement of larval survival (logistic around T_thr) and temperature-modulated feeding/growth.
  - Resource limitation via edible coral index R = q_A*A + q_S*S affecting COTS mortality (m_food term) and reproduction.
  - Density-dependent mortality m_dd_max with logistic onset to terminate outbreaks.
  - Exogenous larval supply I scaled by eta_I.
  - Selective predation on corals (Holling II; Acropora > slow-growing).
  - Shared space limitation for corals.
- These mechanisms are appropriate to produce boom-bust cycles and selective coral impacts. However, one important ecological process is oversimplified/absent: positive density dependence (Allee effect) in fertilization success for local reproduction.

3) Key missing or oversimplified processes
- Allee effect in local reproduction: COTS are broadcast spawners; fertilization probability increases with adult density. Without this, local recruitment at very low adult densities may be unrealistically high, weakening outbreak thresholds and potentially smearing timing/magnitude of booms.
- Stage structure and maturation lags (not implemented here) could further sharpen dynamics but add substantial complexity.
- Predator control/biocontrol is aggregated into m_dd_max; explicit predator dynamics are not modeled, which is acceptable at this stage.
- Topt_feed is fixed at ~30°C (per parameters), which can be reasonable; we will keep it fixed unless residuals indicate systematic feeding-rate misfit versus temperature.

Chosen improvement
- Add a fertilization efficiency (Allee) term to local recruitment:
  - f_fert(C) = invlogit(k_fert * (C - C_fert_mid)), 0–1
  - Interpretation: At low densities C << C_fert_mid, fertilization is poor (low f_fert), suppressing local recruitment. As C surpasses C_fert_mid, efficiency rapidly rises, enabling outbreak onset when combined with warm temperatures and ample resources.
  - This is multiplied into the existing local recruitment term:
    C_recruit_local = r_max * C * sR * fTrec * f_fert(C) / (1 + alpha_C * C)
  - Immigration remains additive (eta_I * I), preserving the role of exogenous larval supply in seeding outbreaks when locals are rare.

Expected benefits
- Introduces a biologically realistic threshold that stabilizes low-density states (reduces spurious persistence), yet allows rapid transitions into outbreaks when density, temperature, and resources align.
- Helps reproduce sharper onset and magnitude of booms without excessive parameter tuning of r_max or m_dd_max.
- Maintains simplicity and parameter identifiability relative to adding full life-stage structure.

Notes
- No data leakage is introduced: all dynamic drivers continue to use the previous time step’s state and exogenous inputs.
- Please provide residuals to verify that this change reduces low-density over-prediction of local recruitment and improves outbreak timing.

