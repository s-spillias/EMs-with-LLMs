Assessment

1) Model fit to data
- Residuals not provided in this chat, so this assessment is based on the model structure and typical dynamics expected for COTS. The current state-space model is internally consistent and avoids data leakage by using previous-step predictions as states.
- The likelihood uses lognormal for COTS and logit-normal for coral cover with sd floors. This is appropriate for skewed abundance and bounded cover data.

2) Alignment with project context (episodic outbreaks)
- The present model has only a one-step pipeline from larvae to adults (L_t adds directly to adults via mu_adult at t+1). This produces relatively fast responses but can struggle to generate the punctuated, multi-year boom-bust cycles characteristic of COTS outbreaks.
- Outbreak triggers and sustainment in the literature often involve:
  - A cryptic juvenile pool that persists during low-coral periods (feeding on algae) and then rapidly matures when coral cover rebounds, creating sudden adult outbreaks.
  - Environmental pulses that increase larval survival (e.g., nutrients/flood plumes), and predator control. The model already allows exogenous immigration (cotsimm_dat) and temperature effects but lacks the juvenile pool.

3) Missing or oversimplified processes
- Cryptic juvenile stage: Missing. Important for delayed density dependence and outbreak timing.
- Maturation depends on coral availability: Oversimplified; currently maturation is a single fraction (mu_adult) that does not depend on food explicitly.
- Predator control and nutrient pulses: Not included as state or forcing (beyond sst and cotsimm_dat). These could be considered later but require additional data.

Parameter review highlights
- Topt_larv bounds are updated from literature and look reasonable (26–30 °C). No structural conflict.
- q_pred already allows Type-II/III predation on corals (via log_q_pred).
- log_K_tot and log_min_sd are modeled as parameters, which is fine and handled with soft penalties.

Chosen improvement

Add a cryptic juvenile compartment with food-dependent maturation:
- Introduce J_t (juvenile density). Adults produce larvae L_t that enter J_{t+1}. Juveniles survive at rate sJ = exp(-mJ) and mature to adults at C_{t+1} += mu_JA(Food_t) * J_t, where mu_JA(Food) = mu_JA_max * Food_t.
- This creates at least a two-year lag from larvae to adults (t → t+1 to J, then potentially to adults at t+2), enabling stored recruitment that is released when coral (food) is abundant—producing sharper outbreaks followed by busts as corals are consumed.
- No changes to observation model; uses only past predicted states and forcings, avoiding data leakage.

Ecological justification
- Juveniles are cryptic and can persist under low coral cover (feeding on algae), then mature rapidly when coral increases, a mechanism repeatedly implicated in GBR COTS outbreaks. A food-dependent maturation gate captures this nonlinearity without requiring new external data.

Notes
- We deprecate logit_mu_adult (old direct larvae→adult fraction) and replace it with logit_mu_JA_max (max juvenile→adult maturation). The old parameter is retained in parameters.json for continuity but is not used in the dynamics.
- Initial juvenile density is set to 0 for parsimony (can be extended with an initial-state parameter later if needed).

Future extensions (not implemented here)
- Explicit nutrient/runoff modifier to larval survival using a chlorophyll/runoff forcing.
- Predator-mediated adult mortality.
- Multi-compartment juvenile delay (Erlang) if stronger smoothing of the delay distribution is needed.

