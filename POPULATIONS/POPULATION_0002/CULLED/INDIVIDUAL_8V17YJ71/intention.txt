Assessment of current model (fit, context alignment, missing processes)

Note on residuals:
- A residuals file was referenced, but it is not available in the provided files. The following assessment is based on model structure and parameterization. If you can share the residuals, I will refine the diagnostics (timing/magnitude/duration biases, autocorrelation, and scale-specific misfit).

1) Model fit (structural expectations without residuals)
- COTS outbreaks: The model contains key elements to produce boom-bust cycles: (a) a larval pulse mechanism driven by positive SST anomalies (Pulse), (b) density-dependent reproduction (Ricker term exp(-beta*C)), (c) food-dependent adult survival (Food), and (d) strong predation on corals reducing habitat/food over time. This should enable rapid increases followed by busts driven by food limitation and density dependence.
- Coral dynamics: Two functional groups with logistic growth, temperature-modulated growth, bleaching mortality, and COTS predation using a saturating functional response. This can reproduce Acropora (fast) vs massive (slow) coral trajectories and recovery patterns.
- Observation models: Lognormal for COTS and logit-normal for coral cover are appropriate and should yield stable inference with sd floors.

Potential fit issues inferred from parameters and structure:
- log_r_fast is effectively fixed at ~0.05 year^-1 (value and bounds nearly identical) and is also less than the slow coral intrinsic rate (exp(-1.897) ≈ 0.15 year^-1). This contradicts ecological expectation that Acropora grows/recruits faster than slow coral. This will bias Acropora recovery low and can degrade fit to coral time series and indirectly to COTS (through Food).
- Adult COTS mortality is only food-dependent and baseline; it lacks environmental modulation. Outbreak busts often coincide with thermal stress years when coral cover is already depressed. Without temperature-dependent adult mortality, the model may miss the sharp post-peak decline in adults, delaying busts.

2) Alignment with PROJECT CONTEXT
- The model captures many core mechanisms: selective predation, environmental modulation of recruitment via SST anomaly pulses, logistic coral growth with bleaching, and a maturation delay. This framework is capable of generating episodic outbreaks and subsequent declines.
- However, a key trigger/suppressor in the literature is temperature-related physiological stress affecting adult survival. Incorporating temperature-modulated adult mortality adds an environmental “off-switch” that helps match the timing and sharpness of outbreak collapses, improving alignment with the project objective to capture timing, magnitude, and duration.

3) Missing or oversimplified processes
- Adult temperature stress mortality: Missing. This can strongly shape the duration and termination of outbreaks.
- Potential overconstraint of fast coral growth: log_r_fast is fixed too low and below slow coral’s rate; this is ecologically inconsistent and restricts the model’s ability to match fast coral recovery and its role in fueling outbreaks.
- Initial coral fractions are independently parameterized; their sum can exceed K_tot (soft-penalized indirectly via crowding). This is acceptable but could be strengthened in a later revision if needed.
- Predator interference, multi-year larval storage, and nutrient-runoff-driven plankton blooms (river discharge) are not represented; they are plausible but add complexity and/or require new data inputs. Given parsimony and current data, they are deferred.

Chosen ONE ecological improvement: Temperature-modulated adult COTS mortality
Rationale:
- Ecological realism: High SSTs can elevate metabolic costs and reduce condition; combined with reduced food, this accelerates adult mortality and sharpens the bust phase.
- Data availability: Uses the existing sst_dat forcing; no new data streams required.
- Parity with coral bleaching: Coral already has a temperature gate for bleaching mortality; mirroring this for COTS adult mortality makes the model symmetric with respect to thermal stress.
- Minimal complexity, strong leverage on outbreak timing: Adds a smooth logistic temperature gate to adult mortality, controlled by threshold and width, with a maximum additional mortality scaling.

Mathematical implementation:
- Replace adult survival with:
  sA_t = exp(-(mA + mA_food * (1 - Food_t) + M_temp(T_t)))
  where M_temp(T) = mA_temp * invlogit((T - T_mA) / tau_mA)
- New parameters:
  - log_mA_temp: log of maximum additional temperature-driven adult mortality (>=0)
  - T_mA: SST threshold where adult temperature stress mortality inflects (°C)
  - log_tau_mA: log smoothness (°C) around threshold
- All transitions continue to use only previous-step states and forcing (no data leakage).

Parameter review and updates:
- log_r_fast: Relax bounds and raise the initial value to reflect faster Acropora growth than slow coral (e.g., exp(-1.204) ≈ 0.3 year^-1). This improves ecological realism and model flexibility.
- Added soft biological bounds in the code for new parameters; JSON lower/upper bounds proposed to guide estimation.

Expected effects on dynamics:
- Outbreak timing: Retained via larval pulses; adult mortality now responds to warm years, improving collapse timing after peaks.
- Outbreak magnitude/duration: When food declines and SST is high, adults die faster, producing shorter, sharper busts—consistent with observed boom-bust cycles.
- Coral trajectories: With more realistic fast coral growth bounds, Acropora can recover faster after disturbances, restoring food supply and enabling subsequent outbreaks when conditions align.

Next steps with residuals (once available):
- Check signs of temporal autocorrelation in COTS residuals around peaks; adjust tau_mA and T_mA if collapses are too slow/fast.
- Inspect bias in fast coral residuals; if recovery underpredicted, further adjust log_r_fast bounds or consider mild recruitment pulses tied to SST within the existing growth framework (only if needed).
