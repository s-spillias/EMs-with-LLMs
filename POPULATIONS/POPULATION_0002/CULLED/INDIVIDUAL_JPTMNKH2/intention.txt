Assessment and rationale for model update

Scope and data fit
- Quantitative fit: A residuals file was referenced but is not available in this context. Without residuals we cannot quantify bias or dispersion. Please provide the residuals to validate these qualitative assessments.
- Qualitative fit expectations given structure:
  - COTS: The current formulation can create growth phases (favorable SST, high food) followed by declines (food-dependent survival and coral depletion). However, the exp(-beta * C_t) term places density dependence on adult density rather than on the larval cohort. This tends to smear outbreak peaks and can under-represent sharp boom-bust pulses driven by episodic high larval survival.
  - Corals: Logistic growth with a shared carrying capacity and temperature-modified growth is ecologically sound. Predation is saturating and capped by availability, which avoids numerical artifacts. Bleaching mortality responds to SST.
- Common misfits for COTS boom-bust systems (from similar models): Right-skewed positive residuals during outbreak onset (peaks underpredicted), temporal phase mismatch (peaks shifted), and over-persistence after peaks (declines too slow). These patterns often arise when the model lacks strong larval-stage density dependence or fails to localize density dependence to the larval phase.

Relevance to the project context
- The project emphasizes episodic outbreaks and their timing, magnitude, and duration. Outbreak pulses in Acanthaster are strongly mediated by larval-stage processes (e.g., food pulses, cannibalism) more than by direct adult density alone.
- The current model already includes: temperature-modified larval survival, food limitation via coral cover, Allee-like reproduction gate, food-dependent adult survival, and saturating predation on corals. These are appropriate.
- Gap identified: Density dependence is applied as exp(-beta * C_t), i.e., a function of adult density rather than the larval cohort produced in that year. Empirically, larval-stage density dependence (including cannibalism) is strong and can be overcompensatory.

Key ecological processes potentially missing or oversimplified
- Larval-stage density dependence: Currently tied to C_t instead of larval output. This may impede the modelâ€™s ability to generate sharp, episodic peaks and to self-limit excessively large pulses.
- Environmental pulse drivers beyond SST (e.g., runoff/chl-a): Not included due to lack of forcing inputs in this code base; immigration cotsimm_dat partially fills this role but may not reflect nutrient pulses explicitly.
- Stage structure: A one-year maturation lag is included, but no explicit juvenile state. This is acceptable for parsimony, though some systems benefit from an explicit juvenile/cryptic stage.

Chosen improvement: Move density dependence to the larval cohort (Ricker on larvae)
- Mathematical change:
  - Before: L_t = phi * C_t * Food_t * EnvLarv_t * A_gate_t * exp(-beta * C_t) + k_imm * cotsimm_dat(t)
  - After (implemented): 
    L_raw_t = phi * C_t * Food_t * EnvLarv_t * A_gate_t + k_imm * cotsimm_dat(t)
    L_t     = L_raw_t * exp(-beta * L_raw_t)
- Ecological justification:
  - Larval cannibalism and crowding mortality act on larvae, not on adults. Applying density dependence to L_raw provides (i) stronger outbreak pulses when larval output is modest and conditions favorable (limited density-dependent suppression), and (ii) sharper self-limitation when larval densities are extreme (overcompensation), which can improve boom-bust realism.
  - This modification preserves all existing environmental and food modifiers and does not introduce new state variables or data requirements.
- Expected effects on fit and dynamics:
  - Outbreak onset: More responsive to favorable conditions, allowing larger peaks when L_raw is high but not extreme.
  - Peak magnitude control: Prevents unrealistically large spikes by increasing marginal mortality at high L_raw.
  - Post-peak decline: Sharper declines possible without needing unrealistically high adult mortality, potentially improving timing and duration of outbreaks.

Parameter review and updates
- log_beta is retained but reinterpreted: It now represents larval-stage density dependence (units per larval equivalent m^-2), i.e., the slope of density-dependent mortality acting on L_raw (Ricker survivorship exp(-beta * L_raw)). Description and units have been updated in parameters.json.
- Other parameters remain structurally appropriate with their present bounds:
  - Growth, mortality, bleaching, predation saturation, food preference, maturation, and observation error retain their forms and plausible bounds.
  - No new parameters were added, keeping model complexity minimal while improving ecological realism where it matters most for episodic outbreaks.

Notes and next steps
- Please share the residuals to verify whether the updated larval density dependence reduces peak underprediction and corrects phase shifts.
- If residuals still show outbreak timing biases, consider adding an external nutrient/runoff pulse forcing (e.g., chl-a or river discharge) to EnvLarv_t or phi via a saturating function, if such data are available.
