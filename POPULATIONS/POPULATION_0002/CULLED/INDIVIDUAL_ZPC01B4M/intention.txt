Objective
Model episodic Crown-of-thorns starfish (COTS; Acanthaster cf. solaris) outbreaks on the Great Barrier Reef, emphasizing timing, magnitude, and duration of booms and subsequent busts, while jointly predicting the dynamics of two coral functional groups: fast-growing Acropora (fast_dat) and slow-growing massive corals (Faviidae/Porites; slow_dat).

State variables
- cots_dat: Adult COTS density (individuals per m^2).
- fast_dat: Acropora cover (% of reef area).
- slow_dat: Faviidae/Porites cover (% of reef area).

External drivers
- sst_dat: Sea surface temperature (°C), modulating COTS reproduction (thermal performance curve) and coral bleaching (soft threshold).
- cotsimm_dat: Larval immigration (individuals·m^-2·year^-1), supplying episodic recruits.

Core ecological mechanisms
1) Resource-limited COTS population growth with Allee effects and outbreak nonlinearity:
   - Per-capita COTS growth follows a Ricker-like form with a thermally modulated intrinsic rate, an Allee term, and resource limitation via a saturating function of edible coral cover.
   - Carrying capacity scales with available coral (saturating with total palatable cover), creating a positive feedback that enables rapid booms when coral is abundant and collapses (busts) after overconsumption.

2) Selective predation on corals with Type-III functional response:
   - Predation intensity is sigmoidal with respect to COTS density (weak at low density, strengthens rapidly during outbreaks), with higher preference/attack for Acropora than massive corals.
   - Predation reduces coral cover and thus future resource supply, driving busts.

3) Coral demography with logistic regrowth and climate stress:
   - Both coral groups regrow logistically toward a maximum joint carrying capacity (K_tot), with background mortality.
   - SST above a soft threshold increases additional mortality (bleaching), more strongly for fast-growing Acropora.

4) Outbreak triggers and sustainment:
   - Immigration pulses and favorable temperature windows amplify recruitment.
   - High coral availability increases both COTS recruitment (via consumption-derived conversion) and effective carrying capacity, sustaining high densities.
   - Overconsumption depletes coral, reducing COTS resource supply and increasing starvation mortality, precipitating declines.

Numerical design
- Smooth saturating and sigmoidal functions prevent discontinuities (no hard thresholds).
- Small constants avoid division-by-zero; positive state constraints are enforced with smooth mappings and penalties, not hard truncation.
- Initial conditions: predicted states are initialized from the first observed data point for each variable.

Observation model
- COTS: lognormal errors (strictly positive).
- Corals: Gaussian errors on percentage scale with minimum standard deviations to handle small values.

Intended use
Given time series of sst_dat and cotsimm_dat with initial conditions for cots_dat, fast_dat, and slow_dat, the model predicts outbreak timing, magnitude, and duration, and the coupled state of fast and slow coral communities. The structure emphasizes mechanistic, testable relationships aligned with empirical COTS-corals dynamics literature.
