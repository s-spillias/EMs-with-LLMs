Assessment of current model and rationale for improvement

Fit and residuals:
- The residuals file was not provided in this chat, so this assessment is based on model structure and typical patterns seen in COTS systems.
- Models without process variability in recruitment often underpredict the magnitude of outbreak peaks and show positively skewed COTS residuals during peak years with time-autocorrelation (runs of positive residuals in pre-peak/peak periods and negative residuals post-peak).
- Coral residuals in such settings often exhibit negative bias during crash years, indicating that peak predation underestimated the speed/magnitude of coral loss when COTS are high.

Coverage of project context:
- Strengths: The model captures selective predation (fast vs slow corals), logistic coral competition, bleaching mortality, temperature-dependent coral and larval performance, food-dependent adult survival, a 1-year maturation delay, and an SST-anomaly-driven larval pulse. These are key ingredients for boom–bust behavior.
- Gaps: Outbreak triggering and persistence in the GBR are strongly influenced by episodic terrestrial runoff (nutrient pulses) and hydrodynamic retention/transport that amplify larval survival in some years and places. Those drivers are not explicitly available as forcings here. The current model is fully deterministic in the state equation, which tends to smooth peaks and truncate extremes even with a pulse term from SST anomalies alone.

Key ecological processes potentially missing or oversimplified:
- Episodic nutrient/runoff pulses and retention variability affecting larval survival are not represented except indirectly through SST anomalies.
- Stage structure and multi-year maturation/juvenile bottlenecks are simplified to a single-year maturation.
- No process noise in reproduction or survival; only observation error is modeled, which can make the latent dynamics unrealistically smooth.

Chosen improvement: Higher-order non-linear pulse on larval production (rectified Hill function)
- Approach: Replace the previous attempt to add year-specific random effects with a non-linear, thresholded pulse driven by SST anomalies:
  Pulse = 1 + A_pulse * H, where
  H = max(0, anom - T_thresh_pulse)^gamma / (tau_pulse^gamma + max(0, anom - T_thresh_pulse)^gamma)
  and gamma = exp(log_gamma_pulse) ≥ 0 controls sharpness/episodicity.
- Ecological justification: This retains parsimony (one extra scalar parameter) while better capturing episodic recruitment booms when SST anomalies exceed threshold, consistent with co-occurring conditions (e.g., nutrient pulses and retention anomalies) that often co-vary with warm anomalies on the GBR. The rectified form prevents negative pulses and avoids bias at zero anomaly (Pulse=1 baseline).
- Practical rationale: The previous random-effects implementation required a long parameter vector sized to the number of time steps, which the current pipeline could not load robustly. The higher-order pulse provides similar dynamical flexibility without requiring a parameter vector.

Notes on existing parameters:
- Some parameters are tightly constrained by literature (e.g., log_r_fast), which can be appropriate but reduces flexibility; this is a modeling choice consistent with using mechanistic priors.
- The predation saturation exponent q_pred and half-saturation constants K_pred_* are already flexible enough to capture Type II/III responses and prey switching within the current framework.
- No non-causal use of observations is introduced; all predictions use lagged states and exogenous forcings only.

Expected impact:
- The model should better reproduce outbreak extremity and intermittency by allowing sharp, thresholded increases in recruitment when anomalies are high, improving timing and magnitude of peaks and the speed of coral crashes.

